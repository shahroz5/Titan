<div [formGroup]="itemForm" class="row no-gutters">
  <div class="col-auto pw-list-card__checkbox">
    <mat-checkbox formControlName="isItemSelected" (change)="selectItem()">
    </mat-checkbox>
  </div>
  <poss-web-item-details 
    [item]="itemData"
    [toLoadImageUrlFromAPI]="true"
    (loadImageEvent)="loadImage()"
  > </poss-web-item-details>
  <div class="col-auto pw-list-card__item">
    <div class="row no-gutters pw-input-group">
      <div class="col-auto pw-input-group__item">
        <div class="pw-input-group__item-label">
          Available Qty: {{ item.availableQuantity }}
        </div>
        <div
          *ngIf="
            item.availableQuantity > 1 &&
              tab == stockIssueDetailsTabEnumRef.SELECTED_PRODUCTS_TAB;
            else nonEditable
          "
        >
          <input
            type="number"
            class="pw-bg-input-box pw-input-group__item-border-right"
            placeholder="Qty."
            possWebInput
            formControlName="issueQuantity"
          />
        </div>
        <ng-template #nonEditable>
          <input
            class="pw-bg-input-box pw-input-group__item-border-right"
            placeholder="Qty."
            formControlName="issueQuantity"
            readonly
          />
        </ng-template>
      </div>
      <div class="col-auto pw-input-group__item">
        <div class="pw-input-group__item-label">Gross Wt.:</div>
        <div class="pw-input-group__item-label">
          ({{ item.availableWeight | weightFormatter }} {{ item.weightUnit }})
        </div>
        <div
          *ngIf="
            tab == stockIssueDetailsTabEnumRef.SELECTED_PRODUCTS_TAB &&
              item.availableQuantity > 0;
            else nonEditableWeight
          "
        >
          <input
            possWebWeightInput
            class="pw-bg-input-box"
            placeholder="Total Wt."
            formControlName="weight"
            readonly
            (blur)="measuredWeightChange()"
          />
        </div>
        <ng-template #nonEditableWeight>
          <input
            class="pw-bg-input-box"
            placeholder="Total Wt."
            formControlName="weight"
            readonly
          />
        </ng-template>
      </div>
      <div class="col-auto pw-input-group__item">
        <div class="pw-input-group__item-label">
          {{ 'pw.stockIssue.binLabelText' | translate }}
        </div>
        <input
          class="pw-bg-input-box pw-input-group__item-border-left"
          formControlName="bin"
          readonly
        />
      </div>
    </div>
  </div>
  <div class="col-auto ml-auto mt-4">
    <span *ngIf="isWeightMismatch" class="pw-list-card__error-label">
      {{ weightErrorMsg }}
    </span>

    <span
      *ngIf="
        itemForm.get('weight').value == null &&
        itemForm.get('issueQuantity').valid &&
        weightErrorMsg === ''
      "
      class="pw-list-card__error-label"
    >
      Enter the measured weight
    </span>
    <mat-error
      *ngIf="
        itemForm.get('issueQuantity').errors &&
        itemForm.get('issueQuantity').errors.errorArray
      "
    >
      <poss-web-error-info-tooltip
        [errorMessage]="itemForm.get('issueQuantity').errors.errorArray"
      ></poss-web-error-info-tooltip>
    </mat-error>

    <span *ngIf="item.isValidating" class="pw-list-card__success-label">
      Validating
    </span>
    <ng-container *ngIf="showUpdateStatus">
      <span
        class="pw-list-card__error-label"
        *ngIf="item.isUpdatingSuccess == false"
      >
        {{ 'pw.stockIssue.saveFailedNotificationText' | translate }}
      </span>
      <span class="pw-list-card__success-label" *ngIf="item.isUpdating">
        {{ 'pw.stockIssue.savingNotificationText' | translate }}
      </span>
      <span
        *ngIf="item.availableQuantity == 0"
        class="pw-list-card__error-label"
      >
        <span class="pw-i-16 pw-warning-icon-16"></span> Out of Stock
      </span>
    </ng-container>
  </div>
</div>
