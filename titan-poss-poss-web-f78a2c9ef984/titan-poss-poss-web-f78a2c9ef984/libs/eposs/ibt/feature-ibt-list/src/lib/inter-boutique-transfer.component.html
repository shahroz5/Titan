<div
  class="container-fluid"
  [class.pw-overlay-notification-gutter]="hasNotification"
>
  <div class="row">
    <div class="col-lg-1 col-12"></div>
    <div class="col-lg-10 col-12 m-auto">
      <div class="pw-top-heading-container">
        <div class="row pw-top-heading-container__item">
          <div class="col-auto">
            <div class="pw-top-heading-container__main-head">
              <a (click)="inStockUrl()">
                <span class="pw-i-24 pw-back-arrow-icon-24"></span>
              </a>
              <span class="pw-i-36 pw-instock-icon-36"></span>
              <div>
                <h2>{{ 'pw.instock.title' | translate }}</h2>
                <h5 class="pw-top-heading-container__sub-heading">
                  {{ 'pw.instock.titlehead' | translate }}
                </h5>
              </div>
            </div>
          </div>
          <div
            class="col-auto ml-auto"
            *possWebPermission="loadPermission(IBT_SEND_NEW_REQUEST_BUTTON)"
          >
            <button class="pw-btn pw-accent-btn" (click)="createRequest()">
              {{
                'pw.interboutiqueTransfer.sendNewRequestButtonText' | translate
              }}
            </button>
          </div>
        </div>
      </div>
      <h3 class="mb-3">
        {{ 'pw.instock.interBoutiqueTransferHeaderText' | translate }}
      </h3>
      <!-- tab -->
      <div class="pw-tab">
        <ul #tabRef class="pw-tab__list">
          <li
            id="ibtSent"
            class="pw-tab__list-item"
            *possWebPermission="loadPermission(IBT_REQUESTS_SENT_TAB)"
          >
            <a
              [class.pw-is-active-bar]="
                interBoutiqueTransferRequestType ===
                interBoutiqueTransferRequestTypesEnumRef.SENT
              "
              (click)="
                changeInterBoutiqueTransferRequestType(
                  interBoutiqueTransferRequestTypesEnumRef.SENT
                )
              "
            >
              <h5 class="pw-tab__item">
                {{ 'pw.interboutiqueTransfer.tabText1' | translate }}
                <span class="pw-fourth-color"
                  >({{ requestSentListCountDisplay }})</span
                >
              </h5>
            </a>
          </li>
          <li
            id="ibtReceived"
            class="pw-tab__list-item"
            *possWebPermission="loadPermission(IBT_REQUESTS_RECEIVED_TAB)"
          >
            <a
              [class.pw-is-active-bar]="
                interBoutiqueTransferRequestType ==
                interBoutiqueTransferRequestTypesEnumRef.RECEIVED
              "
              (click)="
                changeInterBoutiqueTransferRequestType(
                  interBoutiqueTransferRequestTypesEnumRef.RECEIVED
                )
              "
            >
              <h5 class="pw-tab__item">
                {{ 'pw.interboutiqueTransfer.tabText2' | translate }}
                <span class="pw-fourth-color"
                  >({{ requestReceivedListCountDisplay }})</span
                >
              </h5></a
            >
          </li>
          <li
            id="ibtHistory"
            class="pw-tab__list-item"
            *possWebPermission="loadPermission(IBT_HISTORY_TAB)"
          >
            <a
              [class.pw-is-active-bar]="
                interBoutiqueTransferRequestType ==
                interBoutiqueTransferRequestTypesEnumRef.HISTORY
              "
              (click)="
                changeInterBoutiqueTransferRequestType(
                  interBoutiqueTransferRequestTypesEnumRef.HISTORY
                )
              "
            >
              <h5 class="pw-tab__item">
                {{ 'pw.interboutiqueTransfer.tabText3' | translate }}
              </h5></a
            >
          </li>
        </ul>
      </div>

      <div
        [ngClass]="{
          hidden:
            interBoutiqueTransferRequestType ===
              interBoutiqueTransferRequestTypesEnumRef.SENT ||
            interBoutiqueTransferRequestType ===
              interBoutiqueTransferRequestTypesEnumRef.RECEIVED
        }"
      >
        <div class="row mt-3 align-items-center">
          <ng-container [formGroup]="historyFormGroup">
            <mat-radio-group
              *ngIf="
                interBoutiqueTransferRequestType ==
                interBoutiqueTransferRequestTypesEnumRef.HISTORY
              "
              aria-label="Select an option"
              class="col-auto row"
              formControlName="selectRadioButton"
            >
              <mat-radio-button
                value="RECEIVE"
                class="mr-3"
                class="col-auto"
                *possWebPermission="
                  loadPermission(IBT_HISTORY_REQUESTS_SENT_RADIO_BUTTON)
                "
              >
                <p class="pw-radio-btn__label">Requests Sent</p>
              </mat-radio-button>
              <mat-radio-button
                value="ISSUE"
                class="col-auto"
                *possWebPermission="
                  loadPermission(IBT_HISTORY_REQUESTS_RECEIVED_RADIO_BUTTON)
                "
              >
                <p class="pw-radio-btn__label">Requests Received</p>
              </mat-radio-button>
            </mat-radio-group>
          </ng-container>
          <div class="col-auto ml-auto">
            <a (click)="advancedFilter($event)">
              <p>
                <span
                  class="pw-i-24 pw-filter-icon-24 pw-filter-box__icon"
                  [ngClass]="isFilterApplied ? 'pw-filter-icon-color-24' : ''"
                ></span>
                Filter
              </p>
            </a>
          </div>
          <div class="col-lg-3 col-4">
            <mat-form-field class="pw-search-bar" floatLabel="never">
              <input
                #historySearch
                matInput
                class="pw-input-box"
                [placeholder]="
                  'pw.interboutiqueTransfer.searchLabelText' | translate
                "
                [formControl]="searchFormControl"
                (keypress)="numberCheck($event)"
              />
              <mat-icon matSuffix>
                <span
                  *ngIf="!searchFormControl.value"
                  class="pw-i-16 pw-search-icon-16"
                ></span
              ></mat-icon>
              <mat-icon matSuffix (click)="clearSearch()">
                <span
                  *ngIf="searchFormControl.value"
                  class="pw-i-10 pw-close-icon-16"
                ></span
              ></mat-icon>
            </mat-form-field>
          </div>
        </div>
      </div>
      <div
        class="row"
        [hidden]="
          interBoutiqueTransferRequestType ===
          interBoutiqueTransferRequestTypesEnumRef.HISTORY
        "
      >
        <mat-form-field
          class="col-lg-3 col-sm-4 ml-auto pw-search-bar"
          floatLabel="never"
        >
          <input
            #searchBox
            matInput
            class="pw-input-box"
            [placeholder]="
              'pw.interboutiqueTransfer.searchLabelText' | translate
            "
            [formControl]="searchFormControl"
            (keypress)="numberCheck($event)"
            name="requestNumberField"
            possWebMaxLengthValidator
          />
          <mat-icon matSuffix>
            <span
              *ngIf="!searchFormControl.value"
              class="pw-i-16 pw-search-icon-16"
            ></span
          ></mat-icon>
          <mat-icon matSuffix (click)="clearSearch()">
            <span
              *ngIf="searchFormControl.value"
              class="pw-i-10 pw-close-icon-16"
            ></span
          ></mat-icon>
        </mat-form-field>
      </div>

      <div
        *ngIf="
          interBoutiqueTransferRequestType ===
          interBoutiqueTransferRequestTypesEnumRef.HISTORY
        "
      >
        <poss-web-card-list
          *ngIf="
            interBoutiqueTransferRequestType ===
            interBoutiqueTransferRequestTypesEnumRef.HISTORY
          "
          [count]="ibtHistoryTotalCount$ | async"
          [dataList]="ibtHistory$ | async"
          [pageSize]="pageSize"
          (loadMore)="loadRequests($event)"
          (selected)="selected($event)"
        >
          <ng-template let-item="data">
            <poss-web-card-title>
              <h4>Request No: {{ item.reqDocNo }}</h4>
            </poss-web-card-title>
            <poss-web-card-subtitle
              >{{ item.srcLocationCode }} - {{ item.destLocationCode }}
            </poss-web-card-subtitle>
            <poss-web-card-content>
              {{ item.totalMeasuredQuantity }} Products Requested
            </poss-web-card-content>
            <poss-web-card-content>
              <p>Requested Date:{{ item.reqDocDate | dateFormatter }}</p>
              <p [ngClass]="getStatus(item.status ? item.status : '')">
                {{ 'pw.stockIssue.status' | translate }}:{{
                  status | titlecase
                }}
              </p>
            </poss-web-card-content>
          </ng-template>
        </poss-web-card-list>
        <h3
          class="pw-text-center m-5"
          *ngIf="
            isLoadingHistory === false && (ibtHistory$ | async)?.length == 0
          "
        >
          {{ 'pw.interboutiqueTransfer.emptyFilterCombination' | translate }}
        </h3>
      </div>
      <poss-web-card-list
        *ngIf="
          interBoutiqueTransferRequestType ==
          interBoutiqueTransferRequestTypesEnumRef.SENT
        "
        [count]="requestSentListCount"
        [dataList]="requestSentList$ | async"
        [pageSize]="pageSize"
        (loadMore)="loadRequests($event)"
        (selected)="onRequestSelected($event)"
      >
        <ng-template let-item="data">
          <poss-web-card-title>
            {{ 'pw.interboutiqueTransfer.requestNoLabelText' | translate
            }}{{ item.reqDocNo }}</poss-web-card-title
          >
          <poss-web-card-subtitle
            >{{ 'pw.interboutiqueTransfer.cardHeaderTextTo' | translate }}
            {{ item.srcLocationCode }}</poss-web-card-subtitle
          >
          <poss-web-card-content>
            <p [ngClass]="getStatus(item.status)">
              {{ 'pw.interboutiqueTransfer.cardContent' | translate }}
              {{ status | titlecase }}
            </p>
            <p class="pw-success-color">
              {{ item.totalRequestedQuantity }}
              {{ 'pw.interboutiqueTransfer.productsText' | translate }}
            </p>
            <p>
              {{ item.createdDate.fromNow() }}
            </p>
          </poss-web-card-content>
        </ng-template>
      </poss-web-card-list>
      <!-- requests received -->
      <poss-web-card-list
        *ngIf="
          interBoutiqueTransferRequestType ==
          interBoutiqueTransferRequestTypesEnumRef.RECEIVED
        "
        [count]="requestReceivedListCount"
        [dataList]="requestReceivedList$ | async"
        [pageSize]="pageSize"
        (loadMore)="loadRequests($event)"
        (selected)="onRequestSelected($event)"
      >
        <ng-template let-item="data">
          <poss-web-card-title>
            {{ 'pw.interboutiqueTransfer.requestNoLabelText' | translate }}
            {{ item.reqDocNo }}</poss-web-card-title
          >
          <poss-web-card-subtitle
            >{{ 'pw.interboutiqueTransfer.cardHeaderTextFrom' | translate }}
            {{ item.destLocationCode }}</poss-web-card-subtitle
          >
          <poss-web-card-content>
            <p [ngClass]="getStatus(item.status)">
              {{ 'pw.interboutiqueTransfer.cardContent' | translate }}
              {{ status | titlecase }}
            </p>
            <p class="pw-success-color">
              {{ item.totalRequestedQuantity }}
              {{ 'pw.interboutiqueTransfer.productsText' | translate }}
            </p>
            <p>
              {{ item.createdDate.fromNow() }}
            </p>
          </poss-web-card-content>
        </ng-template>
      </poss-web-card-list>
      <!-- no data found -->
      <!-- request sent -->
      <h3
        class="pw-text-center m-5"
        *ngIf="
          !isLoading &&
          interBoutiqueTransferRequestType ===
            interBoutiqueTransferRequestTypesEnumRef.SENT &&
          requestSentListCount === 0 &&
          (requestSentList$ | async).length === 0
        "
      >
        {{ noDataFoundMessage }}
      </h3>
      <!-- request received -->
      <h3
        class="pw-text-center m-5"
        *ngIf="
          !isLoading &&
          interBoutiqueTransferRequestType ===
            interBoutiqueTransferRequestTypesEnumRef.RECEIVED &&
          requestReceivedListCount === 0 &&
          (requestReceivedList$ | async).length === 0
        "
      >
        {{ noDataFoundMessage }}
      </h3>
      <!-- loader -->
      <poss-web-loader *ngIf="isLoading"> </poss-web-loader>
    </div>

    <div class="mb-5"></div>

    <div class="col-lg-1 col-12"></div>
  </div>
</div>
