<div
  class="row pw-cursor-grab pw-font-weight-bold"
  cdkDragBoundary=".cdk-overlay-container"
  cdkDragRootElement=".cdk-overlay-pane"
  cdkDrag
  cdkDragHandle
>
  <div class="col-auto">
    {{ 'pw.conversion.conversionRequest' | translate }}
  </div>
  <div class="col-auto ml-auto">
    <button
      mat-icon-button
      mat-dialog-close="close"
      class="pw-dialog-popup__icon-button"
    >
      <mat-icon>
        <span class="pw-i-24 pw-close-no-border-icon-24"></span>
      </mat-icon>
    </button>
  </div>
</div>
<div class="row">
  <div class="col-12 m-auto">
    <form [formGroup]="form">
      <div class="row pw-list-card">
        <div class="col-auto pw-list-card__item">
          <poss-web-thumbnail
            [thumbnailSrc]="data?.selectedItem?.imageURL"
            [imageSrc]="data?.selectedItem?.imageURL"
            [alt]="data?.selectedItem?.productCategoryDesc"
          >
            <p class="pt-3">
              {{ 'pw.conversion.product' | translate }} -
              {{ data?.selectedItem?.productCategoryDesc }}
            </p>
            <p>
              {{ 'pw.conversion.variantCodeLableText' | translate }} -
              {{ data?.selectedItem?.itemCode }}
            </p>
          </poss-web-thumbnail>
        </div>
        <div class="col-auto pw-list-card__item">
          <div class="pw-sub-heading">{{ data?.selectedItem?.itemCode }}</div>
          <div>
            <p>{{ data?.selectedItem?.lotNumber }}</p>
            <p>{{ data?.selectedItem?.productCategoryDesc }}</p>
            <p>{{ data?.selectedItem?.productGroupDesc }}</p>
          </div>
        </div>
        <div class="col-auto pw-list-card__item">
          <div class="pw-sub-heading" *ngIf="data.selectedItem.studded">
            {{ 'pw.conversion.grossItemWeightText' | translate }} {{ '(gms)' }}
          </div>
          <div class="pw-sub-heading" *ngIf="!data.selectedItem.studded">
            {{ 'pw.conversion.itemWeightText' | translate }} {{ '(gms)' }}
          </div>
          <input
            type="text"
            class="pw-bg-input-box"
            placeholder="{{ 'pw.conversion.itemWeightText' | translate }}"
            formControlName="netWeight"
            readonly
          />
        </div>
        <div class="col-auto pw-list-card__item">
          <div class="pw-sub-heading">
            {{ 'pw.conversion.stonePrice' | translate }}
          </div>
          <input
            type="text"
            class="pw-bg-input-box"
            placeholder="{{ 'pw.conversion.stonePrice' | translate }}"
            formControlName="stonePrice"
            readonly
          />
        </div>
        <div class="col-auto pw-list-card__item">
          <div class="pw-sub-heading">
            {{ 'pw.conversion.complexityCode' | translate }}
          </div>
          <input
            type="text"
            class="pw-bg-input-box"
            placeholder="{{ 'pw.conversion.complexityCode' | translate }}"
            formControlName="complexityCode"
            readonly
          />
        </div>
      </div>
      <hr />
      <div class="pw-max-height-fix">
        <div possWebFocusableList>
          <ng-container
            *ngFor="let item of data.selectedItem.childItems; let i = index"
          >
            <poss-web-request-item
              possWebFocusableListItem
              [item]="item"
              [parentForm]="form.controls.parentForm"
              [binCodes]="data.binCodes"
              [showCloseIcon]="i >= minChildItems"
              [isSelectedItemHasChildItems]="isSelectedItemHasChildItems"
              [studded]="data.selectedItem.studded"
              (removeChildItem)="removeChildItem(i)"
              class="pw-list-card d-block"
            ></poss-web-request-item>
          </ng-container>
        </div>
        <div *ngIf="isSelectedItemHasChildItems === false">
          <button class="pw-btn pw-primary-btn" (click)="AddNewChildItem()">
            {{ 'pw.conversion.addRow' | translate }}
          </button>
        </div>
        <div class="row mt-3">
          <mat-form-field class="col-12 pw-single-bordered-input">
            <textarea
              required
              matInput
              placeholder="{{ 'pw.conversion.remarks' | translate }}"
              formControlName="remarks"
            ></textarea>
          </mat-form-field>
        </div>
      </div>
    </form>
    <div class="row">
      <div class="col">
        <ul class="pw-list-error-msg">
          <li
            class="pw-error-color"
            *ngIf="form.invalid && isSelectedItemHasChildItems"
          >
            {{
              'pw.conversionNotificationMessages.requiredFields-Message1'
                | translate
            }}
          </li>

          <li class="pw-error-color" *ngIf="anyChildItemsSold === false">
            {{
              'pw.conversionNotificationMessages.atleastOneChildToBeSoldMessage'
                | translate
            }}
          </li>

          <li class="pw-error-color" *ngIf="showWeightMismatchError">
            {{
              'pw.conversionNotificationMessages.weightMismatchMessage'
                | translate
            }}
          </li>
        </ul>
      </div>

      <div class="col-auto ml-auto pw-text-right">
        <button
          class="pw-btn pw-accent-btn"
          (click)="sendRequestNow()"
          [disabled]="form.invalid"
        >
          {{
            'pw.conversionNotificationMessages.btnText-SendRequestNow'
              | translate
          }}
        </button>
      </div>
    </div>
  </div>
</div>
