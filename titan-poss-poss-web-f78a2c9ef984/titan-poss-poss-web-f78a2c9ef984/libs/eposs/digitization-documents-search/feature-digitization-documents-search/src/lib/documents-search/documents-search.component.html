<div class="container-fluid">
  <div class="row">
    <div class="col-12 col-lg-10 m-auto">
      <div class="pw-top-heading-container">
        <div class="row pw-top-heading-container__item">
          <div class="col-auto">
            <div class="pw-top-heading-container__main-head">
              <a (click)="back()">
                <span class="pw-i-24 pw-back-arrow-icon-24"></span>
              </a>
              <span class="pw-i-36 pw-customer-transaction-icon-36"></span>
              <div>
                <h2>
                  {{ 'pw.documentsSearch.documents' | translate }}
                </h2>
                <h5 class="pw-top-heading-container__sub-heading">
                  {{ 'pw.documentsSearch.search' | translate }}
                </h5>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="pw-detail-card">
        <div class="pw-detail-card__heading">
          {{ 'pw.documentsSearch.searchParameters' | translate }}
        </div>
        <div
          class="row pw-detail-card__flex-end"
          [formGroup]="documentsSearchForm"
        >
          <mat-form-field class="col-lg-4 col-4">
            <mat-label>
              {{ 'pw.documentsSearch.docNoLabel' | translate }}
            </mat-label>
            <input
              matInput
              type="text"
              class="single-bordered-input"
              formControlName="docNo"
            />
            <mat-icon matSuffix>
              <span
                class="pw-i-16 pw-search-icon-16"
                *ngIf="!documentsSearchForm.value.docNo"
              ></span>
            </mat-icon>
            <mat-icon matSuffix (click)="clearSearch()">
              <span
                *ngIf="documentsSearchForm.value.docNo"
                class="pw-i-10 pw-close-icon-16"
              ></span
            ></mat-icon>
            <mat-error
              *ngIf="
                documentsSearchForm.get('docNo').errors &&
                documentsSearchForm.get('docNo').errors.errorArray &&
                documentsSearchForm.get('docNo').touched
              "
            >
              <poss-web-error-info-tooltip
                [errorMessage]="
                  documentsSearchForm.get('docNo').errors.errorArray
                "
              ></poss-web-error-info-tooltip>
            </mat-error>
          </mat-form-field>
          <mat-form-field class="col-lg-3 col-4">
            <mat-label>
              {{ 'pw.reports.filterByDateRangeLabel' | translate }}
            </mat-label>
            <mat-date-range-input [rangePicker]="picker1" [max]="businessDate">
              <input
                matStartDate
                formControlName="fromDate"
                placeholder="{{ 'pw.reports.fromDateLabel' | translate }}"
                (dateChange)="fromDateChange($event)"
              />
              <input
                matEndDate
                formControlName="toDate"
                placeholder="{{ 'pw.reports.toDateLabel' | translate }}"
                (dateChange)="toDateChange($event)"
              />
            </mat-date-range-input>

            <mat-datepicker-toggle matSuffix [for]="picker1">
              <mat-icon matDatepickerToggleIcon>
                <span class="pw-i-12 pw-calender-icon-12"></span>
              </mat-icon>
            </mat-datepicker-toggle>
            <mat-date-range-picker #picker1></mat-date-range-picker>

            <mat-error
              *ngIf="
                documentsSearchForm.get('fromDate').errors &&
                documentsSearchForm.get('fromDate').errors.errorArray
              "
            >
              <poss-web-error-info-tooltip
                [errorMessage]="
                  documentsSearchForm.get('fromDate').errors.errorArray
                "
              ></poss-web-error-info-tooltip>
            </mat-error>
            <mat-error
              *ngIf="
                documentsSearchForm.get('toDate').errors &&
                documentsSearchForm.get('toDate').errors.errorArray
              "
            >
              <poss-web-error-info-tooltip
                [errorMessage]="
                  documentsSearchForm.get('toDate').errors.errorArray
                "
              ></poss-web-error-info-tooltip>
            </mat-error>
          </mat-form-field>
          <mat-form-field class="col-lg-3 col-3">
            <input
              #storeIdSearchBox
              class="pw-single-bordered-input"
              matInput
              [placeholder]="
                'pw.passwordConfig.locationCodePlaceHolder' | translate
              "
              formControlName="storeId"
              readonly
              (click)="openLocationSelectionPopup()"
            />
            <mat-icon matSuffix>
              <span class="pw-i-16 pw-location-icon-16"></span>
            </mat-icon>
            <mat-error
              *ngIf="
                documentsSearchForm.get('storeId').errors &&
                documentsSearchForm.get('storeId').errors.errorArray &&
                documentsSearchForm.get('storeId').touched
              "
            >
              <poss-web-error-info-tooltip
                [errorMessage]="
                  documentsSearchForm.get('storeId').errors.errorArray
                "
              ></poss-web-error-info-tooltip>
            </mat-error>
          </mat-form-field>

          <poss-web-select-dropdown
            placeholder=" {{
              'pw.documentsSearch.transactionTypes' | translate
            }}"
            [control]="documentsSearchForm.get('transactionType')"
            [options]="transactionTypes"
            [required]="true"
            (selectionChange)="onTransactionTypeChange($event)"
            class="col-lg-3 col-3"
          >
          </poss-web-select-dropdown>

          <poss-web-fiscal-year
            class="col-lg-3 col-3"
            [control]="documentsSearchForm.get('fiscalYear')"
            [required]="false"
            [data]="documentsSearchForm.get('fiscalYear').value"
            [placeHolder]="'pw.creditNote.searchByFiscalYearLabel' | translate"
            [disabled]="false"
          ></poss-web-fiscal-year>

          <div class="col-auto pw-detail-card__right-container">
            <button
              mat-flat-button
              class="pw-btn pw-accent-btn"
              (click)="searchDocs()"
              [disabled]="documentsSearchForm.invalid || (fromDate && !toDate)"
            >
              {{ 'pw.documentsSearch.searchDocumentsLabel' | translate }}
            </button>
            <!-- (click)="searchAdvanceHistoryItem(0, 10)" -->
          </div>
        </div>
      </div>

      <poss-web-documents-search-list
        [invoiceList]="invoiceList"
        [count]="totalInvoices"
        [pageSizeOptions]="pageSizeOptions"
        [pageEvent]="pageEvent"
        (paginator)="loadPaginateData($event)"
        (download)="downloadReport($event)"
      >
      </poss-web-documents-search-list>
      <div
        *ngIf="(isLoading$ | async) === false && !invoiceList.length"
        class="pw-message pw-text-center mg-t-100"
      >
        <h3 class="m-auto">{{ noDataFoundMessage }}</h3>
      </div>
      <poss-web-loader *ngIf="isLoading$ | async"></poss-web-loader>
    </div>
  </div>
</div>
