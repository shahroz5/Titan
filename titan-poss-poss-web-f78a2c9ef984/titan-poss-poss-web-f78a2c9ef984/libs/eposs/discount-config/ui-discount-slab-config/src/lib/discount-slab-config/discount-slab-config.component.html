<form [formGroup]="form">
  <div class="row align-items-center">
    <poss-web-select-dropdown
      class="col-auto"
      placeholder=" {{
        'pw.discountSlabConfig.discountBasedOnLabel' | translate
      }}"
      [control]="form.get('discountBasedOn')"
      [options]="discountBasedOnOptions"
      [required]="true"
      (selectionChange)="discountBasedOnChange($event.value)"
    >
    </poss-web-select-dropdown>

    <mat-radio-group
      formControlName="discountBasedOnType"
      (change)="discountBasedOnTypeChange($event.value)"
    >
      <ng-container
        *ngIf="
          form.get('discountBasedOn').value ===
          DiscountBasedOnEnumRef.WEIGHT_BASED
        "
      >
        <mat-radio-button
          class="mr-3"
          value="{{ DiscountBasedOnTypesEnumRef.GROSS_WEIGHT }}"
        >
          {{ 'pw.discountSlabConfig.grossWtLabel' | translate }}
        </mat-radio-button>
        <mat-radio-button
          class="mr-3"
          value="{{ DiscountBasedOnTypesEnumRef.NET_WEIGHT }}"
        >
          {{ 'pw.discountSlabConfig.netWtLabel' | translate }}</mat-radio-button
        >
      </ng-container>

      <ng-container
        *ngIf="
          form.get('discountBasedOn').value ===
          DiscountBasedOnEnumRef.VALUE_BASED
        "
      >
        <mat-radio-button
          class="mr-3"
          value="{{ DiscountBasedOnTypesEnumRef.PRE_DISCOUNT_TAX }}"
          >{{
            'pw.discountSlabConfig.preDiscountTaxLabel' | translate
          }}</mat-radio-button
        >
        <mat-radio-button
          class="mr-3"
          value="{{ DiscountBasedOnTypesEnumRef.PRE_DISCOUNT_WITHOUT_TAX }}"
        >
          {{
            'pw.discountSlabConfig.preDiscountWithoutTaxLabel' | translate
          }}</mat-radio-button
        >
      </ng-container>

      <ng-container
        *ngIf="
          form.get('discountBasedOn').value ===
          DiscountBasedOnEnumRef.CARAT_BASED
        "
      >
        <mat-radio-button
          class="mr-3"
          value="{{ DiscountBasedOnTypesEnumRef.SINGLE_STONE }}"
          >{{ 'pw.discountSlabConfig.singleStoneLabel' | translate }}
        </mat-radio-button>
        <mat-radio-button
          class="mr-3"
          value="{{ DiscountBasedOnTypesEnumRef.CUMULATIVE_STONE }}"
          >{{ 'pw.discountSlabConfig.cumulativeStonelbel' | translate }}
        </mat-radio-button>
      </ng-container>
    </mat-radio-group>

    <div class="col-auto ml-auto">
      {{ 'pw.discountSlabConfig.valueGmsLabel' | translate }} :
    </div>
    <mat-radio-group
      formControlName="valuePerWeightType"
      (change)="valuePerWeightTypeChange($event.value)"
    >
      <mat-radio-button class="mr-3" value="GrossWt">{{
        'pw.discountSlabConfig.grossWtLabel' | translate
      }}</mat-radio-button>

      <mat-radio-button value="NetWt">
        {{ 'pw.discountSlabConfig.netWtLabel' | translate }}</mat-radio-button
      >
    </mat-radio-group>
  </div>
  <div class="row align-items-baseline">
    <div class="col-auto">
      <div class="pw-tab mb-0">
        <ul class="pw-tab__list">
          <li class="pw-tab__list-item">
            <a
              [class.pw-is-active-bar]="tabType === 'Regular'"
              (click)="changeTab('Regular')"
            >
              <h5 class="pw-tab__item">
                {{ 'pw.discountSlabConfig.regularLabel' | translate }}
              </h5>
            </a>
          </li>
          <li class="pw-tab__list-item" *ngIf="isPreviewApplicable">
            <a
              [class.pw-is-active-bar]="tabType === 'Preview'"
              (click)="changeTab('Preview')"
            >
              <h5 class="pw-tab__item">
                {{ 'pw.discountSlabConfig.previewLable' | translate }}
              </h5>
            </a>
          </li>
          <li class="pw-tab__list-item" *ngIf="isCOOfferApplicable">
            <a
              [class.pw-is-active-bar]="tabType === 'CO'"
              (click)="changeTab('CO')"
            >
              <h5 class="pw-tab__item">
                {{ 'pw.discountSlabConfig.coLabel' | translate }}
              </h5></a
            >
          </li>
          <li class="pw-tab__list-item" *ngIf="isABOfferApplicable">
            <a
              [class.pw-is-active-bar]="tabType === 'AB'"
              (click)="changeTab('AB')"
            >
              <h5 class="pw-tab__item">
                {{ 'pw.discountSlabConfig.abLabel' | translate }}
              </h5></a
            >
          </li>
          <li class="pw-tab__list-item" *ngIf="isRivaApplicable">
            <a
              [class.pw-is-active-bar]="tabType === 'RIVA'"
              (click)="changeTab('RIVA')"
            >
              <h5 class="pw-tab__item">
                {{ 'pw.discountSlabConfig.rivaLabel' | translate }}
              </h5></a
            >
          </li>
        </ul>
      </div>
    </div>

    <mat-checkbox
      formControlName="isSingle"
      class="ml-auto"
      (change)="singleOptionChange($event.checked)"
    >
      {{ 'pw.discountSlabConfig.singleLabel' | translate }}
    </mat-checkbox>
    <div class="col-auto" *ngIf="slabConfigsItems.length > 0 && getActiveSlabsCount() > 0">
      <button
        [disabled]="!selectedConfig"
        class="pw-btn pw-primary-btn pw-add-btn pw-margin-btn"
        (click)="updateGrid('above')"
      >
        <span class="pw-i-24 pw-add-icon-24"></span>
        {{ 'pw.discountSlabConfig.addAboveLabel' | translate }}
      </button>

      <button
        [disabled]="!selectedConfig"
        class="pw-btn pw-primary-btn pw-add-btn"
        (click)="updateGrid('below')"
      >
        <span class="pw-i-24 pw-add-icon-24"></span>
        {{ 'pw.discountSlabConfig.addBelowLabel' | translate }}
      </button>

    </div>
    <div class="col-auto" *ngIf="slabConfigsItems.length === 0 || getActiveSlabsCount() === 0">
      <button
        class="pw-btn pw-primary-btn pw-add-btn pw-margin-btn"
        (click)="updateGrid('new')"
      >
        <span class="pw-i-24 pw-add-icon-24"></span>
        {{ 'pw.discountSlabConfig.addSlabLabel' | translate }}
      </button>
    </div>
  </div>

  <ag-grid-angular
    class="pw-titan-poss-theme pw-ag-grid-table pw-new-grid pw-slab-config-grid"
    [columnDefs]="columnDefs"
    [defaultColDef]="defaultColDef"
    [rowData]="slabConfigsItems"
    [frameworkComponents]="getComponents()"
    [context]="getContext()"
    [domLayout]="domLayout"
    [rowHeight]="rowHeight"
    [animateRows]="animateRows"
    (gridReady)="gridReady($event)"
    (selectionChanged)="selectionChanged($event)"
    (onCellKeyPress)="onCellKeyPress($event)"
  >
  </ag-grid-angular>

  <div class="row mb-3 mt-2">
    <div class="col-auto">
      <button
        class="pw-btn pw-accent-btn"
        [disabled]="!hasSelectedRow"
        (click)="openValuePercentagePopup()"
      >
        {{ 'pw.discountSlabConfig.addWtValPerLabel' | translate }}
      </button>
    </div>
    <div
      class="col-auto"
      *ngIf="isABOfferApplicable || isCOOfferApplicable"
      (click)="openABCOConfigPopup()"
    >
      <button class="pw-btn pw-primary-btn">
        <span *ngIf="isABOfferApplicable">
          {{ 'pw.discountSlabConfig.abLabel' | translate }}
        </span>
        <span *ngIf="isABOfferApplicable && isCOOfferApplicable"> / </span>
        <span *ngIf="isCOOfferApplicable">
          {{ 'pw.discountSlabConfig.coLabel' | translate }}
        </span>
        {{ 'pw.discountSlabConfig.discountLabel' | translate }}
      </button>
    </div>


  </div>
</form>
