<form [formGroup]="filterForm" autocomplete="off">
  <div class="row my-3 align-items-end">
    <mat-form-field class="col-auto" *ngIf="isApplicableField">
      <mat-label>
        <div class="row">
          <div class="col-auto">
            {{
              'pw.discountLocationMapping.filterByOfferDateRangeLabel'
                | translate
            }}
          </div>
        </div>
      </mat-label>
      <mat-date-range-input [rangePicker]="picker1">
        <input
          matStartDate
          formControlName="offerStartDate"
          placeholder=" {{
            'pw.discountLocationMapping.startDateLabel' | translate
          }} "
        />
        <input
          matEndDate
          formControlName="offerEndDate"
          placeholder=" {{
            'pw.discountLocationMapping.endDateLabel' | translate
          }} "
        />
      </mat-date-range-input>

      <mat-datepicker-toggle matSuffix [for]="picker1">
        <mat-icon matDatepickerToggleIcon>
          <span class="pw-i-12 pw-calender-icon-12"></span>
        </mat-icon>
      </mat-datepicker-toggle>
      <mat-date-range-picker #picker1></mat-date-range-picker>
      <mat-icon
        *ngIf="
          filterForm.get('offerStartDate').value !== null &&
          filterForm.get('offerEndDate').value !== null
        "
        class="pw-pointer"
        matSuffix
        (click)="clearOfferRange()"
      >
        <span class="pw-i-10 pw-close-icon-16"></span
      ></mat-icon>
      <mat-error
        *ngIf="
          filterForm.get('offerStartDate').errors &&
          filterForm.get('offerStartDate').errors.errorArray
        "
      >
        <poss-web-error-info-tooltip
          [errorMessage]="filterForm.get('offerStartDate').errors.errorArray"
        ></poss-web-error-info-tooltip>
      </mat-error>
      <mat-error
        *ngIf="
          filterForm.get('offerEndDate').errors &&
          filterForm.get('offerEndDate').errors.errorArray
        "
      >
        <poss-web-error-info-tooltip
          [errorMessage]="filterForm.get('offerEndDate').errors.errorArray"
        ></poss-web-error-info-tooltip>
      </mat-error>
    </mat-form-field>

    <mat-form-field class="col-auto" *ngIf="isPreviewApplicable">
      <mat-label>
        {{
          'pw.discountLocationMapping.filterByOreviewDateRangeLabel' | translate
        }}
      </mat-label>
      <mat-date-range-input [rangePicker]="picker2">
        <input
          matStartDate
          formControlName="previewStartDate"
          placeholder=" {{
            'pw.discountLocationMapping.startDateLabel' | translate
          }} "
        />
        <input
          matEndDate
          formControlName="previewEndDate"
          placeholder=" {{
            'pw.discountLocationMapping.endDateLabel' | translate
          }} "
        />
      </mat-date-range-input>

      <mat-datepicker-toggle matSuffix [for]="picker2">
        <mat-icon matDatepickerToggleIcon>
          <span class="pw-i-12 pw-calender-icon-12"></span>
        </mat-icon>
      </mat-datepicker-toggle>
      <mat-date-range-picker #picker2></mat-date-range-picker>
      <mat-icon
        *ngIf="
          filterForm.get('previewStartDate').value !== null &&
          filterForm.get('previewEndDate').value !== null
        "
        class="pw-pointer"
        matSuffix
        (click)="clearPreviewRange()"
      >
        <span class="pw-i-10 pw-close-icon-16"></span
      ></mat-icon>
      <mat-error
        *ngIf="
          filterForm.get('previewStartDate').errors &&
          filterForm.get('previewStartDate').errors.errorArray
        "
      >
        <poss-web-error-info-tooltip
          [errorMessage]="filterForm.get('previewStartDate').errors.errorArray"
        ></poss-web-error-info-tooltip>
      </mat-error>
      <mat-error
        *ngIf="
          filterForm.get('previewEndDate').errors &&
          filterForm.get('previewEndDate').errors.errorArray
        "
      >
        <poss-web-error-info-tooltip
          [errorMessage]="filterForm.get('previewEndDate').errors.errorArray"
        ></poss-web-error-info-tooltip>
      </mat-error>
    </mat-form-field>

    <div class="col-auto ml-auto mb-3">
      <div class="row">
        <mat-form-field
          class="col-auto mt-2 pw-form-field-padding-bottom-0 pw-search-bar pw-form-field-border-top-0"
        >
          <input
            #searchBox
            matInput
            type="text"
            placeholder=" {{
              'pw.discountLocationMapping.searchLocationLabel' | translate
            }} "
            class="single-bordered-input"
            formControlName="searchValue"
          />
          <mat-icon matSuffix>
            <span
              class="pw-i-16 pw-search-icon-16"
              *ngIf="!filterForm.value.searchValue"
            ></span>
          </mat-icon>
          <mat-icon matSuffix (click)="clearSearch()">
            <span
              *ngIf="filterForm.value.searchValue"
              class="pw-i-10 pw-close-icon-16"
            ></span
          ></mat-icon>
        </mat-form-field>
      </div>
    </div>
  </div>

  <div class="row" *ngIf="rowData.length > 0; else errorMesage">
    <div class="col-12">
      <table class="pw-grid-table"  aria-describedby="table">
        <thead>
          <tr class="pw-grid-table__background-header">
            <th class="pw-grid-table__header-item" scope="col">
              {{ 'pw.discountLocationMapping.locationCodeLabel' | translate }}
            </th>
            <th class="pw-grid-table__header-item" scope="col">
              {{ 'pw.discountLocationMapping.descriptionLabel' | translate }}
            </th>
            <th class="pw-grid-table__header-item" scope="col">
              {{ 'pw.discountLocationMapping.subBrandLabel' | translate }}
            </th>
            <th
              *ngIf="isApplicableField"
              class="pw-grid-table__header-item"
              scope="col"
            >
              {{ 'pw.discountLocationMapping.offerStartDateLabel' | translate }}
            </th>
            <th
              *ngIf="isApplicableField"
              class="pw-grid-table__header-item"
              scope="col"
            >
              {{ 'pw.discountLocationMapping.offerEndDateLabel' | translate }}
            </th>
            <th
              *ngIf="isApplicableField"
              class="pw-grid-table__header-item"
              scope="col"
            >
              {{
                'pw.discountLocationMapping.previewStartDateLabel' | translate
              }}
            </th>
            <th
              class="pw-grid-table__header-item"
              scope="col"
              *ngIf="isPreviewApplicable"
            >
              {{ 'pw.discountLocationMapping.previewEndDateLabel' | translate }}
            </th>
            <th
              class="pw-grid-table__header-item"
              scope="col"
              *ngIf="isPreviewApplicable || !isApplicableField"
            >
              {{ 'pw.discountLocationMapping.statusLabel' | translate }}
            </th>
          </tr>
        </thead>
        <tbody class="pw-grid-table__body">
          <tr *ngFor="let item of rowData" class="pw-grid-table__row">
            <td class="pw-grid-table__item">{{ item.locationCode }}</td>
            <td class="pw-grid-table__item">{{ item.description }}</td>
            <td class="pw-grid-table__item">{{ item.subBrandCode }}</td>
            <td class="pw-grid-table__item" *ngIf="isApplicableField">
              {{ item.offerStartDate | dateFormatter }}
            </td>
            <td class="pw-grid-table__item" *ngIf="isApplicableField">
              {{ item.offerEndDate | dateFormatter }}
            </td>
            <td class="pw-grid-table__item" *ngIf="isPreviewApplicable">
              {{ dateFormatting(item.previewStartDate) | dateFormatter }}
            </td>
            <td class="pw-grid-table__item" *ngIf="isPreviewApplicable">
              {{ dateFormatting(item.previewEndDate) | dateFormatter }}
            </td>
            <td class="pw-grid-table__item">
              <poss-web-toggle-button
                [isActive]="item?.isActive"
                [isDisabled]="true"
              >
              </poss-web-toggle-button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <ng-template #errorMesage>
    <div class="pw-sub-heading pw-message pw-text-center">
      {{ 'No Records' | translate }}
    </div>
  </ng-template>

  <div class="row mt-2">
    <mat-paginator
      class="pw-paginator ml-auto"
      *ngIf="totalElements > minPageSize && mappedLocation.length > 0"
      [length]="totalElements"
      [pageSize]="pageEvent.pageSize"
      [pageIndex]="pageEvent.pageIndex"
      showFirstLastButtons
      [pageSizeOptions]="pageSizeOptions"
      (page)="paginator.emit($event)"
    >
    </mat-paginator>
  </div>
</form>
