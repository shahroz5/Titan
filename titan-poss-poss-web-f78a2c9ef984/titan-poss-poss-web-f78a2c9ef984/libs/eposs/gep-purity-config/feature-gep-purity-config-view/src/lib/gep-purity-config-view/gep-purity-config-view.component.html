<div class="container-fluid">
  <div class="row">
    <div class="col-12 col-lg-10 m-auto">
      <div class="pw-top-heading-container">
        <div class="row pw-top-heading-container__item">
          <div class="col-auto">
            <div class="pw-top-heading-container__main-head">
              <a (click)="back()">
                <span class="pw-i-24 pw-back-arrow-icon-24"></span>
              </a>
              <span class="pw-i-36 pw-customer-transaction-icon-36"></span>
              <div>
                <h2>
                  {{ 'pw.gePurityConfiguration.offerLabel' | translate }}
                </h2>
                <h5 class="pw-top-heading-container__sub-heading">
                  {{
                    'pw.gePurityConfiguration.configurationLabel' | translate
                  }}
                </h5>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="row pw-sub-header">
        <div class="col-auto">
          <div class="pw-sub-header__padding-heading">
            {{ 'pw.gePurityConfiguration.gepPurityConfigLabel' | translate }}
          </div>
        </div>
      </div>
      <div class="pw-min-height">
        <poss-web-loader *ngIf="isLoading$ | async"></poss-web-loader>
        <div class="row">
          <div class="ml-auto mr-3 mb-3">
            <button
              mat-button
              class="pw-btn pw-primary-btn"
              type="button"
              (click)="toggleAccordion()"
            >
              {{
                expanded
                  ? ('Collapse All' | translate)
                  : ('Expand All' | translate)
              }}
            </button>
          </div>
        </div>

        <mat-accordion multi>
          <mat-expansion-panel class="pw-expansion-panel" [expanded]="expanded">
            <mat-expansion-panel-header class="pw-expansion-panel__header">
              <mat-panel-title class="pw-expansion-panel__heading"
                >Configuration</mat-panel-title
              >
            </mat-expansion-panel-header>
            <poss-web-configuration
              [gepDetails]="gepDetails"
            ></poss-web-configuration>
          </mat-expansion-panel>
          <mat-expansion-panel
            class="pw-expansion-panel"
            [expanded]="expanded"
            *ngIf="
              tabType === GepPurityConfigEnumsRef.PURITY_DETAILS &&
              (metalTypes$ | async) &&
              (itemTypes$ | async)
            "
          >
            <mat-expansion-panel-header class="pw-expansion-panel__header">
              <mat-panel-title class="pw-expansion-panel__heading"
                >Purity Details</mat-panel-title
              >
            </mat-expansion-panel-header>
            <ng-container
              *ngIf="(purityDetails$ | async).length > 0; else errorMessage"
            >
              <poss-web-purity-details-view
                [metalTypes]="metalTypes$ | async"
                [itemTypes]="itemTypes$ | async"
                [goldRanges]="goldRanges$ | async"
                [silverRanges]="silverRanges$ | async"
                [platinumRanges]="platinumRanges$ | async"
                [purityDetails]="purityDetails$ | async"
                [dateFormat]="dateFormat"
                (openLocationMapping)="openViewLocationMapping()"
              ></poss-web-purity-details-view>
            </ng-container>
            <ng-template #errorMessage
              ><div class="pw-sub-heading pw-message pw-text-center">
                {{ 'No Records' | translate }}
              </div></ng-template
            >
          </mat-expansion-panel>

          <mat-expansion-panel
            class="pw-expansion-panel"
            [expanded]="expanded"
            *ngIf="gepDetails"
          >
            <mat-expansion-panel-header class="pw-expansion-panel__header">
              <mat-panel-title class="pw-expansion-panel__heading"
                >GEP Details</mat-panel-title
              >
            </mat-expansion-panel-header>
            <poss-web-gep-details-view
              [gepDetails]="gepDetails"
              [dateFormat]="dateFormat"
              (openLocationMapping)="openViewLocationMapping()"
            ></poss-web-gep-details-view>
          </mat-expansion-panel>

          <mat-expansion-panel class="pw-expansion-panel" [expanded]="expanded">
            <mat-expansion-panel-header class="pw-expansion-panel__header">
              <mat-panel-title class="pw-expansion-panel__heading"
                >Theme & ItemCodes</mat-panel-title
              >
            </mat-expansion-panel-header>
            <poss-web-theme-itemcode-view
              [excludeThemeCodes]="excludeThemeCodes"
              [excludeItemCodes]="excludeItemCodes"
              [pageEvent]="excludeItemCodesPageEvent"
              (paginator)="paginate($event)"
              [pageSizeOptions]="pageSizeOptions"
              [minPageSize]="minPageSize"
              [excludeItemCodesCount]="totalItemCodes$ | async"
              (emitItemCode)="excludeItemCodeSearch($event)"
              (clearGridSearch)="clearGridSearch($event)"
              (openLocationMapping)="openViewLocationMapping()"
            ></poss-web-theme-itemcode-view>
          </mat-expansion-panel>

          <mat-expansion-panel class="pw-expansion-panel" [expanded]="expanded">
            <mat-expansion-panel-header class="pw-expansion-panel__header">
              <mat-panel-title class="pw-expansion-panel__heading"
                >Product Group Mapping</mat-panel-title
              >
            </mat-expansion-panel-header>
            <ng-container
              *ngIf="
                (goldRanges$ | async).length;
              "
            >
              <poss-web-product-group-mapping-view
                [isRivaah]="isRivaah"
                [currencyCode]="currencyCode"
                [mappedGroups]="mappedGroups"
                [pageSizeOptions]="pageSizeOptions"
                [pageSize]="pageSize"
                [minPageSize]="minPageSize"
                [ranges]="goldRanges$ | async"
                [pageEvent]="productGroupsPageEvent"
                (productGroupPaginator)="productGroupPaginator($event)"
                [count]="productGroupsCount$ | async"
                (emitProductGroup)="search($event)"
                (clearGridSearch)="clearSearch($event)"
                (openLocationMapping)="openViewLocationMapping()"
              ></poss-web-product-group-mapping-view>
            </ng-container>
          </mat-expansion-panel>
        </mat-accordion>
      </div>
      <div class="row mb-3">
        <div class="col-auto ml-auto">
          <button
            class="pw-btn pw-primary-btn"
            (click)="openViewLocationMapping()"
          >
            {{ 'pw.gePurityConfiguration.locationMappingLabel' | translate }}
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
