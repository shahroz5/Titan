<div class="container-fluid">
  <div class="row">
    <div class="col-12 col-lg-10 m-auto">
      <div class="pw-top-heading-container">
        <div class="row pw-top-heading-container__item">
          <div class="col-auto">
            <div class="pw-top-heading-container__main-head">
              <a (click)="back()">
                <span class="pw-i-24 pw-back-arrow-icon-24"></span>
              </a>
              <span class="pw-i-36 pw-customer-transaction-icon-36"></span>
              <div>
                <h2>
                  {{ 'pw.gePurityConfiguration.offerLabel' | translate }}
                </h2>
                <h5 class="pw-top-heading-container__sub-heading">
                  {{
                    'pw.gePurityConfiguration.configurationLabel' | translate
                  }}
                </h5>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="row pw-sub-header">
        <div class="col-auto">
          <div class="pw-sub-header__padding-heading">
            {{ 'pw.gePurityConfiguration.gepPurityConfigLabel' | translate }}
          </div>
        </div>
      </div>
      <div class="pw-min-height">
        <div class="row">
          <div class="col-lg-12">
            <div class="pw-form-card">
              <div class="row" [formGroup]="configurationForm">
                <div class="col-lg-11 col-12">
                  <mat-form-field class="col-lg-11 col-12">
                    <mat-label class="pw-fourth-color">{{
                      'pw.gePurityConfiguration.configurationNameLabel'
                        | translate
                    }}</mat-label>
                    <input
                      matInput
                      class="pw-single-bordered-input"
                      formControlName="description"
                      [value]="gepDetails?.description"
                    />
                    <mat-error
                      *ngIf="
                        configurationForm.get('description').errors &&
                        configurationForm.get('description').errors.errorArray
                      "
                    >
                      <poss-web-error-info-tooltip
                        [errorMessage]="
                          configurationForm.get('description').errors.errorArray
                        "
                      ></poss-web-error-info-tooltip>
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="pw-tab mt-4">
          <ul class="pw-tab__list">
            <li class="pw-tab__list-item">
              <a
                (click)="tab(GepPurityConfigEnumsRef.PURITY_DETAILS)"
                [class.pw-is-active-bar]="
                  tabType === GepPurityConfigEnumsRef.PURITY_DETAILS
                "
              >
                <h5 class="pw-tab__item">
                  {{ 'pw.gePurityConfiguration.purityDetails' | translate }}
                </h5></a
              >
            </li>
            <li class="pw-tab__list-item">
              <a
                (click)="tab(GepPurityConfigEnumsRef.GEP_DETAILS)"
                [class.pw-is-active-bar]="
                  tabType === GepPurityConfigEnumsRef.GEP_DETAILS
                "
              >
                <h5 class="pw-tab__item">
                  {{ 'pw.gePurityConfiguration.gepDetailsLabel' | translate }}
                </h5>
              </a>
            </li>

            <li
              class="pw-tab__list-item"
              [class.pw-is-active-bar]="
                tabType === GepPurityConfigEnumsRef.EXCLUDE_THEME_ITEM_CODES
              "
            >
              <a
                (click)="tab(GepPurityConfigEnumsRef.EXCLUDE_THEME_ITEM_CODES)"
                [class.disable]="configId === 'new' ? true : false"
              >
                <h5 class="pw-tab__item">
                  {{
                    'pw.gePurityConfiguration.excludeThemeCodes&ItemCodesLabel'
                      | translate
                  }}
                </h5></a
              >
            </li>
            <li
              class="pw-tab__list-item"
              [class.pw-is-active-bar]="
                tabType === GepPurityConfigEnumsRef.PRODUCT_GROUP_MAPPING
              "
            >
              <a
                (click)="tab(GepPurityConfigEnumsRef.PRODUCT_GROUP_MAPPING)"
                [class.disable]="configId === 'new' ? true : false"
              >
                <h5 class="pw-tab__item">
                  {{
                    'pw.gePurityConfiguration.productGroupMapping' | translate
                  }}
                </h5>
              </a>
            </li>
          </ul>
        </div>

        <poss-web-gep-details
          *ngIf="tabType === GepPurityConfigEnumsRef.GEP_DETAILS"
          (saveGepDetails)="saveGEPDetails($event)"
          [gepDetails]="gepDetails"
          [configId]="configId"
          [isParentFormValid]="configurationForm.valid"
          (emitLocationMapping)="locationMapping()"
          [isLocationMapping]="isLocationEnable"
        ></poss-web-gep-details>
        <poss-web-purity-details
          *ngIf="
            tabType === GepPurityConfigEnumsRef.PURITY_DETAILS &&
            (metalTypes$ | async) &&
            (itemTypes$ | async)
          "
          [metalTypes]="metalTypes$ | async"
          [itemTypes]="itemTypes$ | async"
          [goldRanges]="goldRanges"
          [silverRanges]="silverRanges"
          [platinumRanges]="platinumRanges"
          [purityDetails]="purityDetails"
          (savePurityDetails)="savePurityDetails($event)"
          [isParentFormValid]="configurationForm.valid"
          (emitLocationMapping)="locationMapping()"
          [isLocationMapping]="isLocationEnable"
          [savedPurityDetails]="savedPurityDetails"
          (deletePurityDetails)="deletePurityDetails($event)"
          (emitRangeType)="emitRangeType($event)"
          [dateFormat]="dateFormat"
          [configId]="configId"
          [selectedLocations]="selectedLocation"
          [formGroup]="configurationForm"
        ></poss-web-purity-details>
        <div
          [hidden]="
            tabType !== GepPurityConfigEnumsRef.EXCLUDE_THEME_ITEM_CODES
          "
        >
          <poss-web-exclude-theme-item-codes
            [excludeThemeCodes]="excludeThemeCodes"
            [excludeItemCodes]="excludeItemCodes"
            (deleteThemeCode)="removeThemeCode($event)"
            [isParentFormValid]="configurationForm.valid"
            (emitLocationMapping)="locationMapping()"
            [isLocationMapping]="isLocationEnable"
            [pageEvent]="excludeItemCodesPageEvent"
            (paginator)="paginate($event)"
            [pageSizeOptions]="pageSizeOptions"
            [minPageSize]="minPageSize"
            [excludeItemCodesCount]="totalItemCodes$ | async"
            [formGroup]="configurationForm"
            (emitThemeCode)="addThemeCode($event)"
            (emitSearchValue)="excludeItemCodeSearch($event)"
            (clearEvent)="clearExcludeItemCodes()"
            (downloadFileEvent)="downloadFile()"
            (uploadFileEvent)="uploadFile($event)"
          ></poss-web-exclude-theme-item-codes>
        </div>

        <poss-web-product-group-mapping
          *ngIf="
            tabType === GepPurityConfigEnumsRef.PRODUCT_GROUP_MAPPING &&
            (goldRanges$ | async)
          "
          [isRivaah]="isRivaah"
          [currencyCode]="currencyCode"
          [productGroups]="productGroups"
          [pageSizeOptions]="pageSizeOptions"
          [pageSize]="pageSize"
          [minPageSize]="minPageSize"
          [ranges]="goldRanges$ | async"
          [isParentFormValid]="configurationForm.valid"
          (productGroupDeduction)="productGroupDeduction($event)"
          [mappedGroups]="mappedGroups"
          (deleteProductGroup)="deleteProductGroup($event)"
          (emitGridData)="emitGridData($event)"
          (emitLocationMapping)="locationMapping()"
          [isLocationMapping]="isLocationEnable"
          [pageEvent]="productGroupsPageEvent"
          (productGroupPaginator)="productGroupPaginator($event)"
          [count]="productGroupsCount$ | async"
          (openPgPopup)="openProductGroupMapping()"
          (updateProductData)="updateProductData($event)"
          (emitSearchValue)="search($event)"
          (clearEvent)="clearSearch()"
        ></poss-web-product-group-mapping>
        <poss-web-loader *ngIf="isLoading$ | async"></poss-web-loader>
      </div>
      <ng-template #confirmFileUploadNotification>
        <div class="pw-text-center">
          <h3 class="pw-success-color">
            {{ 'pw.fileStatus.fileUploadStatusMessage' | translate }}
            <u class="pw-success-color" (click)="fileStatus()">
              {{ 'pw.fileStatus.fileStatus' | translate }}</u
            >
          </h3>
        </div>
      </ng-template>
    </div>
  </div>
</div>
