<div class="pw-white-overlay-box">
  <div class="mg-t-50"></div>
  <div class="pw-confirmation-box pw-confirmation-box__width-450">
    <div class="row pw-confirmation-box__header">
      <div class="col-auto">
        {{ 'pw.gePurityConfiguration.addDeductionPercentageLabel' | translate }}
      </div>
      <div class="col pw-text-right">
        <a (click)="close()">
          <span class="pw-i-24 pw-close-no-border-icon-24"></span>
        </a>
      </div>
    </div>
    <div class="pw-confirmation-box__body"></div>
    <div class="pw-confirmation-box__body" [formGroup]="multiFormGroup">
      <div class="row">
        <div class="col-xl-6 col-lg-6 col-6" formGroupName="deductionFormGroup">
          <table class="pw-grid-table" aria-describedby="table">
            <thead>
              <tr class="pw-grid-table__background-header">
                <th class="pw-grid-table__header-item" scope="col">
                  {{ 'pw.addDeductionForm.purityRange' | translate }}
                </th>
                <th class="pw-grid-table__header-item" scope="col">
                  {{ 'pw.addDeductionForm.dedPercentage' | translate }}
                </th>
              </tr>
            </thead>
            <tbody class="pw-grid-table__body">
              <tr class="pw-grid-table__row" *ngFor="let range of this.data.ranges">
                <td class="pw-grid-table__item">{{ range.range }}</td>
                <td class="pw-grid-table__item">
                  <mat-form-field
                    appearance="outline"
                    class="col-lg-8 col-12 pw-full-bordered-input-box pw-mat-form-field pw-form-field-padding-bottom-0"
                  >
                    <input matInput [formControlName]="range.id" />
                  </mat-form-field>
                  <ng-container
                    *ngIf="
                      multiFormGroup.get('deductionFormGroup').get(range.id)?.errors
                        ?.errorArray &&
                      multiFormGroup.get('deductionFormGroup').get(range.id).touched
                    "
                  >
                    <poss-web-error-info-tooltip
                      [errorMessage]="
                        multiFormGroup.get('deductionFormGroup').get(range.id)
                          ?.errors?.errorArray
                      "
                      [isOnlyTooltip]="true"
                      (click)="$event.stopPropagation()"
                    >
                    </poss-web-error-info-tooltip>
                  </ng-container>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <div
          class="col-xl-6 col-lg-6 col-6 mt-2"
          formGroupName="rivaahFormGroup"
          *ngIf="this.data.isRivaah"
        >
          <div class="row align-items-center">
            <div class="col-auto">
              <mat-label>
                {{ 'pw.addDeductionForm.rivaahDiscountLabel' | translate }}
              </mat-label>
            </div>
          </div>
          <div class="row align-items-center mt-2">
            <mat-form-field
              appearance="outline"
              class="col-lg-8 col-12 pw-full-bordered-input-box pw-mat-form-field pw-form-field-padding-bottom-0"
            >
              <input matInput formControlName="rivaahAdditionalDiscount" />
            </mat-form-field>
            <ng-container
              *ngIf="
                multiFormGroup
                  .get('rivaahFormGroup')
                  .get('rivaahAdditionalDiscount')?.errors?.errorArray &&
                multiFormGroup
                  .get('rivaahFormGroup')
                  .get('rivaahAdditionalDiscount').touched
              "
            >
              <poss-web-error-info-tooltip
                [errorMessage]="
                  multiFormGroup
                    .get('rivaahFormGroup')
                    .get('rivaahAdditionalDiscount')?.errors?.errorArray
                "
                [isOnlyTooltip]="true"
                (click)="$event.stopPropagation()"
              >
              </poss-web-error-info-tooltip>
            </ng-container>
          </div>
        </div>
      </div>
    </div>
    <div class="pw-confirmation-box__footer">
      <div class="row pw-confirmation-box__footer-border">
        <div class="col-auto">
          <button
            class="pw-btn pw-accent-btn"
            (click)="apply()"
            [disabled]="!this.multiFormGroup.valid"
          >
            {{ 'pw.gePurityConfiguration.applyLabel' | translate }}
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
