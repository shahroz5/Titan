<div class="row mt-3 align-items-center">
  <mat-form-field
    class="col-lg-3 col-sm-4 pw-search-bar ml-auto"
    [class.ml-auto]="stockReceiveType !== stockReceiveEnumRef.HISTORY"
  >
    <mat-label>{{
      'pw.stockReceive.stnSearchPlaceholder' | translate
    }}</mat-label>

    <input
      #searchBox
      id="searchBox"
      matInput
      class="pw-input-box"
      [formControl]="searchFormControl"
      autocomplete="off"
      (keypress)="searchKeyCheck($event)"
    />
    <mat-icon matSuffix>
      <span
        *ngIf="!searchFormControl.value"
        class="pw-i-16 pw-search-icon-16"
      ></span
    ></mat-icon>
    <mat-icon matSuffix (click)="clearSearch()">
      <span
        *ngIf="searchFormControl.value"
        class="pw-i-10 pw-close-icon-16"
      ></span
    ></mat-icon>
  </mat-form-field>
</div>
<poss-web-card-list
  [count]="
    (isSearchingStocks$ | async) === false &&
    (hasSearchStockResults$ | async) === false
      ? (pendingFactorySTNCount$ | async)
      : 0
  "
  [dataList]="
    (isSearchingStocks$ | async) === false &&
    (hasSearchStockResults$ | async) === false
      ? (pendingFactorySTN$ | async)
      : (searchStockResults$ | async)
  "
  [pageSize]="pageSize"
  (loadMore)="loadStocks($event)"
  (selected)="onSelected($event)"
>
  <ng-template let-item="data">
    <poss-web-card-title>
      <div class="row">
        <div class="col-auto">
          <h4>
            {{ 'pw.stockReceive.stnNoLable' | translate }} :
            {{ item.srcDocNo }}
          </h4>
        </div>
        <div class="col-auto ml-auto">
          <p class="pw-seventh-color">
            <span class="pw-font-weight-bold"> {{ item.orderType }}</span>
          </p>
        </div>
      </div>
    </poss-web-card-title>
    <poss-web-card-subtitle>
      {{ item.srcLocationCode }} | {{ item.srcLocationDescription }}
    </poss-web-card-subtitle>
    <poss-web-card-content>
      <div class="mt-1">
        <p>
          {{ item.totalAvailableQuantity }}
          {{ 'pw.stockReceive.quantityLableText' | translate }} |
          {{ item.totalAvailableValue | currencyFormatter: item.currencyCode }}
        </p>
        <p>
          {{ 'pw.stockReceive.stnDateLable' | translate }} :
          {{ item.srcDocDate | dateFormatter }}
        </p>

        <p>
          <ng-container
            *ngIf="
              item?.courierDetails.type ==
              stockReceiveCarrierTypesEnumRef.COURIER
            "
          >
            {{ 'pw.stockReceive.courierLableText' | translate }} :
            {{ item?.courierDetails.data.companyName }}
          </ng-container>
          <ng-container
            *ngIf="
            item?.courierDetails.type ==
              stockReceiveCarrierTypesEnumRef.EMPLOYEE
            "
          >
            {{ 'pw.stockReceive.employeeLableText' | translate }} :
            {{ item?.courierDetails.data.employeeName }}
          </ng-container>
        </p>
        <p>
          <ng-container
            *ngIf="
              item?.courierDetails.type ==
              stockReceiveCarrierTypesEnumRef.COURIER
            "
          >
            {{ 'pw.stockReceive.courierdocketNumberLableText' | translate }} :
            {{ item?.courierDetails.data.docketNumber }}
          </ng-container>
          <ng-container
            *ngIf="
            item?.courierDetails.type ==
              stockReceiveCarrierTypesEnumRef.EMPLOYEE
            "
          >
            {{ 'pw.stockReceive.employeeIdLableText' | translate }} :
            {{ item?.courierDetails.data.employeeId }}
          </ng-container>
        </p>
      </div>
    </poss-web-card-content>
  </ng-template>
</poss-web-card-list>
<ng-container *ngIf="isL1L2Store">
  <h3
    class="pw-text-center m-5 pw-success-color"
    *ngIf="
      isLoadingPendingFactorySTN == false &&
      (isSearchingStocks$ | async) === false &&
      stockReceiveType == stockReceiveEnumRef.FAC_BTQ &&
      (hasSearchStockResults$ | async) === false &&
      (pendingFactorySTN$ | async) &&
      (pendingFactorySTN$ | async).length === 0
    "
  >
    {{ noDataFoundMessageSTN }}
  </h3>

  <h3
    class="pw-text-center m-5 pw-success-color"
    *ngIf="
      isLoadingPendingFactorySTN == false &&
      (isSearchingStocks$ | async) === false &&
      (hasSearchStockResults$ | async) &&
      (searchStockResults$ | async) &&
      (searchStockResults$ | async).length === 0
    "
  >
    <ng-container>
      <ng-container *ngIf="!hasFromFetchedOracle">
        {{ 'pw.stockReceive.fetchFromOracleMessage1' | translate }}
        {{ searchedSrcDocNumber }}
        {{ 'pw.stockReceive.fetchFromOracleMessage2' | translate }}
        <br />
        <button
          mat-button
          class="pw-btn pw-primary-btn mt-2"
          (click)="fetchSTNFromOracle()"
        >
          {{ 'pw.stockReceive.proceedButton' | translate }}
        </button>
      </ng-container>
      <ng-container *ngIf="hasFromFetchedOracle">
        {{ 'pw.stockReceive.fetchFromOracleMessage3' | translate }}
      </ng-container>
    </ng-container>
  </h3>
</ng-container>

<poss-web-loader
  *ngIf="
    isLoadingPendingFactorySTN ||
    (isLoadingCount$ | async) ||
    (isSearchingStocks$ | async)
  "
>
</poss-web-loader>
