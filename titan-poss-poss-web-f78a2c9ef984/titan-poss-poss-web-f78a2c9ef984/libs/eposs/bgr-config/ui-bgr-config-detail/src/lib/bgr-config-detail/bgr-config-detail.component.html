<form [formGroup]="bgrConfigDetailsForm">
  <div class="pw-form-card pw-bgr-padding-top">
    <div class="row">
      <div class="col-lg-4 col-5">
        <mat-form-field
          class="pw-single-bordered-input pw-form-field-padding-bottom-0 col-lg-12 col-12"
          [floatLabel]="'always'"
        >
          <mat-label class="pw-fourth-color">{{
            'pw.bgrConfigurations.bestGoldRateOfferLabel' | translate
          }}</mat-label>
          <mat-date-range-input
            [rangePicker]="picker"
            (click)="picker.open()"
            [min]="currentDate"
          >
            <input
              matStartDate
              formControlName="bgrOfferFirstDay"
              placeholder="DD/MM/YYYY"
              readonly
            />
            <input
              matEndDate
              formControlName="bgrOfferLastDay"
              placeholder="DD/MM/YYYY"
              readonly
            />
          </mat-date-range-input>
          <mat-datepicker-toggle matSuffix [for]="picker">
            <mat-icon matDatepickerToggleIcon>
              <span class="pw-i-12 pw-calender-icon-12"></span>
            </mat-icon>
          </mat-datepicker-toggle>
          <mat-date-range-picker #picker></mat-date-range-picker>
        </mat-form-field>
        <mat-error
          class="col-lg-12 col-12"
          *ngIf="
            bgrConfigDetailsForm.get('bgrOfferFirstDay').errors &&
            bgrConfigDetailsForm.get('bgrOfferFirstDay').errors.errorArray
          "
        >
          <poss-web-error-info-tooltip
            [errorMessage]="
              bgrConfigDetailsForm.get('bgrOfferFirstDay').errors.errorArray
            "
          >
          </poss-web-error-info-tooltip>
        </mat-error>
        <mat-error
          class="col-lg-12 col-12"
          *ngIf="
            bgrConfigDetailsForm.get('bgrOfferLastDay').errors &&
            bgrConfigDetailsForm.get('bgrOfferLastDay').errors.errorArray
          "
        >
          <poss-web-error-info-tooltip
            [errorMessage]="
              bgrConfigDetailsForm.get('bgrOfferLastDay').errors.errorArray
            "
          >
          </poss-web-error-info-tooltip>
        </mat-error>
        <mat-error
          *ngIf="
            bgrConfigDetailsForm?.get('bgrOfferFirstDay')?.errors
              ?.matDatepickerMin
          "
          class="col-lg-12 col-12"
        >
          <span>{{ 'Offer date range is invalid.' }}</span>
        </mat-error>
      </div>
      <div class="col-lg-4 col-5">
        <mat-form-field
          class="pw-single-bordered-input pw-form-field-padding-bottom-0 col-lg-12 col-12"
          [floatLabel]="'always'"
        >
          <mat-label class="pw-fourth-color">{{
            'pw.bgrConfigurations.redemptionLabel' | translate
          }}</mat-label>
          <mat-date-range-input
            [rangePicker]="picker1"
            (click)="picker1.open()"
            [min]="minDateValidation()"
          >
            <input
              matStartDate
              formControlName="bgrRedemptionFirstDay"
              placeholder="DD/MM/YYYY"
              readonly
            />
            <input
              matEndDate
              formControlName="bgrRedemptionLastDay"
              placeholder="DD/MM/YYYY"
              readonly
            />
          </mat-date-range-input>
          <mat-datepicker-toggle matSuffix [for]="picker1">
            <mat-icon matDatepickerToggleIcon>
              <span class="pw-i-12 pw-calender-icon-12"></span>
            </mat-icon>
          </mat-datepicker-toggle>
          <mat-date-range-picker #picker1></mat-date-range-picker>
        </mat-form-field>
        <mat-error
          class="col-lg-12 col-12"
          *ngIf="
            bgrConfigDetailsForm.get('bgrRedemptionFirstDay').errors &&
            bgrConfigDetailsForm.get('bgrRedemptionFirstDay').errors.errorArray
          "
        >
          <poss-web-error-info-tooltip
            [errorMessage]="
              bgrConfigDetailsForm.get('bgrRedemptionFirstDay').errors
                .errorArray
            "
          >
          </poss-web-error-info-tooltip>
        </mat-error>
        <mat-error
          class="col-lg-12 col-12"
          *ngIf="
            bgrConfigDetailsForm.get('bgrRedemptionLastDay').errors &&
            bgrConfigDetailsForm.get('bgrRedemptionLastDay').errors.errorArray
          "
        >
          <poss-web-error-info-tooltip
            [errorMessage]="
              bgrConfigDetailsForm.get('bgrRedemptionLastDay').errors.errorArray
            "
          >
          </poss-web-error-info-tooltip>
        </mat-error>
        <mat-error
          *ngIf="
            bgrConfigDetailsForm?.get('bgrRedemptionFirstDay')?.errors
              ?.matDatepickerMin
          "
          class="col-lg-12 col-12"
        >
          <span>{{ 'Redemption date range is invalid.' }}</span>
        </mat-error>
        <mat-error
          class="col-lg-12 col-12"
          *ngIf="
            bgrConfigDetailsForm.get('bgrRedemptionFirstDay').errors &&
            !bgrConfigDetailsForm.get('bgrRedemptionFirstDay').errors.errorArray &&
            bgrConfigDetailsForm.get('bgrRedemptionFirstDay').errors.invalidDateSelected
        "
        >
        Redemption Start Date should be greater than or equal to
          {{ bgrOfferFirstDay | date:'dd-MMM-y' }}
        </mat-error>
      </div>
    </div>
    <div class="row pw-form-card__margin-top">
      <div class="col-lg-4 col-5">
        <div class="pw-bgr-config-field-title">
          {{ 'pw.bgrConfigurations.downSideAmountLabel' | translate }}
        </div>
        <mat-form-field
          class="pw-full-bordered-input-box col-lg-12 col-12"
          appearance="outline"
        >
          <input
            matInput
            formControlName="downSideAmount"
            type="text"
            [allowDecimal]="false"
            possWebAmountInput
          />
          <!-- possWebAmountInput -->
          <mat-error
            *ngIf="
              bgrConfigDetailsForm.get('downSideAmount').errors &&
              bgrConfigDetailsForm.get('downSideAmount').errors.errorArray
            "
          >
            <poss-web-error-info-tooltip
              [errorMessage]="
                bgrConfigDetailsForm.get('downSideAmount').errors.errorArray
              "
            >
            </poss-web-error-info-tooltip>
          </mat-error>
        </mat-form-field>
      </div>
    </div>
    <h4 class="pw-bgr-config-field-title">
      {{ 'pw.bgrConfigurations.applicableGoldRateLabel' | translate }}
    </h4>
    <div class="row">
      <div class="col-lg-4 col-5">
        <poss-web-select-dropdown
          class="pw-selectable-dropdown col-lg-12 col-12"
          [control]="bgrConfigDetailsForm.get('otherOption')"
          [options]="otherOptions"
          [required]="true"
          (selectionChange)="onOtherOptionChanged($event)"
        ></poss-web-select-dropdown>
      </div>
      <div
        class="col-lg-5 col-5 pw-bgr-other-options-radio-container"
        *ngIf="
          bgrConfigDetailsForm.get('otherOption').value ===
          otherOptionTypes.PARTICULAR_DATE
        "
      >
        <mat-radio-group
          class="col-auto"
          aria-labelledby="example-radio-group-label"
          aria-label="Select an option"
          formControlName="selectedGoldRateType"
        >
          <mat-radio-button
            class="pw-radio-btn mr-3"
            [value]="goldRateTypesEnum?.FIRST_GOLD_RATE"
          >
            {{ 'pw.bgrConfigurations.firstGoldRate' | translate }}
          </mat-radio-button>
          <mat-radio-button
            class="pw-radio-btn"
            [value]="goldRateTypesEnum?.LAST_GOLD_RATE"
          >
            {{ 'pw.bgrConfigurations.lastGoldRate' | translate }}
          </mat-radio-button>
        </mat-radio-group>
      </div>
    </div>
    <div
      class="row"
      *ngIf="
        bgrConfigDetailsForm.get('otherOption').value ===
        otherOptionTypes.PARTICULAR_DATE
      "
    >
      <div class="col-lg-4 col-5">
        <div class="pw-bgr-config-field-title">
          {{ 'Applicable Date' }}
        </div>
        <mat-form-field
          class="pw-full-bordered-input-box pw-form-field-padding-bottom-0 col-lg-12 col-12"
          appearance="outline"
        >
          <input
            matInput
            [matDatepicker]="datepicker"
            formControlName="applicableDate"
            (click)="datepicker.open()"
            placeholder="DD/MM/YYYY"
            required
          />
          <mat-datepicker-toggle
            matSuffix
            [for]="datepicker"
          ></mat-datepicker-toggle>
          <mat-datepicker #datepicker></mat-datepicker>
        </mat-form-field>
        <mat-error
          class="col-lg-12 col-12"
          *ngIf="
            bgrConfigDetailsForm.get('applicableDate').errors &&
            bgrConfigDetailsForm.get('applicableDate').errors.errorArray
          "
        >
          <poss-web-error-info-tooltip
            [errorMessage]="
              bgrConfigDetailsForm.get('applicableDate').errors.errorArray
            "
          >
          </poss-web-error-info-tooltip>
        </mat-error>
      </div>
    </div>
  </div>

  <div class="row mb-3">
    <div class="col-auto ml-auto">
      <button
        class="pw-btn pw-primary-btn"
        type="button"
        (click)="openLocationMapping()"
        [disabled]="isNew || isConfigNameInValid"
      >
        {{ 'pw.weightValueConfig.locationMapping' | translate }}
      </button>
    </div>
    <div class="col-auto">
      <button
        (click)="onSubmit()"
        class="pw-btn pw-accent-btn"
        type="submit"
        [disabled]="bgrConfigDetailsForm.invalid || isConfigNameInValid"
      >
        {{ 'pw.weightValueConfig.save' | translate }}
      </button>
    </div>
  </div>
</form>
