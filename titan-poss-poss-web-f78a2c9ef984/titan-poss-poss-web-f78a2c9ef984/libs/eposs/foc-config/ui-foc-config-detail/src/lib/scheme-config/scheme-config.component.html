<form [formGroup]="schemeConfigurationForm">
  <div class="pw-form-card">
    <div class="row">
      <mat-form-field class="col-lg-4 col-4">
        <mat-label>
          {{ 'pw.focConfiguration.schemeNameLabel' | translate }}</mat-label
        >
        <input
          matInput
          formControlName="schemeName"
          class="pw-single-bordered-input"
        />

        <mat-error
          *ngIf="
            schemeConfigurationForm.get('schemeName').errors &&
            schemeConfigurationForm.get('schemeName').errors.errorArray
          "
        >
          <poss-web-error-info-tooltip
            [errorMessage]="
              schemeConfigurationForm.get('schemeName').errors.errorArray
            "
          ></poss-web-error-info-tooltip>
        </mat-error>
      </mat-form-field>
      <mat-form-field class="col-lg-4 col-4">
        <mat-label>
          {{ 'pw.focConfiguration.descriptionLabel' | translate }}</mat-label
        >
        <input
          matInput
          formControlName="description"
          class="pw-single-bordered-input"
        />

        <mat-error
          *ngIf="
            schemeConfigurationForm.get('description').errors &&
            schemeConfigurationForm.get('description').errors.errorArray
          "
        >
          <poss-web-error-info-tooltip
            [errorMessage]="
              schemeConfigurationForm.get('description').errors.errorArray
            "
          ></poss-web-error-info-tooltip>
        </mat-error>
      </mat-form-field>

    </div>
  </div>
  <div class="pw-form-card">
    <h4 class="mb-3">
      {{ 'pw.focConfiguration.clubbingWithOtherOffers' | translate }}
    </h4>
    <div class="row">
      <div class="col-auto col-lg-4 pw-form-card__align-center mb-3">
        <mat-checkbox formControlName="isClubbedWithExchangeOffers">
          {{
            'pw.focConfiguration.isClubbedWithExchangeOffersLabel' | translate
          }}</mat-checkbox
        >
      </div>
      <div class="col-auto col-lg-4 pw-form-card__align-center mb-3">
        <mat-checkbox formControlName="isClubbedWithGHSAccountMaturity">
          {{
            'pw.focConfiguration.isClubbedWithGHSAccountMaturity' | translate
          }}</mat-checkbox
        >
      </div>
      <div class="col-auto col-lg-4 pw-form-card__align-center mb-3">
        <mat-checkbox formControlName="isClubbedWithDV">
          {{ 'pw.focConfiguration.isClubbedWithDV' | translate }}</mat-checkbox
        >
      </div>
    </div>
    <div class="row">
      <div class="col-auto col-lg-4 pw-form-card__align-center">
        <mat-checkbox formControlName="isClubbedWithCBO">
          {{ 'pw.focConfiguration.isClubbedWithCBO' | translate }}</mat-checkbox
        >
      </div>
      <div class="col-auto col-lg-4 pw-form-card__align-center">
        <mat-checkbox formControlName="isClubbedWithRIVAJPP">
          {{
            'pw.focConfiguration.isClubbedWithRIVAJPP' | translate
          }}</mat-checkbox
        >
      </div>
    </div>
  </div>

  <mat-accordion multi>
    <mat-expansion-panel class="pw-expansion-panel">
      <mat-expansion-panel-header
        class="pw-expansion-panel__header"
        [collapsedHeight]="'40px'"
        [expandedHeight]="'40px'"
      >
        <mat-panel-title class="pw-expansion-panel__heading">
          {{ 'pw.focConfiguration.GRNConfiguration' | translate }}
        </mat-panel-title>
      </mat-expansion-panel-header>

      <div class="row">
        <div class="col-6 col-lg-4">
          <div class="pw-bordered-accordion__label">
            {{
              'pw.focConfiguration.noOfDaysBeforeOfferPeriodForGrnLabel'
                | translate
            }}
          </div>
          <div class="row">
            <mat-form-field
              appearance="outline"
              class="col-auto pw-full-bordered-input-box"
            >
              <input
                formControlName="noOfDaysBeforeOfferPeriodForGrn"
                matInput
              />
              <mat-error
                *ngIf="
                  schemeConfigurationForm.get('noOfDaysBeforeOfferPeriodForGrn')
                    .touched &&
                  schemeConfigurationForm.get('noOfDaysBeforeOfferPeriodForGrn')
                    .errors &&
                  schemeConfigurationForm.get('noOfDaysBeforeOfferPeriodForGrn')
                    .errors.errorArray
                "
              >
                <poss-web-error-info-tooltip
                  [errorMessage]="
                    schemeConfigurationForm.get(
                      'noOfDaysBeforeOfferPeriodForGrn'
                    ).errors.errorArray
                  "
                ></poss-web-error-info-tooltip>
              </mat-error>
            </mat-form-field>
          </div>
        </div>
        <div class="col-5 col-lg-4">
          <div class="pw-bordered-accordion__label">
            {{ 'pw.focConfiguration.GRNUtilizationPercentage' | translate }}
          </div>
          <div class="row">
            <mat-form-field
              appearance="outline"
              class="col-auto pw-full-bordered-input-box"
            >
              <input formControlName="grnUtilizationPercentage" matInput />

              <mat-error
                *ngIf="
                  schemeConfigurationForm.get('grnUtilizationPercentage')
                    .touched &&
                  schemeConfigurationForm.get('grnUtilizationPercentage')
                    .errors &&
                  schemeConfigurationForm.get('grnUtilizationPercentage').errors
                    .errorArray
                "
              >
                <poss-web-error-info-tooltip
                  [errorMessage]="
                    schemeConfigurationForm.get('grnUtilizationPercentage')
                      .errors.errorArray
                  "
                ></poss-web-error-info-tooltip>
              </mat-error>
            </mat-form-field>
          </div>
        </div>
      </div>

      <div class="pw-bordered-accordion__label">
        {{
          'pw.focConfiguration.noOfDaysAfterOfferPeriodForGrnLabel' | translate
        }}
      </div>
      <div class="row">
        <mat-form-field
          appearance="outline"
          class="col-auto pw-full-bordered-input-box"
        >
          <input formControlName="noOfDaysAfterOfferPeriodForGrn" matInput />

          <mat-error
            *ngIf="
              schemeConfigurationForm.get('noOfDaysAfterOfferPeriodForGrn')
                .touched &&
              schemeConfigurationForm.get('noOfDaysAfterOfferPeriodForGrn')
                .errors &&
              schemeConfigurationForm.get('noOfDaysAfterOfferPeriodForGrn')
                .errors.errorArray
            "
          >
            <poss-web-error-info-tooltip
              [errorMessage]="
                schemeConfigurationForm.get('noOfDaysAfterOfferPeriodForGrn')
                  .errors.errorArray
              "
            ></poss-web-error-info-tooltip>
          </mat-error>
        </mat-form-field>
      </div>
    </mat-expansion-panel>

    <mat-expansion-panel class="pw-expansion-panel">
      <mat-expansion-panel-header
        class="pw-expansion-panel__header"
        [collapsedHeight]="'40px'"
        [expandedHeight]="'40px'"
      >
        <mat-panel-title class="pw-expansion-panel__heading">
          {{ 'pw.focConfiguration.TEPDiscountRecovery' | translate }}
        </mat-panel-title>
      </mat-expansion-panel-header>

      <div class="row mt-2 ml-1">
        <div class="col-auto">
          <mat-checkbox
            (change)="checkboxChange($event)"
            formControlName="isTepRecoveryEnabled"
          >
            {{
              'pw.focConfiguration.isTEPRecoveryEnabled' | translate
            }}</mat-checkbox
          >
        </div>
      </div>

      <div [hidden]="isChecked === false">
        <div class="row">
          <div class="col-lg-9 col-8 ml-auto">
            <button class="pw-btn pw-primary-btn" (click)="addAnother()">
              <span class="pw-i-24 pw-add-icon-24"></span>
              {{ 'pw.focConfiguration.addAnotherLabel' | translate }}
            </button>
          </div>
        </div>
        <div class="row ml-1 mt-2">
          <div class="col-lg-5 col-8">
            <ag-grid-angular
              class="pw-titan-poss-theme pw-ag-grid-table"
              [columnDefs]="columnDefs"
              editType="fullRow"
              [singleClickEdit]="true"
              [domLayout]="domLayout"
              [context]="getContext()"
              [frameworkComponents]="getComponents()"
              (rowValueChanged)="rowValueChanged()"
              (rowEditingStarted)="rowEditingStarted()"
              (gridReady)="gridReady($event)"
            ></ag-grid-angular>
          </div>
        </div>
      </div>
    </mat-expansion-panel>

    <mat-expansion-panel class="pw-expansion-panel">
      <mat-expansion-panel-header
        class="pw-expansion-panel__header"
        [collapsedHeight]="'40px'"
        [expandedHeight]="'40px'"
      >
        <mat-panel-title class="pw-expansion-panel__heading">
          {{ 'pw.focConfiguration.AB/COConfiguration' | translate }}
        </mat-panel-title>
      </mat-expansion-panel-header>
      <div class="row py-3">
        <div class="col-lg-4 col-6 pw-br">
          <div class="pw-bordered-accordion__label">
            {{
              'pw.focConfiguration.noOfDaysAfterPeriodForCoLabel' | translate
            }}
          </div>
          <div class="row">
            <mat-form-field
              appearance="outline"
              class="col-auto pw-full-bordered-input-box"
            >
              <input formControlName="noOfDaysAfterPeriodForCo" matInput />
              <mat-error
                *ngIf="
                  schemeConfigurationForm.get('noOfDaysAfterPeriodForCo')
                    .touched &&
                  schemeConfigurationForm.get('noOfDaysAfterPeriodForCo')
                    .errors &&
                  schemeConfigurationForm.get('noOfDaysAfterPeriodForCo').errors
                    .errorArray
                "
              >
                <poss-web-error-info-tooltip
                  [errorMessage]="
                    schemeConfigurationForm.get('noOfDaysAfterPeriodForCo')
                      .errors.errorArray
                  "
                ></poss-web-error-info-tooltip>
              </mat-error>
            </mat-form-field>
          </div>

          <div class="pw-bordered-accordion__label">
            {{ 'pw.focConfiguration.coUtilizationPercentageLabel' | translate }}
          </div>
          <div class="row">
            <mat-form-field
              appearance="outline"
              class="col-auto pw-full-bordered-input-box"
            >
              <input formControlName="coUtilizationPercentage" matInput />
              <mat-error
                *ngIf="
                  schemeConfigurationForm.get('coUtilizationPercentage')
                    .touched &&
                  schemeConfigurationForm.get('coUtilizationPercentage')
                    .errors &&
                  schemeConfigurationForm.get('coUtilizationPercentage').errors
                    .errorArray
                "
              >
                <poss-web-error-info-tooltip
                  [errorMessage]="
                    schemeConfigurationForm.get('coUtilizationPercentage')
                      .errors.errorArray
                  "
                ></poss-web-error-info-tooltip>
              </mat-error>
            </mat-form-field>
          </div>

          <mat-checkbox formControlName="isGoldRateForzenForCo">
            {{
              'pw.focConfiguration.isGoldRateForzenForCo' | translate
            }}</mat-checkbox
          >
        </div>
        <div class="col-lg-5 col-auto">
          <div class="pw-bordered-accordion__label">
            {{
              'pw.focConfiguration.noOfDaysAfterOfferPeriodForAbLabel'
                | translate
            }}
          </div>
          <div class="row">
            <mat-form-field
              appearance="outline"
              class="col-auto pw-full-bordered-input-box"
            >
              <input formControlName="noOfDaysAfterOfferPeriodForAb" matInput />
              <mat-error
                *ngIf="
                  schemeConfigurationForm.get('noOfDaysAfterOfferPeriodForAb')
                    .touched &&
                  schemeConfigurationForm.get('noOfDaysAfterOfferPeriodForAb')
                    .errors &&
                  schemeConfigurationForm.get('noOfDaysAfterOfferPeriodForAb')
                    .errors.errorArray
                "
              >
                <poss-web-error-info-tooltip
                  [errorMessage]="
                    schemeConfigurationForm.get('noOfDaysAfterOfferPeriodForAb')
                      .errors.errorArray
                  "
                ></poss-web-error-info-tooltip>
              </mat-error>
            </mat-form-field>
          </div>

          <div class="pw-bordered-accordion__label">
            {{ 'pw.focConfiguration.abUtilizationPercentageLabel' | translate }}
          </div>
          <div class="row">
            <mat-form-field
              appearance="outline"
              class="col-auto pw-full-bordered-input-box"
            >
              <input formControlName="abUtilizationPercentage" matInput />
              <mat-error
                *ngIf="
                  schemeConfigurationForm.get('abUtilizationPercentage')
                    .touched &&
                  schemeConfigurationForm.get('abUtilizationPercentage')
                    .errors &&
                  schemeConfigurationForm.get('abUtilizationPercentage').errors
                    .errorArray
                "
              >
                <poss-web-error-info-tooltip
                  [errorMessage]="
                    schemeConfigurationForm.get('abUtilizationPercentage')
                      .errors.errorArray
                  "
                ></poss-web-error-info-tooltip>
              </mat-error>
            </mat-form-field>
          </div>

          <mat-checkbox formControlName="isGoldRateForzenForAb">
            {{
              'pw.focConfiguration.isGoldRateForzenForAb' | translate
            }}</mat-checkbox
          >
        </div>
      </div>
    </mat-expansion-panel>

    <mat-expansion-panel class="pw-expansion-panel">
      <mat-expansion-panel-header
        class="pw-expansion-panel__header"
        [collapsedHeight]="'40px'"
        [expandedHeight]="'40px'"
      >
        <mat-panel-title class="pw-expansion-panel__heading">
          {{ 'pw.focConfiguration.encircleRewardPointsConfiguration' | translate }}
        </mat-panel-title>
      </mat-expansion-panel-header>
      <div class="col-lg-5 col-auto">
        <div class="row">
          <mat-checkbox formControlName="isAccuralEncirclePoint">
            {{
              'pw.focConfiguration.accuralEncirclePoint' | translate
            }}</mat-checkbox
          >
        </div>
      </div>
    </mat-expansion-panel>
  </mat-accordion>

  <div class="row">
    <div class="col-auto ml-auto">
      <button
        (click)="onClick()"
        type="submit"
        class="col-auto ml-auto pw-btn pw-accent-btn"
      >
        {{ 'pw.focConfiguration.saveLabel' | translate }}
      </button>
    </div>
  </div>
</form>
