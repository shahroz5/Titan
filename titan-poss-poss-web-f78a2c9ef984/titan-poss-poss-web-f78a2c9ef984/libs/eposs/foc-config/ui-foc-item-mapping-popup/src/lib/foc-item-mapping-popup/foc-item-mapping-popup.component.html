<div *ngIf="!isViewMode" class="pw-confirmation-box">
  <div
    class="row pw-confirmation-box__header pw-cursor-grab"
    cdkDragBoundary=".cdk-overlay-container"
    cdkDragRootElement=".cdk-overlay-pane"
    cdkDrag
    cdkDragHandle
  >
    <div class="col-auto">
      {{ 'pw.focConfiguration.addFocCodeLabel' | translate }}
    </div>

    <div class="col pw-text-right">
      <button
        class="pw-confirmation-box__icon-button"
        mat-icon-button
        (click)="close()"
      >
        <mat-icon>
          <span class="pw-i-24 pw-close-no-border-icon-24"></span>
        </mat-icon>
      </button>
    </div>
  </div>
  <div>
    <mat-tab-group #tabGroup class="pw-tab">
      <mat-tab class="pw-tab__item">
        <ng-template mat-tab-label>
          <span [class.pw-tab__active]="tabGroup.selectedIndex == 0">
            {{ 'pw.focConfiguration.addNewFocItemCodeLabel' | translate }}
          </span>
          <span class="pw-fourth-color"> ({{ allFocItemCodes?.length }}) </span>
        </ng-template>

        <ng-container *ngIf="allFocItemCodes?.length === 0">
          <div class="pw-scrollable-item1">
            <h3 class="pw-fourth-color pw-text-center">
              {{ 'pw.focConfiguration.noItemCodeFoundLabel' | translate }}
            </h3>
          </div>
        </ng-container>
        <ng-container *ngIf="allFocItemCodes?.length !== 0">
          <div class="pw-scrollable-item">
            <div class="row pw-confirmation-box__list">
              <mat-form-field
                floatLabel="never"
                class="col-12 pw-confirmation-box__padding-0"
              >
                <input
                  #searchAddNewTabItemInput
                  matInput
                  placeholder="  {{
                    'pw.focConfiguration.searchItemCodeLabel' | translate
                  }}"
                  class="pw-input-box"
                />

                <mat-icon matSuffix>
                  <span
                    *ngIf="!searchAddNewTabItemInput.value"
                    class="pw-i-16 pw-search-icon-16"
                  ></span
                ></mat-icon>
                <mat-icon
                  matSuffix
                  (click)="searchAddNewTabItemInput.value = null"
                >
                  <span
                    *ngIf="searchAddNewTabItemInput.value"
                    class="pw-i-10 pw-close-icon-16"
                  ></span
                ></mat-icon>
              </mat-form-field>
            </div>

            <div
              *ngIf="
                (
                  allFocItemCodes
                  | itemCodeSearch: searchAddNewTabItemInput.value:'itemCode'
                ).length === 0
              "
            >
              <div class="pw-scrolled-item2">
                <h3 class="pw-fourth-color pw-text-center">
                  {{ 'pw.focConfiguration.noItemCodeFoundLabel' | translate }}
                </h3>
              </div>
            </div>

            <div
              *ngIf="
                (
                  allFocItemCodes
                  | itemCodeSearch: searchAddNewTabItemInput.value:'itemCode'
                ).length !== 0
              "
              class="pw-confirmation-box__list"
            >
              <div class="row pw-confirmation-box__list-header">
                <div class="col-auto">
                  <mat-checkbox
                    class="pw-mat-checkbox pw-font-weight-bold"
                    [(ngModel)]="selectAllOfAddNewTab"
                    (change)="selectAll('new', $event.checked)"
                  >
                  </mat-checkbox>
                </div>
                <div class="col-4 pw-confirmation-box__list-header-item">
                  <p>
                    {{ 'pw.focConfiguration.focItemCodeLabel' | translate }}
                  </p>
                </div>
                <div class="col pw-confirmation-box__list-header-item">
                  <p>
                    {{ 'pw.focConfiguration.standardWeightLabel' | translate }}
                  </p>
                </div>
                <div class="col pw-confirmation-box__list-header-item">
                  <p>
                    {{ 'pw.focConfiguration.karatageLabel' | translate }}
                  </p>
                </div>
              </div>
              <div class="pw-confirmation-box__list-fixed-height">
                <div
                  class="row pw-confirmation-box__list-body"
                  *ngFor="
                    let itemCodes of allFocItemCodes
                      | itemCodeSearch
                        : searchAddNewTabItemInput.value
                        : 'itemCode'
                  "
                >
                  <div class="col-auto">
                    <mat-checkbox
                      class="pw-mat-checkbox"
                      [(ngModel)]="itemCodes.isSelected"
                      (change)="
                        selectionChange(itemCodes, itemCodes.isSelected, 'new')
                      "
                      (click)="$event.stopPropagation()"
                    >
                    </mat-checkbox>
                  </div>
                  <div class="col-4">
                    {{ itemCodes.itemCode }}
                  </div>
                  <div class="col">
                    <p>
                      {{ itemCodes.stdWeight | weightFormatter }}
                    </p>
                  </div>
                  <div class="col">
                    <p>
                      {{ itemCodes.karat }}
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </ng-container>
      </mat-tab>
      <mat-tab class="pw-tab__item">
        <ng-template mat-tab-label>
          <span [class.pw-tab__active]="tabGroup.selectedIndex == 1">
            {{ 'pw.focConfiguration.mappedFocItemCodeLabel' | translate }}
            <span class="pw-fourth-color">
              ({{ selectedFocItemCodes?.length }})
            </span></span
          >
        </ng-template>
        <div class="pw-tab__content">
          <ng-container *ngIf="selectedFocItemCodes?.length === 0">
            <div class="pw-scrollable-item1">
              <h3 class="pw-fourth-color pw-text-center">
                {{ 'pw.focConfiguration.noItemCodeFoundLabel' | translate }}
              </h3>
            </div>
          </ng-container>

          <ng-container *ngIf="selectedFocItemCodes?.length">
            <div class="pw-scrollable-item">
              <div class="row pw-confirmation-box__list">
                <mat-form-field floatLabel="never" class="col-12">
                  <input
                    #searchSelectedItemInput
                    matInput
                    placeholder="{{
                      'pw.focConfiguration.searchItemCodeLabel' | translate
                    }}"
                  />
                  <mat-icon matSuffix>
                    <span
                      *ngIf="!searchSelectedItemInput.value"
                      class="pw-i-16 pw-search-icon-16 pw-search-input-icon"
                    ></span
                  ></mat-icon>
                  <mat-icon
                    matSuffix
                    (click)="searchSelectedItemInput.value = null"
                  >
                    <span
                      *ngIf="searchSelectedItemInput.value"
                      class="pw-i-10 pw-close-icon-16"
                    ></span
                  ></mat-icon>
                </mat-form-field>
              </div>

              <div
                *ngIf="
                  (
                    selectedFocItemCodes
                    | itemCodeSearch: searchSelectedItemInput.value:'itemCode'
                  ).length === 0
                "
              >
                <div class="pw-scrolled-item2">
                  <h3 class="pw-fourth-color pw-text-center">
                    {{ 'pw.focConfiguration.noItemCodeFoundLabel' | translate }}
                  </h3>
                </div>
              </div>

              <div
                *ngIf="
                  (
                    selectedFocItemCodes
                    | itemCodeSearch: searchSelectedItemInput.value:'itemCode'
                  ).length !== 0
                "
                class="pw-confirmation-box__list"
              >
                <div class="row pw-confirmation-box__list-header">
                  <div class="col-auto">
                    <mat-checkbox
                      class="pw-mat-checkbox pw-font-weight-bold"
                      [(ngModel)]="selectAllOfSelectedTab"
                      (change)="selectAll('selected', $event.checked)"
                    >
                    </mat-checkbox>
                  </div>
                  <div class="col-4 pw-confirmation-box__list-header-item">
                    <p>
                      {{ 'pw.focConfiguration.focItemCodeLabel' | translate }}
                    </p>
                  </div>
                  <div class="col pw-confirmation-box__list-header-item">
                    <p>
                      {{
                        'pw.focConfiguration.standardWeightLabel' | translate
                      }}
                    </p>
                  </div>
                  <div class="col pw-confirmation-box__list-header-item">
                    <p>
                      {{ 'pw.focConfiguration.karatageLabel' | translate }}
                    </p>
                  </div>
                </div>
                <div class="pw-confirmation-box__list-fixed-height">
                  <div
                    class="row pw-confirmation-box__list-body"
                    *ngFor="
                      let itemCode of selectedFocItemCodes
                        | itemCodeSearch
                          : searchSelectedItemInput.value
                          : 'itemCode'
                    "
                  >
                    <div class="col-auto">
                      <mat-checkbox
                        class="pw-mat-checkbox"
                        [(ngModel)]="itemCode.isSelected"
                        (change)="
                          selectionChange(
                            itemCode,
                            itemCode?.isSelected,
                            'selected'
                          )
                        "
                        (click)="$event.stopPropagation()"
                      ></mat-checkbox>
                    </div>
                    <div class="col-4">
                      {{ itemCode.itemCode }}
                    </div>
                    <div class="col">
                      <p>
                        {{ itemCode.stdWeight | weightFormatter }}
                      </p>
                    </div>

                    <div class="col">
                      <p>
                        {{ itemCode.karat }}
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </ng-container>
        </div>
      </mat-tab>
    </mat-tab-group>
  </div>

  <div class="pw-confirmation-box__footer">
    <div class="row justify-content-end">
      <ng-container>
        <div class="col-auto">
          <button
            mat-flat-button
            class="pw-btn pw-primary-btn pw-width-100"
            (click)="
              updateFocItemCodes(
                tabGroup.selectedIndex === 0 ? 'new' : 'selected'
              )
            "
            [disabled]="
              tabGroup.selectedIndex === 1 ? disableRemoveButton : !isChecked
            "
          >
            {{
              (tabGroup.selectedIndex == 0
                ? 'pw.focConfiguration.addButtonLabel'
                : 'pw.focConfiguration.removeButtonLabel'
              ) | translate
            }}
          </button>
        </div>
        <div class="col-auto" [hidden]="tabGroup.selectedIndex == 0">
          <button
            mat-flat-button
            class="pw-btn pw-accent-btn pw-width-100"
            (click)="applyProductGroups()"
            [disabled]="!hasChange"
          >
            {{ 'pw.focConfiguration.applyButtonLabel' | translate }}
          </button>
        </div>
      </ng-container>
    </div>
  </div>
</div>
<div *ngIf="isViewMode" class="pw-confirmation-box">
  <div
    class="row pw-confirmation-box__header pw-cursor-grab"
    cdkDragBoundary=".cdk-overlay-container"
    cdkDragRootElement=".cdk-overlay-pane"
    cdkDrag
    cdkDragHandle
  >
    <div class="col-auto">
      {{ viewModeLabel }}
    </div>

    <div class="col pw-text-right">
      <button
        class="pw-confirmation-box__icon-button"
        mat-icon-button
        (click)="close()"
      >
        <mat-icon>
          <span class="pw-i-24 pw-close-no-border-icon-24"></span>
        </mat-icon>
      </button>
    </div>
  </div>

  <ng-container *ngIf="selectedMappedProuctGroup.length === 0">
    <div class="pw-scrollable-item1">
      <h3 class="pw-fourth-color pw-text-center">
        {{ 'pw.focConfiguration.noItemCodeFoundLabel' | translate }}
      </h3>
    </div>
  </ng-container>

  <ng-container *ngIf="selectedMappedProuctGroup.length">
    <div class="pw-scrollable-item">
      <div class="row pw-confirmation-box__list">
        <mat-form-field floatLabel="never" class="col-12">
          <input
            #searchSelectedItemInput
            matInput
            placeholder="  {{
              'pw.focConfiguration.searchItemCodeLabel' | translate
            }}"
          />
          <mat-icon matSuffix>
            <span
              *ngIf="!searchSelectedItemInput.value"
              class="pw-i-16 pw-search-icon-16 pw-search-input-icon"
            ></span
          ></mat-icon>
          <mat-icon matSuffix (click)="searchSelectedItemInput.value = null">
            <span
              *ngIf="searchSelectedItemInput.value"
              class="pw-i-10 pw-close-icon-16"
            ></span
          ></mat-icon>
        </mat-form-field>
      </div>

      <div
        *ngIf="
          (
            selectedFocItemCodes
            | itemCodeSearch: searchSelectedItemInput.value:'itemCode'
          ).length === 0
        "
      >
        <div class="pw-scrolled-item2">
          <h3 class="pw-fourth-color pw-text-center">
            {{ 'pw.focConfiguration.noItemCodeFoundLabel' | translate }}
          </h3>
        </div>
      </div>

      <div
        *ngIf="
          (
            selectedFocItemCodes
            | itemCodeSearch: searchSelectedItemInput.value:'itemCode'
          ).length !== 0
        "
        class="pw-confirmation-box__list"
      >
        <div class="row pw-confirmation-box__list-header">
          <div class="col-4 pw-confirmation-box__list-header-item">
            <p>{{ 'pw.focConfiguration.focItemCodeLabel' | translate }}</p>
          </div>
          <div class="col pw-confirmation-box__list-header-item">
            <p>{{ 'pw.focConfiguration.standardWeightLabel' | translate }}</p>
          </div>
          <div class="col pw-confirmation-box__list-header-item">
            <p>{{ 'pw.focConfiguration.karatageLabel' | translate }}</p>
          </div>
        </div>
        <div class="pw-confirmation-box pw-list-fixed-height">
          <div
            class="row pw-confirmation-box__list-body"
            *ngFor="
              let focItemCode of selectedFocItemCodes
                | itemCodeSearch: searchSelectedItemInput.value:'itemCode'
            "
          >
            <div class="col-4">
              {{ focItemCode.itemCode }}
            </div>
            <div class="col">
              <p>
                {{ focItemCode.stdWeight | weightFormatter }}
              </p>
            </div>

            <div class="col">
              <p>
                {{ focItemCode.karat }}
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </ng-container>

  <div class="pw-confirmation-box__footer">
    <div class="row justify-content-end">
      <ng-container *ngIf="selectedMappedProuctGroup.length !== 0">
        <div class="col-auto">
          <button
            mat-flat-button
            class="pw-btn pw-primary-btn pw-width-100"
            (click)="close()"
          >
            {{ 'pw.focConfiguration.okButtonLabel' | translate }}
          </button>
        </div>
      </ng-container>
    </div>
  </div>
</div>
