<poss-web-top-info-panel
  *ngIf="isFocusing && focusedHeaderName"
  [isFocusing]="isFocusing"
  [focusedHeaderName]="focusedHeaderName"
  [currentRowData]="currentRowInfo"
>
</poss-web-top-info-panel>
<ag-grid-angular
  class="pw-titan-poss-theme pw-ag-grid-table"
  [rowData]="rowData"
  [columnDefs]="columnDefs"
  [rowHeight]="rowHeight"
  [animateRows]="animateRows"
  [context]="context"
  [domLayout]="domLayout"
  [rowSelection]="rowSelection"
  (gridReady)="gridReady($event)"
  [defaultColDef]="defaultColDef"
  (sortChanged)="printSortStateToConsole($event)"
  (selectionChanged)="onSelectionChanged($event)"
  (cellClicked)="onCellClicked($event)"
  (gridSizeChanged)="onGridSizeChanged()"
  (cellFocused)="onCellFocused($event)"
  (focusout)="focusOut($event)"
></ag-grid-angular>

<div class="row">
  <mat-form-field *ngIf="extendValidityEnabled" class="col-5">
    <input
      matInput
      class="pw-single-bordered-input col-auto"
      placeholder="Remarks"
      [formControl]="remarks"
      name="remarkField"
      possWebMaxLengthValidator
      required
      [disabled]="true"
    />
    <mat-error *ngIf="remarks.errors && remarks.errors.errorArray">
      <poss-web-error-info-tooltip
        [errorMessage]="remarks.errors.errorArray"
      ></poss-web-error-info-tooltip>
    </mat-error>
  </mat-form-field>

  <div *ngIf="!extendValidityEnabled" class="col-6">
    <div class="row my-3">
      <div class="col-auto">
        <span *ngIf="this.api" class="pw-confirmation-box__label">
          {{ 'pw.gvStatusUpdate.totalNumberofGV' | translate }} :
        </span>
        {{ totalGVSelected }}
      </div>
      <div class="col-auto">|</div>
      <div class="col-auto">
        <span class="pw-confirmation-box__label">
          {{ 'pw.gvStatusUpdate.totalValue' | translate }}:
        </span>
        {{ totalGVSelectedPrice }}
      </div>
    </div>
  </div>
  <div class="col-auto ml-auto">
    <mat-paginator
      class="pw-paginator"
      *ngIf="count > minPageSize && gvStatusList.length > 0"
      [length]="count"
      [pageSize]="pageEvent.pageSize"
      [pageIndex]="pageEvent.pageIndex"
      showFirstLastButtons
      [pageSizeOptions]="pageSizeOptions"
      (page)="paginator.emit($event)"
    >
    </mat-paginator>
  </div>
</div>

<div *ngIf="!extendValidityEnabled" class="row" [formGroup]="statusUpdateForm">
  <div class="col-2">
    <poss-web-select-dropdown
      placeholder=" {{ 'pw.gvStatusUpdate.changeStatus' | translate }}"
      [control]="statusUpdateForm.get('status')"
      [options]="statusChangeDropDownValues"
      [required]="true"
      (selectionChange)="statusChange($event)"
    >
    </poss-web-select-dropdown>
  </div>
  <mat-form-field class="col">
    <mat-label> {{ 'pw.gvStatusUpdate.remarks' | translate }}</mat-label>
    <input
      matInput
      class="pw-single-bordered-input col-auto"
      name="remarkField"
      formControlName="remarks"
      possWebMaxLengthValidator
      required
    />
    <mat-error
      *ngIf="
        statusUpdateForm.get('remarks').errors &&
        statusUpdateForm.get('remarks').errors.errorArray
      "
    >
      <poss-web-error-info-tooltip
        [errorMessage]="statusUpdateForm.get('remarks').errors.errorArray"
      ></poss-web-error-info-tooltip>
    </mat-error>
  </mat-form-field>
</div>

<div class="row mb-3">
  <div class="col-auto ml-auto">
    <button
      (click)="cancel()"
      [disabled]="checkCancelButton()"
      class="pw-btn pw-primary-btn"
    >
      {{ 'pw.gvStatusUpdate.cancel' | translate }}
    </button>
  </div>
  <div *ngIf="extendValidityEnabled" class="col-auto">
    <button
      (click)="updateValidity()"
      [disabled]="checkValidityUpdate()"
      class="pw-btn pw-accent-btn"
    >
      {{ 'pw.gvStatusUpdate.update' | translate }}
    </button>
  </div>

  <div *ngIf="!extendValidityEnabled" class="col-auto">
    <button
      (click)="updateStatus()"
      [disabled]="checkStatusUpdate()"
      class="pw-btn pw-accent-btn"
    >
      {{ 'pw.gvStatusUpdate.update' | translate }}
    </button>
  </div>
</div>
