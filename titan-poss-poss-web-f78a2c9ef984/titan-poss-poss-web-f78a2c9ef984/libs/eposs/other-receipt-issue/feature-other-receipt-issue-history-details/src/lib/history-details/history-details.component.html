<poss-web-expansion-panel>
  <poss-web-expansion-panel-summary>
    <div class="container-fluid">
      <div class="row">
        <div class="col-12 col-lg-10 m-auto">
          <div class="row align-items-end">
            <div class="col-aut">
              <div class="pw-top-heading-container__main-head">
                <a (click)="back($event)">
                  <span class="pw-i-24 pw-back-arrow-icon-24"></span>
                </a>
                <span class="pw-i-36 pw-issue-stock-icon-36"></span>
                <div>
                  <h2>{{ 'pw.otherReceiptsIssues.title' | translate }}</h2>
                  <div>
                    <h5
                      class="pw-top-heading-container__sub-heading pw-fith-heading"
                      *ngIf="tabType == enumRef.OTHER_ISSUES"
                    >
                      {{ 'pw.otherReceiptsIssues.issueLableText' | translate }}
                      History
                    </h5>
                    <h5
                      class="pw-top-heading-container__sub-heading pw-fith-heading"
                      *ngIf="tabType == enumRef.OTHER_RECEIPTS"
                    >
                      Receipts History
                    </h5>
                    <h5
                      class="pw-top-heading-container__sub-heading pw-fith-heading"
                      *ngIf="tabType == enumRef.OTHER_ISSUES_REQUESTS"
                    >
                      Issue-Requests History
                    </h5>
                  </div>
                </div>
              </div>
            </div>

            <div class="col-auto">
              <h4 *ngIf="tabType == enumRef.OTHER_ISSUES">
                {{ selected?.srcDocNo }}
              </h4>
              <h4 *ngIf="tabType == enumRef.OTHER_RECEIPTS">
                {{ selected?.destDocNo }}
              </h4>
              <h4 *ngIf="tabType == enumRef.OTHER_ISSUES_REQUESTS">
                {{ selected?.reqDocNo }}
              </h4>
              <div>{{ type }}</div>
            </div>

            <div class="col-lg-5 col-md-6 col-6 no-gutters">
              <div class="row no-gutters align-items-end">
                <div class="col-sm-4 col-xs-auto">
                  <p>
                    {{
                      'pw.otherReceiptsIssues.totalValueLabelText' | translate
                    }}
                  </p>
                </div>
                <div class="col-auto">
                  <p>
                    :
                    {{
                      selected?.totalMeasuredValue
                        | currencyFormatter: selected?.currencyCode
                    }}
                  </p>
                </div>
              </div>
              <div class="row no-gutters mt-1">
                <div class="col-sm-4 col-xs-auto">
                  <p>
                    {{
                      'pw.otherReceiptsIssues.totalWeightLabelText' | translate
                    }}
                  </p>
                </div>
                <div class="col-auto">
                  <p>
                    :
                    {{ selected?.totalMeasuredWeight | weightFormatter }}
                    {{ selected?.weightUnit }}
                  </p>
                </div>
              </div>
            </div>
            <div class="col-lg-7 align-self-end"></div>
          </div>
        </div>
      </div>
    </div>
  </poss-web-expansion-panel-summary>

  <poss-web-expansion-panel-content>
    <div class="container-fluid">
      <div class="row">
        <div class="col-12 col-lg-10 m-auto">
          <div class="pw-top-heading-container">
            <div class="row pw-top-heading-container__item">
              <div class="col-auto">
                <div class="pw-top-heading-container__main-head">
                  <a (click)="back($event)">
                    <span class="pw-i-24 pw-back-arrow-icon-24"></span>
                  </a>
                  <span class="pw-i-36 pw-issue-stock-icon-36"></span>
                  <div>
                    <h2>{{ 'pw.otherReceiptsIssues.title' | translate }}</h2>
                    <div>
                      <h5
                        class="pw-top-heading-container__sub-heading pw-fith-heading"
                        *ngIf="tabType == enumRef.OTHER_ISSUES"
                      >
                        {{
                          'pw.otherReceiptsIssues.issueLableText' | translate
                        }}
                        History
                        <span class="pw-seventh-color"></span>
                      </h5>
                      <h5
                        class="pw-top-heading-container__sub-heading pw-fith-heading"
                        *ngIf="tabType == enumRef.OTHER_RECEIPTS"
                      >
                        Receipts History
                        <span class="pw-seventh-color"></span>
                      </h5>
                      <h5
                        class="pw-top-heading-container__sub-heading pw-fith-heading"
                        *ngIf="tabType == enumRef.OTHER_ISSUES_REQUESTS"
                      >
                        Issue-Requests History
                        <span class="pw-seventh-color"></span>
                      </h5>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="pw-grid-card">
            <div class="row">
              <div class="col-lg-3 col-md-4 col-6">
                <div class="pw-grid-card__item pw-is-active-bar">
                  <div *ngIf="tabType == enumRef.OTHER_RECEIPTS">
                    <h4>Doc No:{{ selected?.destDocNo }}</h4>
                    <div>{{ type }}</div>
                    <div class="mt-1">
                      <p>
                        {{ selected?.totalMeasuredQuantity }} Qty |
                        {{
                          selected?.totalMeasuredValue
                            | currencyFormatter: selected?.currencyCode
                        }}
                      </p>
                      <p>
                        Total Weight:
                        {{ selected?.totalMeasuredWeight | weightFormatter }}
                        {{ selected?.weightUnit }}
                      </p>
                      <p>
                        Doc Date:{{ selected?.destDocDate | dateFormatter }}
                      </p>

                      <p [ngClass]="getStatus(selected?.status)">
                        {{ 'pw.otherReceiptsIssues.status' | translate }}:
                        {{ status }}
                      </p>
                    </div>
                  </div>
                  <div *ngIf="tabType == enumRef.OTHER_ISSUES">
                    <h4>Doc No:{{ selected?.srcDocNo }}</h4>
                    <div>Req No: {{ selected?.reqDocNo }} | {{ type }}</div>
                    <div class="mt-1">
                      <p>
                        {{ selected?.totalMeasuredQuantity }} Qty
                        <span *ngIf="type !== enumRef.FOC">
                          |
                          {{
                            selected?.totalMeasuredValue
                              | currencyFormatter: selected?.currencyCode
                          }}
                        </span>
                      </p>
                      <p>
                        Total Weight:
                        {{ selected?.totalMeasuredWeight | weightFormatter }}
                        {{ selected?.weightUnit }}
                      </p>
                      <p>Doc Date:{{ selected?.srcDocDate | dateFormatter }}</p>
                      <p>
                        Req Date:
                        {{ selected?.reqDocDate | dateFormatter }}
                      </p>
                      <p [ngClass]="getStatus(selected?.status)">
                        {{ 'pw.otherReceiptsIssues.status' | translate }}:
                        {{ status }}
                      </p>
                    </div>
                  </div>
                  <div *ngIf="tabType == enumRef.OTHER_ISSUES_REQUESTS">
                    <h4>Req No:{{ selected?.reqDocNo }}</h4>
                    <div>{{ type }}</div>
                    <div class="mt-1">
                      <p>
                        {{ selected?.totalMeasuredQuantity }} Qty |
                        {{
                          selected?.totalMeasuredValue
                            | currencyFormatter: selected?.currencyCode
                        }}
                      </p>
                      <p>
                        Total Weight:
                        {{ selected?.totalMeasuredWeight | weightFormatter }}
                        {{ selected?.weightUnit }}
                      </p>
                      <p>Req Date:{{ selected?.reqDocDate | dateFormatter }}</p>

                      <p [ngClass]="getStatus(selected?.status)">
                        {{ 'pw.otherReceiptsIssues.status' | translate }}:
                        {{ status }}
                      </p>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-lg-9 col-md-8 col-6">
                <div class="pw-remarks">
                  <h5>
                    Remarks
                  </h5>
                  <div>
                    <p class="pw-remarks__content">
                      {{ selected?.remarks }}
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </poss-web-expansion-panel-content>
</poss-web-expansion-panel>
<div
  class="container-fluid "
  [class.pw-overlay-notification-gutter]="hasNotification"
>
  <div class="row mt-2 mb-5">
    <div class="col-lg-10 col-12 m-auto">
      <ng-container
        *ngIf="
          tabType === enumRef.OTHER_ISSUES ||
          tabType === enumRef.OTHER_ISSUES_REQUESTS
        "
      >
        <mat-accordion *ngIf="this.type === enumRef.EXHIBITION">
          <mat-expansion-panel
            class="pw-expansion-panel-other-issues"
            [expanded]="true"
          >
            <mat-expansion-panel-header>
              <mat-panel-title>
                <div class="row pw-accordion">
                  <div class="col-auto">
                    <p>
                      {{
                        'pw.otherReceiptsIssues.AddressDetailsLabelText'
                          | translate
                      }}
                    </p>
                  </div>
                </div>
              </mat-panel-title>
            </mat-expansion-panel-header>
            <div class="row wrap">
              <div class="col-lg-9 pw-card__border">
                <div class="row">
                  <mat-form-field class="col-6">
                    <input
                      class="pw-input-box"
                      matInput
                      placeholder="Address 1"
                      value="{{ selected?.carrierDetails.data.address1 }}"
                      readonly
                    />
                  </mat-form-field>
                  <mat-form-field class="col-6">
                    <input
                      class="pw-input-box"
                      matInput
                      placeholder="Address 2"
                      value="{{ selected?.carrierDetails.data.address2 }}"
                      readonly
                    />
                  </mat-form-field>
                  <mat-form-field class="col-4">
                    <input
                      class="pw-input-box"
                      matInput
                      placeholder="State"
                      value="{{ selected?.carrierDetails.data.town }}"
                      readonly
                    />
                  </mat-form-field>
                  <mat-form-field class="col-4">
                    <input
                      class="pw-input-box"
                      matInput
                      placeholder="City"
                      value="{{ selected?.carrierDetails.data.city }}"
                      readonly
                    />
                  </mat-form-field>
                  <mat-form-field class="col-4">
                    <input
                      class="pw-input-box"
                      matInput
                      placeholder="Pin Code"
                      value="{{ selected?.carrierDetails.data.pincode }}"
                      readonly
                    />
                  </mat-form-field>
                </div>
              </div>
              <div class="col-lg-3">
                <div class="row">
                  <mat-form-field class="col-12">
                    <input
                      class="pw-input-box"
                      matInput
                      placeholder="Approval Code"
                      value="{{ selected?.otherDetails.data.approvalCode }}"
                      readonly
                    />
                  </mat-form-field>
                  <mat-form-field class="col-12">
                    <input
                      class="pw-input-box"
                      matInput
                      placeholder="Approved By"
                      value="{{ selected?.otherDetails.data.approvedBy }}"
                      readonly
                    />
                  </mat-form-field>
                </div>
              </div>
            </div>
          </mat-expansion-panel>
        </mat-accordion>
        <mat-accordion *ngIf="type === enumRef.LOAN_TYPE">
          <mat-expansion-panel
            class="pw-expansion-panel-other-issues"
            [expanded]="true"
          >
            <mat-expansion-panel-header>
              <mat-panel-title>
                <div class="row pw-accordion">
                  <div class="col-auto">
                    <p>
                      {{
                        'pw.otherReceiptsIssues.EmployeeDetailsLabelText'
                          | translate
                      }}
                    </p>
                  </div>
                </div>
              </mat-panel-title>
            </mat-expansion-panel-header>
            <div class="row wrap">
              <div class="col-lg-6 pw-card__border">
                <div class="row">
                  <mat-form-field class="col-12">
                    <input
                      class="pw-input-box"
                      matInput
                      placeholder="Employee Id"
                      value="{{ selected?.carrierDetails.data.employeeId }}"
                      readonly
                    />
                  </mat-form-field>
                  <mat-form-field class="col-12">
                    <input
                      class="pw-input-box"
                      matInput
                      placeholder="Employee Name"
                      value="{{ selected?.carrierDetails.data.employeeName }}"
                      readonly
                    />
                  </mat-form-field>
                </div>
              </div>
              <div class="col-lg-6">
                <div class="row">
                  <mat-form-field class="col-12">
                    <input
                      class="pw-input-box"
                      matInput
                      placeholder="Approval Code"
                      value="{{ selected?.otherDetails.data.approvalCode }}"
                      readonly
                    />
                  </mat-form-field>
                  <mat-form-field class="col-12">
                    <input
                      class="pw-input-box"
                      matInput
                      placeholder="Approved By"
                      value="{{ selected?.otherDetails.data.approvedBy }}"
                      readonly
                    />
                  </mat-form-field>
                </div>
              </div>
            </div>
          </mat-expansion-panel>
        </mat-accordion>
        <mat-accordion
          *ngIf="
            type === enumRef.LOSS ||
            type === enumRef.PSV ||
            type === enumRef.ADJUSTMENT ||
            type === enumRef.FOC
          "
        >
          <mat-expansion-panel
            class="pw-expansion-panel-other-issues"
            [expanded]="true"
          >
            <mat-expansion-panel-header>
              <mat-panel-title>
                <div class="row pw-accordion">
                  <div class="col-auto">
                    <p>
                      {{
                        'pw.otherReceiptsIssues.ApprovalDetailsLabelText'
                          | translate
                      }}
                    </p>
                  </div>
                </div>
              </mat-panel-title>
            </mat-expansion-panel-header>
            <div class="row">
              <mat-form-field class="col-lg-3 col-5">
                <input
                  class="pw-input-box"
                  matInput
                  placeholder="Approval Code"
                  value="{{ selected?.otherDetails.data.approvalCode }}"
                  readonly
                />
              </mat-form-field>
              <mat-form-field class="col-lg-3 col-5">
                <input
                  class="pw-input-box"
                  matInput
                  placeholder="Approved By"
                  value="{{ selected?.otherDetails.data.approvedBy }}"
                  readonly
                />
              </mat-form-field>
            </div>
          </mat-expansion-panel>
        </mat-accordion>
      </ng-container>
      <div class="pw-filter-box">
        <div class="row">
          <div class="col-12">
            <ul class="pw-filter-box__sub-head-lists">
              <li class="pw-filter-box__list">
                <a
                  [class.is-active]="true"
                  class="pw-filter-box__heading is-active"
                >
                  {{ 'pw.stockIssue.listOfProductstabText' | translate }}
                  <span class="pw-fourth-color"
                    >({{ itemsTotalCount$ | async }})</span
                  >
                </a>
              </li>
            </ul>
          </div>
        </div>
        <div class="row pw-filter-box__right-content">
          <div class="col-auto">
            <a (click)="openFilter()">
              <p>
                <span
                  *ngIf="filter.length === 0"
                  class="pw-i-16 pw-filter-icon-16 pw-filter-box__icon"
                ></span>
                <span
                  *ngIf="filter.length !== 0"
                  class="pw-i-24 pw-filter-icon-color-24 pw-filter-box__icon"
                ></span>
                {{ 'pw.otherReceiptsIssues.FilterLabelText' | translate }}
              </p>
            </a>
          </div>
          <div class="col-auto">
            <a (click)="openSort()">
              <p>
                <span
                  class="pw-i-16 pw-sort-icon-16 pw-filter-box__icon"
                ></span>
                {{ 'pw.otherReceiptsIssues.SortLableText' | translate }}
              </p>
            </a>
          </div>
          <poss-web-item-search
            class="col-lg-3 col-4 ml-auto ml-lg-0"
            placeholder="{{
              'pw.otherReceiptsIssues.searchByVariantCodePlaceholderText'
                | translate
            }}"
            (search)="searchItems($event)"
            (clear)="clearSearchItems()"
          >
          </poss-web-item-search>
        </div>
      </div>
      <poss-web-item-list
        [tabType]="tabType"
        [count]="itemsCount$ | async"
        [itemList]="items$ | async"
        [pageEvent]="itemsPageEvent"
        [pageSizeOptions]="pageSizeOptions"
        (paginator)="paginate($event)"
        [type]="type"
        (loadImageEvent)="loadImageUrl($event)"
      >
      </poss-web-item-list>
      <poss-web-loader
        *ngIf="
          (isLoadingSelectedStock$ | async) ||
          (isItemsLoading$ | async) ||
          (isLoadingItemsTotalCount$ | async) ||
          (isLoading$ | async) ||
          (isLoadingImage$ | async) || (printingService.getPrinterIsLoading() | async)"
      >
      </poss-web-loader>
      <div
        *ngIf="
          (isItemsLoaded$ | async) &&
          (itemsTotalCount$ | async) === 0 &&
          (isLoadingItemsTotalCount$ | async) === false &&
          !(
            (isItemsLoading$ | async) &&
            (isLoadingSelectedStock$ | async) &&
            (isLoadingItemsTotalCount$ | async) &&
            (isLoading$ | async)
          )
        "
        class="pw-success-color pw-message pw-text-center mg-t-100"
      >
        <span class="pw-i-16 pw-success-icon-16"></span>
        No items found
      </div>
      <div
        *ngIf="
          (isItemsLoaded$ | async) &&
          (filter.length > 0 || itemCode !== null) &&
          (items$ | async)?.length == 0 &&
          !(
            (isItemsLoading$ | async) &&
            (isLoadingSelectedStock$ | async) &&
            (isLoadingItemsTotalCount$ | async) &&
            (isLoading$ | async)
          ) &&
          (itemsTotalCount$ | async) > 0
        "
        class="pw-success-color pw-message pw-text-center mg-t-100"
      >
        <span class="pw-i-16 pw-success-icon-16"></span>
        No Items found with selected filter combination
      </div>
    </div>
  </div>
</div>
