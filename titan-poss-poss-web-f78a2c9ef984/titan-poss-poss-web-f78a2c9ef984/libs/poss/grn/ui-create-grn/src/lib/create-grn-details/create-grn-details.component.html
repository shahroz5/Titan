
<div
  class="pw-card pw-panel"
  *ngIf="productDetails?.length !== 0; else noDataTemplate"
>
  <div [formGroup]="productDetailsForm" class="align-items-center">
    <table
      formArrayName="itemsrow"
      *ngIf="itemsArray.controls.length !== 0"
      class="pw-mat-table"
      aria-describedby="table"
    >
      <thead>
        <tr class="pw-mat-table__header pw-mat-table__primary-bg">
          <th class="pw-mat-table__item" scope="col">
            <mat-checkbox
              [formControl]="selectedAll"
              (change)="selectAll($event.checked);"
            >
            </mat-checkbox>
          </th>
          <th class="pw-mat-table__item" scope="col">
            {{ 'pw.cmRequestApproval.variantCodeHeaderText' | translate }}
          </th>
          <th class="pw-mat-table__item" scope="col">
            {{ 'pw.cmRequestApproval.lotNumberHeaderText' | translate }}
          </th>
          <th class="pw-mat-table__item" scope="col">
            {{ 'pw.cmRequestApproval.unitWeightHeaderText' | translate }}
            ({{ weightCode }})
          </th>
          <th class="pw-mat-table__item" scope="col">
            {{ 'pw.cmRequestApproval.actualWeightHeaderText' | translate }}
            ({{ weightCode }})
          </th>
          <th class="pw-mat-table__item" scope="col">
            {{ 'pw.cmRequestApproval.RSONameHeaderText' | translate }}
          </th>
          <th class="pw-mat-table__item" scope="col">
            {{ 'pw.cmRequestApproval.pricePerUnitHeaderText' | translate }}
            ({{ defaultCurrencyCode | currencySymbol }})
          </th>
          <th class="pw-mat-table__item" scope="col">
            {{ 'pw.cmRequestApproval.discountHeaderText' | translate }} ({{
              defaultCurrencyCode | currencySymbol
            }})
          </th>
          <th class="pw-mat-table__item" scope="col">
            {{ 'pw.cmRequestApproval.finalPriceHeaderText' | translate }} ({{
              defaultCurrencyCode | currencySymbol
            }})
          </th>
          <th class="pw-mat-table__item" scope="col">
            {{ 'pw.cmRequestApproval.isHallmarkingHeaderText' | translate }}
          </th>
          <th class="pw-mat-table__item" scope="col">
            {{ 'pw.cmRequestApproval.isHMQuantityHeaderText' | translate }}
          </th>
          <th class="pw-mat-table__item" scope="col">
            {{
              'pw.cmRequestApproval.isFOCforHallmarkingHeaderText' | translate
            }}
          </th>
        </tr>
      </thead>
      <tbody>
        <tr
          class="pw-mat-table__body-row"
          *ngFor="let item of itemsArray.controls; let i = index"
          [formGroupName]="i"
        >
          <td class="pw-mat-table__item">
            <mat-checkbox
              formControlName="selected"
              (change)="
                selectionChange(
                  itemsArray.controls[i].get('id').value,
                  $event.checked)"
              >
            </mat-checkbox>
          </td>
          <td class="pw-mat-table__item">
            <div>
              <a (click)="showPopup(i)" class="pw-anchor-underline">
                {{ itemsArray.controls[i].get('itemCode').value }}
              </a>
              <!-- <span
                *ngIf="item?.priceDetails?.itemHallmarkDetails?.isHallmarked !== null
                      ? item?.priceDetails?.itemHallmarkDetails?.isHallmarked
                      : false"
                matTooltip="Hallmarked"
                matTooltipPosition="above"
                class="pw-hallmark-icon-16"
              ></span> -->
            </div>
            <div class="pw-mat-table__item-content">
              {{ getProductGroupDesc(itemsArray.controls[i].get('productGroupCode').value) }}
            </div>
            <!-- <div
              *ngIf="item.binCode !== 'RESERVEBIN'"
              class="pw-mat-table__item-content"
            >
              {{ item.binCode }}
            </div> -->
            <!-- <div
              *ngIf="item?.priceDetails?.itemHallmarkDetails?.isHallmarked !== null
                    ? !item?.priceDetails?.itemHallmarkDetails?.isHallmarked
                    : false"
              class="pw-error-color pw-mat-table__item-content"
            >
              {{ 'pw.grn.notHallmarkMsg' | translate }}
            </div> -->
          </td>
          <td class="pw-mat-table__item">
            <div
              *ngIf = "itemsArray.controls[i].get('productGroupCode').value !== '73' ||
              itemsArray.controls[i].get('productGroupCode').value !== '82'"
            >
              {{ itemsArray.controls[i].get('lotNumber').value }}
            </div>
            {{ coinCode }}
            <div
              *ngIf = "itemsArray.controls[i].get('productGroupCode').value !== '73' ||
              itemsArray.controls[i].get('productGroupCode').value !== '82'"
              class="pw-fourth-color"
            >
              <input
                matInput
                type="number"
                formControlName="totalQuantity"
                [autocomplete]="autocomplete"
                (blur)="quantityChange(i)"
                (keypress)="numberOnly($event)"
                required
              />
              <mat-error
                class="pw-error-color"
                *ngIf="
                  itemsArray.controls[i].get('totalQuantity').errors &&
                  itemsArray.controls[i].get('totalQuantity').errors.errorArray
                "
              >
                <poss-web-error-info-tooltip
                  [errorMessage]="
                    itemsArray.controls[i].get('totalQuantity').errors.errorArray
                  "
                ></poss-web-error-info-tooltip>
              </mat-error>
            </div>
          </td>
          <td class="pw-mat-table__item">
            {{
              itemsArray.controls[i].get('unitWeight').value
                | weightFormatter
            }}
          </td>
          <td class="pw-mat-table__item">
            {{
              itemsArray.controls[i].get('totalWeight').value
                | weightFormatter
            }}
          </td>
          <td class="pw-mat-table__item">
            <span
            matTooltip="{{ itemsArray.controls[i].get('employeeCode').value }}"
            matTooltipPosition="right"
            >{{ getRsoNameFromCode(itemsArray.controls[i].get('employeeCode').value) }}</span
          >
            <!-- {{
              itemsArray.controls[i].get('employeeCode').value
            }} -->
          </td>
          <td class="pw-mat-table__item">
            {{
              itemsArray.controls[i].get('unitValue').value
              | currencyFormatter: defaultCurrencyCode
            }}
          </td>
          <td class="pw-mat-table__item">
            {{
              itemsArray.controls[i].get('totalDiscount').value
            }}
          </td>
          <td class="pw-mat-table__item">
            <div *ngIf="isLegacy; else other_content">
              {{
                itemsArray.controls[i].get('finalValue').value
                  | currencyFormatter: defaultCurrencyCode
              }}
            </div>
            <ng-template #other_content>
              <a (click)="openItemDetails(i)" class="pw-anchor-underline">
                {{
                  itemsArray.controls[i].get('finalValue').value
                    | currencyFormatter: defaultCurrencyCode
                }}
              </a>
            </ng-template>
          </td>
          <td class="pw-mat-table__item pw-text-center">
            <mat-checkbox
              [checked]="itemsArray.controls[i].get('isHallmarked').value "
              [disabled]="true"
            >
            </mat-checkbox>
          </td>
          <td class="pw-mat-table__item pw-text-center">
            {{
              itemsArray.controls[i].get('hmQuantity').value
            }}
          </td>
          <td class="pw-mat-table__item pw-text-center">
            <mat-checkbox
              [checked]="
                itemsArray.controls[i].get('isFOCForHallmarkingCharges').value
              "
              [disabled]="true"
            >
            </mat-checkbox>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
<ng-template #noDataTemplate>
  <p class="pw-text-center">
    {{ 'pw.cmRequestApproval.noRowsToShowMessage' | translate }}
  </p>
</ng-template>
<!-- </div> -->
<!-- </div> -->
<!-- </mat-expansion-panel> -->
