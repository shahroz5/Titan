<poss-web-remove-gold-rate-edit
  *ngIf="
    creditNoteDetails &&
    tabType === CNSearchEnumRef.CN_ACTIVITY &&
    requestType === CNSearchEnumRef.REMOVE_GOLD_RATE
  "
  [creditNoteDetails]="creditNoteDetails"
></poss-web-remove-gold-rate-edit>
<poss-web-remove-gold-rate-view
  *ngIf="
    requestDetails &&
    tabType === CNSearchEnumRef.SENT_REQUESTS &&
    requestType === CNSearchEnumRef.REMOVE_GOLD_RATE
  "
  [requestDetails]="requestDetails"
></poss-web-remove-gold-rate-view>

<poss-web-activate-cn-view
  *ngIf="
    requestDetails &&
    tabType === CNSearchEnumRef.SENT_REQUESTS &&
    requestType === CNSearchEnumRef.ACTIVATE_CN
  "
  [requestDetails]="requestDetails"
></poss-web-activate-cn-view>

<poss-web-cancel-cn-view
  *ngIf="
    requestDetails &&
    tabType === CNSearchEnumRef.SENT_REQUESTS &&
    requestType === CNSearchEnumRef.CANCEL_CN
  "
  [requestDetails]="requestDetails"
></poss-web-cancel-cn-view>

<div
  class="pw-white-overlay-box"
  *ngIf="
    requestDetails &&
    tabType === CNSearchEnumRef.SENT_REQUESTS &&
    (requestType === CNSearchEnumRef.ACTIVATE_CN ||
      requestType === CNSearchEnumRef.REMOVE_GOLD_RATE ||
      requestType === CNSearchEnumRef.CANCEL_CN)
  "
>
  <poss-web-file-upload-list-items
    [fileList]="filesList"
    (view)="loadFileImageUrl($event)"
    [viewMode]="'true'"
  ></poss-web-file-upload-list-items>
</div>

<poss-web-activate-cn-edit
  *ngIf="
    creditNoteDetails &&
    tabType === CNSearchEnumRef.CN_ACTIVITY &&
    requestType === CNSearchEnumRef.ACTIVATE_CN
  "
  [creditNoteDetails]="creditNoteDetails"
></poss-web-activate-cn-edit>

<poss-web-cancel-cn-edit
  *ngIf="
    creditNoteDetails &&
    tabType === CNSearchEnumRef.CN_ACTIVITY &&
    requestType === CNSearchEnumRef.CANCEL_CN
  "
  [creditNoteDetails]="creditNoteDetails"
></poss-web-cancel-cn-edit>

<poss-web-refund-payment-modes
  *ngIf="
    showPaymentComponentForApprovedCancelCnRequest ||
    (requestType === CNSearchEnumRef.CANCEL_CN &&
      creditNoteDetails &&
      creditNoteDetails.isAutoApproved &&
      refundAmountDetails)
  "
  [refundDeductionAmount]="refundAmountDetails?.refundDeductionAmount"
  [netRefundAmount]="refundAmountDetails?.netRefundAmount"
  [amount]="refundAmountDetails?.amount"
  [refundAmountDetails]="refundAmountDetails"
  [refundPaymentMode]="refundAmountDetails?.refundPaymentMode"
  [allowedRefundPaymentModes]="refundAmountDetails?.allowedRefundPaymentModes"
  [creditNoteDetails]="creditNoteDetails"
  (cnRefundPaymentData)="cnRefundPaymentData($event)"
  (isPaymentFormValid)="isPaymentFormValid($event)"
></poss-web-refund-payment-modes>

<poss-web-trasnfet-to-eghs-edit
  *ngIf="
    creditNoteDetails &&
    tabType === CNSearchEnumRef.CN_ACTIVITY &&
    requestType === CNSearchEnumRef.EGHS_TRANSFER
  "
  [creditNoteDetails]="creditNoteDetails"
  (transferAmount)="transferAmount($event)"
  (accountNumber)="accountNumber($event)"
  (isAccountNumReq)="isAccountNumReq($event)"
></poss-web-trasnfet-to-eghs-edit>

<poss-web-transfer-to-eghs-view
  *ngIf="transferCreditNoteDetails && tabType === CNSearchEnumRef.EGHS_TRANSFER"
  [creditNoteDetails]="transferCreditNoteDetails"
></poss-web-transfer-to-eghs-view>
<ng-container
  *ngIf="
    creditNoteDetails &&
    tabType === CNSearchEnumRef.CN_ACTIVITY &&
    requestType === CNSearchEnumRef.CN_DETAILS
  "
>
  <poss-web-view-cn-details [creditNoteDetails]="creditNoteDetails">
  </poss-web-view-cn-details>
  <poss-web-rtgs-refund-view
    *ngIf="creditNoteDetails?.status === CNStatusEnumRef.CANCELLED"
    [creditNoteDetails]="creditNoteDetails"
  ></poss-web-rtgs-refund-view>
  <poss-web-cheque-refund-view
    *ngIf="
      creditNoteDetails?.cnRefundDetails?.refundPaymentMode ===
      refundOptionTypes.CHEQUE
    "
    [creditNoteDetails]="creditNoteDetails"
  ></poss-web-cheque-refund-view>
  <poss-web-cc-refund-view
    *ngIf="
      creditNoteDetails?.cnRefundDetails?.refundPaymentMode ===
      refundOptionTypes.CARD
    "
    [creditNoteDetails]="creditNoteDetails"
  ></poss-web-cc-refund-view>
  <poss-web-airpay-refund-view
    *ngIf="
      creditNoteDetails?.cnRefundDetails?.refundPaymentMode ===
      refundOptionTypes.AIRPAY
    "
    [creditNoteDetails]="creditNoteDetails"
  ></poss-web-airpay-refund-view>
  <poss-web-razorpay-refund-view
    *ngIf="
      creditNoteDetails?.cnRefundDetails?.refundPaymentMode ===
      refundOptionTypes.RAZORPAY
    "
    [creditNoteDetails]="creditNoteDetails"
  ></poss-web-razorpay-refund-view>
</ng-container>

<poss-web-loader
  *ngIf="(isLoading$ | async) || (isPaymentLoading$ | async) || (printingService.getPrinterIsLoading() | async)"
></poss-web-loader>
<ng-template #confirmSuccessNotificationTemplate>
  <div class="pw-text-center">
    <h5
      class="pw-success-color"
      *ngIf="
        requestType === CNSearchEnumRef.REMOVE_GOLD_RATE &&
        tabType === CNSearchEnumRef.CN_ACTIVITY
      "
    >
      {{ 'pw.creditNote.confirmationMsg' | translate }}
    </h5>
    <h5
      class="pw-success-color"
      *ngIf="
        requestType === CNSearchEnumRef.ACTIVATE_CN &&
        tabType === CNSearchEnumRef.CN_ACTIVITY
      "
    >
      {{ 'pw.creditNote.activationReqLabel' | translate }}
    </h5>
    <h5
      class="pw-success-color"
      *ngIf="
        requestType === CNSearchEnumRef.CANCEL_CN &&
        tabType === CNSearchEnumRef.CN_ACTIVITY
      "
    >
      {{ 'pw.creditNote.cancellationReqLabel' | translate }}
    </h5>
    <div class="pt-2">
      {{ 'pw.creditNote.reqNumberLabel' | translate }}:
      {{ requestId }}
    </div>
  </div>
</ng-template>

<ng-template #transferToEGHSSuccessNotificationTemplate>
  <div class="pw-text-center">
    <h5 class="pw-success-color">
      {{ 'pw.creditNote.transferSuccessMsg' | translate }}
    </h5>
    <div class="pt-2">
      {{ 'pw.creditNote.newCnLabel' | translate }}:
      {{ transferToEghsDetails.docNo }}
    </div>
    <div class="pt-2" *ngIf="transferToEghsDetails.balanceAmtCnDocNo">
      {{ 'pw.creditNote.balanceAmtDocNoLabel' | translate }}:
      {{ transferToEghsDetails.balanceAmtCnDocNo }}
    </div>
    <div class="pt-2" *ngIf="transferToEghsDetails.balanceAmtCnDocNo">
      {{ 'pw.creditNote.balanceAmtLabel' | translate }}:
      {{
        creditNoteDetails?.amount - transferToEghsDetails?.amount
          | currencyFormatter
      }}
    </div>
  </div>
</ng-template>

<ng-template #confirmRequestNotificationTemplate>
  <div *ngIf="requestType === CNSearchEnumRef.CANCEL_CN" class="pw-text-center">
    <h5 class="pw-success-color">
      {{ 'pw.creditNote.cnCancelSuccessMsg' | translate }}{{ cnNumber }}
      {{ 'pw.creditNote.cnCancelSubSuccessMsg' | translate }}
    </h5>
    <h4 class="pw-success-color pw-pointer" (click)="print()">
      <span class="pw-i-16 pw-download-icon-16 pw-print"></span>
      {{ 'pw.regularCashMemo.printButtonTxt' | translate }}
    </h4>
  </div>

  <div
    *ngIf="
      requestType !== CNSearchEnumRef.CANCEL_CN &&
      requestType !== CNSearchEnumRef.ACTIVATE_CN
    "
    class="pw-text-center"
  >
    <h5 class="pw-success-color">
      {{ 'pw.creditNote.confirmSuccessMsg' | translate }}
    </h5>
    <div class="pt-2">
      {{ 'pw.creditNote.confirmSubSuccessMsg' | translate }}:
      {{ cnNumber }}
    </div>
  </div>
  <div
    *ngIf="requestType === CNSearchEnumRef.ACTIVATE_CN"
    class="pw-text-center"
  >
    <h5 class="pw-success-color">
      {{ 'pw.creditNote.confirmCnActivateSuccessMsg' | translate }}
    </h5>
    <div class="pt-2">
      {{ 'pw.creditNote.confirmCnActivateSubSuccessMsg' | translate }}:
      {{ cnNumber }}
    </div>
  </div>
</ng-template>
