<div class="row align-items-end">
  <div class="col-auto align-self-baseline">
    <button (click)="createTepHome()" class="pw-btn pw-accent-btn">
      {{ 'pw.tep.createnewtep' | translate }}
    </button>
  </div>

  <mat-form-field class="col-lg-3 col-4 ml-auto" floatLabel="never">
    <input
      #searchBox
      type="number"
      [min]="0"
      matInput
      class="pw-input-box"
      placeholder="
      Search by TEP Doc no.
    "
      [formControl]="searchFormControl"
    />
    <mat-icon matSuffix>
      <span
        *ngIf="!searchFormControl.value"
        class="pw-i-16 pw-search-icon-16"
      ></span
    ></mat-icon>
    <mat-icon matSuffix (click)="clearSearch()">
      <span
        *ngIf="searchFormControl.value"
        class="pw-i-10 pw-close-icon-16"
      ></span
    ></mat-icon>
  </mat-form-field>

  <mat-form-field class="pw-single-bordered-input col-lg-2 col-3" required>
    <mat-label> {{ 'pw.tep.refundTypeLabel' | translate }}</mat-label>
    <mat-select
      disableOptionCentering
      placeholder="Refund type"
      [formControl]="refundtype"
      (selectionChange)="onSelectionStatusChange($event)"
    >
      <mat-option
        *ngFor="let refund of refundTypeList"
        [value]="refund.value"
        >{{ refund.description }}</mat-option
      >
    </mat-select>
    <mat-error *ngIf="refundtype.errors && refundtype.errors.errorArray">
      <poss-web-error-info-tooltip
        [errorMessage]="refundtype.errors.errorArray"
      ></poss-web-error-info-tooltip>
    </mat-error>
  </mat-form-field>

  <mat-form-field class="pw-single-bordered-input col-lg-2 col-3" required>
    <mat-label> {{ 'pw.tep.tepType' | translate }}</mat-label>
    <mat-select
      disableOptionCentering
      placeholder="Type"
      [formControl]="type"
      (selectionChange)="onSelectionStatusChange($event)"
    >
      <mat-option *ngFor="let type of typeList" [value]="type.value">{{
        type.description
      }}</mat-option>
    </mat-select>
    <mat-error *ngIf="type.errors && type.errors.errorArray">
      <poss-web-error-info-tooltip
        [errorMessage]="type.errors.errorArray"
      ></poss-web-error-info-tooltip>
    </mat-error>
  </mat-form-field>

  <mat-form-field class="pw-single-bordered-input col-lg-2 col-3" required>
    <mat-label>{{ 'pw.tep.status' | translate }}</mat-label>
    <mat-select
      disableOptionCentering
      placeholder="Status"
      [formControl]="status"
      (selectionChange)="onSelectionStatusChange($event)"
    >
      <mat-option *ngFor="let status of statusesList" [value]="status.value">{{
        status.description
      }}</mat-option>
    </mat-select>
    <mat-error *ngIf="status.errors && status.errors.errorArray">
      <poss-web-error-info-tooltip
        [errorMessage]="status.errors.errorArray"
      ></poss-web-error-info-tooltip>
    </mat-error>
  </mat-form-field>
</div>

<poss-web-card-list
  [count]="count"
  [dataList]="requestList"
  [pageSize]="pageSize"
  (loadMore)="loadmore($event)"
  (selected)="onSelected($event)"
>
  <ng-template let-item="data">
    <poss-web-card-title>
      <div class="row">
        <div class="col-auto">
          <h4>{{ item.docNo }}</h4>
        </div>
      </div>

      <div class="col-auto ml-auto"></div>
    </poss-web-card-title>

    <poss-web-card-content>
      <div class="row pw-grid-card__content">
        <p class="col-5 pw-grid-card__label">
          {{ 'pw.tep.custName' | translate }}
        </p>
        <p class="col-auto pw-grid-card__label pw-grid-card__padding-5">:</p>
        <p class="col">{{ item.headerData.data.customerName }}</p>
      </div>
      <div class="row pw-grid-card__content">
        <p class="col-5 pw-grid-card__label">
          {{ 'pw.tep.productQty' | translate }}
        </p>
        <p class="col-auto pw-grid-card__label pw-grid-card__padding-5">:</p>
        <p class="col">{{ item.headerData.data.totalQuantity }}</p>
      </div>
      <div class="row pw-grid-card__content">
        <p class="col-5 pw-grid-card__label">
          {{ 'pw.tep.totalGrossWt' | translate }}
        </p>
        <p class="col-auto pw-grid-card__label pw-grid-card__padding-5">:</p>
        <p class="col">{{ item.headerData.data.totalWeight }} gms.</p>
      </div>
      <div class="row pw-grid-card__content">
        <p class="col-5 pw-grid-card__label">
          {{ 'pw.tep.totalRefundvalue' | translate }}
        </p>
        <p class="col-auto pw-grid-card__label pw-grid-card__padding-5">:</p>
        <p class="col">
          {{
            (item.headerData.data?.totalRefundAmount ?
            item.headerData.data?.totalRefundAmount :
            item.headerData.data?.totalValue) | currencyFormatter: currencyCode
          }}
        </p>
      </div>

      <div class="row p w-grid-card__content">
        <p class="col-5 pw-grid-card__label">
          {{ 'pw.tep.status' | translate }}
        </p>
        <p class="col-auto pw-grid-card__label pw-grid-card__padding-5">:</p>
        <p
          class="col"
          [ngClass]="getStatusColor(item.status ? item.status : '')"
        >
          {{ statusMessage }}
        </p>
      </div>
    </poss-web-card-content>
  </ng-template>
</poss-web-card-list>

<h3
  class="pw-text-center m-5"
  *ngIf="(isLoading$ | async) === false && count === 0"
>
  {{ noDataFoundMessage }}
</h3>

<poss-web-loader *ngIf="(isLoading$ | async) === true"> </poss-web-loader>
