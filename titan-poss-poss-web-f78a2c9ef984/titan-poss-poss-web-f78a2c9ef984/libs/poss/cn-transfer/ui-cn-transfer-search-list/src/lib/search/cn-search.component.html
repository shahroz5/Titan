<div class="cn-search pw-form-card" [formGroup]="searchFormGroup">
  <div class="pw-form-card__item">
    <mat-radio-group
      formControlName="transferMode"
      (change)="onSelectTransferMode()"
      class="row"
    >
      <mat-radio-button
        [value]="cnSearchEnumRef.CN_INWARDING"
        class="col-lg-3 col-3"
      >
        <div>
          {{ 'pw.creditNote.cnInwardingTransferLabel' | translate }}
        </div>
      </mat-radio-button>

      <mat-radio-button
        [value]="cnSearchEnumRef.CN_OUTWARDING"
        class="col-lg-3 col-3"
        *possWebPermission="loadPermission(LEGACY_OUTWARD_PERMISSION)"
      >
        <div>
          {{ 'pw.creditNote.cnOutwardingTransferLabel' | translate }}
        </div>
      </mat-radio-button>
    </mat-radio-group>
  </div>
  <div class="row">
    <ng-container
      [ngTemplateOutlet]="
        searchFormGroup.get('transferMode').value !==
        cnSearchEnumRef.CN_OUTWARDING
          ? srcLocation
          : destLocation
      "
    >
    </ng-container>
    <ng-container
      [ngTemplateOutlet]="
        searchFormGroup.get('transferMode').value !==
        cnSearchEnumRef.CN_OUTWARDING
          ? destLocation
          : srcLocation
      "
    >
    </ng-container>
  </div>
  <div class="row">
    <mat-form-field class="col-lg-3 col-3">
      <input
        matInput
        required
        formControlName="cnNumber"
        type="text"
        class="pw-single-bordered-input"
        placeholder="CN Number"
      />
      <mat-error
        *ngIf="
          searchFormGroup.get('cnNumber').errors &&
          searchFormGroup.get('cnNumber').errors.errorArray
        "
      >
        <poss-web-error-info-tooltip
          [errorMessage]="searchFormGroup.get('cnNumber').errors.errorArray"
        ></poss-web-error-info-tooltip>
      </mat-error>
    </mat-form-field>

    <poss-web-fiscal-year
      class="col-lg-3 col-3"
      [control]="searchFormGroup.get('fiscalYear')"
      [required]="searchFormGroup.get('cnNumber').value !== '' ? true : false"
      [currentFiscalYear]="currentFiscalYear"
      [placeHolder]="'pw.creditNote.searchByFiscalYearLabel' | translate"
      [disabled]="false"
    ></poss-web-fiscal-year>

    <div class="col-auto pw-form-card__right-container">
      <button
        class="pw-btn pw-accent-btn"
        [disabled]="searchFormGroup.invalid"
        (click)="search()"
      >
        {{ 'pw.creditNote.searchLabel' | translate }}
      </button>
    </div>
  </div>

  <ng-template #srcLocation>
    <mat-form-field class="col-lg-3 col-3">
      <input
        matInput
        required
        readonly
        formControlName="srcLocation"
        (click)="openLocationSelectionPopup()"
        (keydown.enter)="openLocationSelectionPopup()"
        [placeholder]="'pw.creditNote.sourceLocationLabel' | translate"
        class="pw-single-bordered-input"
      />
      <mat-icon matSuffix>
        <span class="pw-i-16 pw-location-icon-16"></span>
      </mat-icon>
    </mat-form-field>

    <div *ngIf="selectedLocationDetails" class="col-lg-3 col-3">
      <div>
        <!-- <p class="pw-tertinary-color">{{ 'pw.creditNote.sourceLocationNameLabel' | translate}}</p> -->
        <mat-form-field class="pw-form-card__input-width">
          <input
            matInput
            disabled
            type="text"
            [placeholder]="'pw.creditNote.sourceLocationNameLabel' | translate"
            [value]="selectedLocationDetails.description"
            class="pw-single-bordered-input"
          />
        </mat-form-field>
        <!-- <p class="pw-font-weight-bold mt-1">
          {{ selectedLocationDetails.description }}
        </p> -->
      </div>
    </div>
  </ng-template>
  <ng-template #destLocation>
    <mat-form-field class="col-lg-3 col-3">
      <input
        matInput
        required
        readonly
        formControlName="destinationLocation"
        (click)="openDestiLocationSelectionPopup()"
        (keydown.enter)="openDestiLocationSelectionPopup()"
        [placeholder]="'pw.creditNote.destinationLocationLabel' | translate"
        class="pw-single-bordered-input"
      />
      <mat-icon matSuffix>
        <span class="pw-i-16 pw-location-icon-16"></span>
      </mat-icon>
    </mat-form-field>

    <div *ngIf="selectedDestiLocationDetails" class="col-lg-3 col-3">
      <div>
        <mat-form-field class="pw-form-card__input-width">
          <input
            matInput
            disabled
            type="text"
            [placeholder]="
              'pw.creditNote.destinationLocationNameLabel' | translate
            "
            [value]="selectedDestiLocationDetails.description"
            class="pw-single-bordered-input"
          />
        </mat-form-field>
        <!-- <p class="pw-tertinary-color">{{'pw.creditNote.destinationLocationNameLabel' | translate}}</p>
        <p class="pw-font-weight-bold mt-1">
          {{ selectedDestiLocationDetails.description }}
        </p> -->
      </div>
    </div>
  </ng-template>
</div>
