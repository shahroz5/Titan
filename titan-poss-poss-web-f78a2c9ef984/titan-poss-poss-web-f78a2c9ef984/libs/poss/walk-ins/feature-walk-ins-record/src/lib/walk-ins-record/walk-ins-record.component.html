<div class="pw-body-bg-img">
  <div class="container-fluid">
    <div class="row" [formGroup]="walkInRecordFormGroup">
      <div class="col-12 col-lg-10 m-auto">
        <div class="pw-top-heading-container">
          <div class="row pw-top-heading-container__item">
            <div class="col-auto">
              <div class="pw-top-heading-container__main-head">
                <a (click)="back()">
                  <span class="pw-i-24 pw-back-arrow-icon-24"></span>
                </a>
                <span class="pw-i-36 pw-customer-transaction-icon-36"></span>
                <div class="pw-top-heading-container__heading">
                  {{ 'pw.walkins.boutiqueAdmin' | translate }}
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="row mt-3">
          <div class="col-auto">
            <div class="pw-mont-semibold-14">
              {{ 'pw.walkins.addWalkInDetails' | translate }}
            </div>
          </div>
        </div>
        <div class="pw-detail-card">
          <div class="row">
            <mat-form-field class="pw-single-bordered-input col-lg-3 col-4">
              <mat-label>{{ 'pw.walkins.selectDate' | translate }}</mat-label>

              <input
                matInput
                [matDatepicker]="datePicker"
                [matDatepickerFilter]="myFilterFunction"
                autocomplete="off"
                formControlName="selectDate"
                (click)="datePicker.open()"
                readonly
                required
              />
              <mat-datepicker-toggle matSuffix [for]="datePicker">
                <mat-icon matDatepickerToggleIcon>
                  <span class="pw-i-12 pw-calender-icon-12"></span>
                </mat-icon>
              </mat-datepicker-toggle>
              <mat-datepicker #datePicker></mat-datepicker>
              <mat-error
                *ngIf="
                  walkInRecordFormGroup.get('selectDate').errors &&
                  walkInRecordFormGroup.get('selectDate').errors.errorArray
                "
              >
                <poss-web-error-info-tooltip
                  [errorMessage]="
                    walkInRecordFormGroup.get('selectDate').errors.errorArray
                  "
                ></poss-web-error-info-tooltip>
              </mat-error>
            </mat-form-field>

            <div class="col-lg-3 col-4">
              <mat-form-field [floatLabel]="'always'">
                <mat-label>{{ 'pw.walkins.walkIns' | translate }}</mat-label>
                <input
                  matInput
                  formControlName="walkIns"
                  type="number"
                  min="0"
                />
                <mat-error
                  *ngIf="
                    walkInRecordFormGroup.get('walkIns').errors &&
                    walkInRecordFormGroup.get('walkIns').errors.errorArray
                  "
                >
                  <poss-web-error-info-tooltip
                    [errorMessage]="
                      walkInRecordFormGroup.get('walkIns').errors.errorArray
                    "
                  >
                  </poss-web-error-info-tooltip>
                </mat-error>
              </mat-form-field>
            </div>
            <div class="col-lg-3 col-4">
              <div class="pw-detail-card__label">
                {{ 'pw.walkins.noOfInvoices' | translate }}
              </div>
              <div class="pw-font-weight-bold">
                {{ numberOfInvoices }}
              </div>
            </div>
          </div>
          <div class="pw-detail-card__secondary-section">
            <div class="row">
              <div class="col-lg-3 col-4">
                <div class="pw-detail-card__label">
                  {{ 'pw.walkins.purchasers' | translate }}
                </div>
                <div class="pw-font-weight-bold">
                  {{ purchasersCount }}
                </div>
              </div>
              <div class="col-lg-3 col-4">
                <div class="pw-detail-card__label">
                  {{ 'pw.walkins.nonPurchasers' | translate }}
                </div>
                <div class="pw-font-weight-bold">{{ nonPurchasersCount }}</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="row pw-confirmation-box__footer-border">
      <div class="col-12 col-lg-10 m-auto">
        <div class="row">
          <div class="col-auto ml-auto">
            <button
              class="pw-btn pw-primary-btn"
              (click)="clearWalkInsRecord()"
            >
              {{ 'pw.walkins.clear' | translate }}
            </button>
          </div>
          <div class="col-auto">
            <button class="pw-btn pw-accent-btn" (click)="saveWalkInDetails()">
              {{ 'pw.walkins.save' | translate }}
            </button>
          </div>
        </div>
      </div>
    </div>

    <poss-web-top-info-panel
      *ngIf="isFocusing && focusedHeaderName"
      [isFocusing]="isFocusing"
      [focusedHeaderName]="focusedHeaderName"
      [currentRowData]="currentRowInfo"
    >
    </poss-web-top-info-panel>

    <div class="row pw-titan-poss-theme mb-2">
      <div class="col-12 col-lg-10 m-auto">
        <div class="row mt-3 mb-2">
          <div class="col-auto">
            <div class="pw-mont-semibold-14">
              {{ 'pw.walkins.walkInDetails' | translate }}
            </div>
          </div>
        </div>
        <ag-grid-angular
          class="pw-ag-grid-table"
          [columnDefs]="columnDefs"
          [defaultColDef]="defaultColDef"
          [rowData]="walkInsRowData"
          [rowSelection]="rowSelection"
          [context]="getContext()"
          [animateRows]="animateRows"
          [domLayout]="domLayout"
          [rowHeight]="rowHeight"
          (gridReady)="gridReady($event)"
          (gridSizeChanged)="onGridSizeChanged()"
          (cellFocused)="onCellFocused($event)"
          (focusout)="focusOut($event)"
        ></ag-grid-angular>
      </div>
    </div>
  </div>
</div>

<poss-web-loader *ngIf="isWalkInsLoading$ | async"></poss-web-loader>
