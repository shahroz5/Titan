<mat-expansion-panel
  *ngIf="quickLinks?.length > 0"
  class="pw-sidenav__expansion-panel pw-sidenav__main-panel"
  expanded="true"
  #quickLinksPanel
>
  <mat-expansion-panel-header
    [collapsedHeight]="'35px'"
    [expandedHeight]="'35px'"
    routerLinkActive="active"
    class="pw-sidenav__expansion-header"
  >
    <mat-panel-title class="pw-sidenav__expansion-title">
      <span class="pw-fourth-color pw-font-weight-bold">{{
        'pw.sidemenu.quicklinksMenuItemText' | translate
      }}</span>
    </mat-panel-title>
  </mat-expansion-panel-header>
  <ng-container *ngFor="let item of quickLinks">
    <ng-container *ngIf="item.external; else internalMenuItem">
      <poss-web-menu-item
        class="pw-sidenav__sub-list pw-pointer"
        *possWebPermission="getPermissions(item.permission)"
        tabindex="-1"
        (click)="sideNavToggle.emit()"
        (keydown.enter)="
          sideNavToggle.emit(); queryItem.element.nativeElement.click()
        "
        (focusToggle)="quickLinksPanel.expanded = true"
        #queryItem
      >
        <a [href]="hostname + '/' + item.url">{{
          item.translatedName | translate
        }}</a>
      </poss-web-menu-item>
    </ng-container>
    <ng-template #internalMenuItem>
      <poss-web-menu-item
        class="pw-sidenav__sub-list pw-pointer"
        *possWebPermission="getPermissions(item.permission)"
        tabindex="-1"
        (click)="sideNavToggle.emit()"
        [routerLink]="[item.url]"
        routerLinkActive="active"
        (keydown.enter)="
          sideNavToggle.emit(); queryItem.element.nativeElement.click()
        "
        (focusToggle)="quickLinksPanel.expanded = true"
        #queryItem
      >
        {{ item.translatedName | translate }}
      </poss-web-menu-item>
    </ng-template>
  </ng-container>
</mat-expansion-panel>
<mat-accordion multi="true">
  <div *ngFor="let sidenavitems of menuData">
    <ng-container
      *ngIf="
        sidenavitems.children && sidenavitems.children.length;
        else singlelevelMenu
      "
    >
      <mat-expansion-panel
        expanded="true"
        class="pw-sidenav__expansion-panel pw-sidenav__main-panel"
        *possWebPermission="getPermissions(sidenavitems.permission)"
        #menuPanel
      >
        <mat-expansion-panel-header
          [collapsedHeight]="'35px'"
          [expandedHeight]="'35px'"
          [ngClass]="
            sidenavitems.isExactMatchForSearchInput
              ? 'pw-search-match-background pw-sidenav__expansion-header'
              : 'pw-sidenav__expansion-header'
          "
          routerLinkActive="active"
        >
          <mat-panel-title
            [ngClass]="
              sidenavitems.isExactMatchForSearchInput
                ? 'pw-search-match-background '
                : 'pw-sidenav__expansion-title'
            "
          >
            <ng-container *ngIf="sidenavitems.external; else internalMenuItem">
              <a
                (click)="sideNavToggle.emit()"
                [href]="hostname + '/' + sidenavitems.url"
              >
                <span
                  [ngClass]="
                    sidenavitems.isExactMatchForSearchInput
                      ? 'pw-font-weight-bold'
                      : 'pw-fourth-color pw-font-weight-bold'
                  "
                  >{{ sidenavitems.translatedName | translate }}</span
                ></a
              >
            </ng-container>
            <ng-template #internalMenuItem>
              <a (click)="sideNavToggle.emit()" [routerLink]="sidenavitems.url">
                <span
                  [ngClass]="
                    sidenavitems.isExactMatchForSearchInput
                      ? 'pw-font-weight-bold'
                      : 'pw-fourth-color pw-font-weight-bold'
                  "
                  >{{ sidenavitems.translatedName | translate }}</span
                >
              </a>
            </ng-template>
          </mat-panel-title>
        </mat-expansion-panel-header>
        <poss-web-sub-menu
          class="pw-poss-web-sub-menu"
          [sidenavitems]="sidenavitems.children"
          (sideNavToggle)="sideNavToggle.emit()"
          (panelToggle)="menuPanel.expanded = true"
          #queryItem
        ></poss-web-sub-menu>
      </mat-expansion-panel>
    </ng-container>
    <ng-template #singlelevelMenu>
      <ng-container *ngIf="sidenavitems.external; else internalMenuItem">
        <poss-web-menu-item
          *possWebPermission="getPermissions(sidenavitems.permission)"
          [ngClass]="
            sidenavitems.isExactMatchForSearchInput
              ? 'pw-search-match-background pw-sidenav__list pw-pointer'
              : 'pw-sidenav__list pw-pointer'
          "
          (click)="sideNavToggle.emit()"
          (keydown.enter)="
            sideNavToggle.emit(); queryItem.element.nativeElement.click()
          "
          tabindex="-1"
          #queryItem
        >
          <a [href]="hostname + '/' + sidenavitems.url"
            ><span
              [ngClass]="
                sidenavitems.isExactMatchForSearchInput
                  ? 'pw-font-weight-bold'
                  : 'pw-fourth-color pw-font-weight-bold'
              "
              >{{ sidenavitems.translatedName | translate }}</span
            ></a
          >
        </poss-web-menu-item>
      </ng-container>
      <ng-template #internalMenuItem>
        <poss-web-menu-item
          *possWebPermission="getPermissions(sidenavitems.permission)"
          [ngClass]="
            sidenavitems.isExactMatchForSearchInput
              ? 'pw-search-match-background pw-sidenav__list pw-pointer'
              : 'pw-sidenav__list pw-pointer'
          "
          (click)="sideNavToggle.emit()"
          (keydown.enter)="
            sideNavToggle.emit(); queryItem.element.nativeElement.click()
          "
          [routerLink]="[sidenavitems.url]"
          routerLinkActive="active"
          tabindex="-1"
          #queryItem
        >
          <span
            [ngClass]="
              sidenavitems.isExactMatchForSearchInput
                ? 'pw-font-weight-bold'
                : 'pw-fourth-color pw-font-weight-bold'
            "
            >{{ sidenavitems.translatedName | translate }}</span
          ></poss-web-menu-item
        >
      </ng-template>
    </ng-template>
  </div>
</mat-accordion>
