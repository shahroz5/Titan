<mat-progress-bar
  *ngIf="
    data.type == overlayNotificationTypes.TIMER ||
    data.type == overlayNotificationTypes.PROGRESS
  "
  mode="indeterminate"
></mat-progress-bar>
<div class="pw-overlay-notification">
  <div class="container-fluid">
    <div class="row align-items-center pw-overlay-notification__container">
      <ng-container
        *ngIf="
          data.type != overlayNotificationTypes.CUSTOM &&
          data.type != overlayNotificationTypes.ERROR
        "
      >
        <div
          class="col-auto pw-overlay-notification__content"
          [class.col-8]="
            data.type == overlayNotificationTypes.ACTION && !data.hasRemarks
          "
          [class.col-4]="data.hasRemarks"
          [class.pw-success-color]="
            data.type == overlayNotificationTypes.SUCCESS
          "
        >
          {{ data.message }}
        </div>

        <ng-container *ngIf="data.hasRemarks">
          <mat-form-field
            [formGroup]="notificationForm"
            class="col-auto pw-white-form-field pw-form-field-border-top-0"
            floatLabel="never"
          >
            <textarea
              class="pw-textarea"
              formControlName="remarks"
              rows="1"
              matInput
              placeholder="
              {{
                (
                  translate.get('pw.overlayNotifcation.remarksPlaceholder')
                  | async
                )?.replace('{0}', remarksMaxCharLimit)
              }}
              "
              name="remarkField"
              possWebMaxLengthValidator
            ></textarea>
            <mat-error
              *ngIf="
                notificationForm.get('remarks').errors &&
                notificationForm.get('remarks').errors.errorArray
              "
            >
              <poss-web-error-info-tooltip
                [errorMessage]="
                  notificationForm.get('remarks').errors.errorArray
                "
              ></poss-web-error-info-tooltip>
            </mat-error>
          </mat-form-field>
        </ng-container>

        <ng-container *ngIf="data.type == overlayNotificationTypes.ACTION">
          <div class="col-auto ml-auto pw-overlay-notification__content">
            <button
              mat-raised-button
              class="pw-btn pw-accent-btn"
              (click)="emitEvent(eventTypeRef.TRUE)"
            >
              {{ data.buttonText }}
            </button>
          </div>
        </ng-container>
        <br />
        <ng-container
          *ngIf="data.type == overlayNotificationTypes.MULTI_ACTION"
        >
          <div class="col-auto ml-auto pw-overlay-notification__content">
            <button
              *ngFor="let button of data.buttons"
              mat-raised-button
              class="pw-btn"
              (click)="
                emitMultiActionEvent(button.id, !!button.hasRemarksValidation)
              "
              [ngClass]="button.css"
            >
              {{ button.text }}
            </button>
          </div>
        </ng-container>
      </ng-container>
      <ng-container *ngIf="data.type == overlayNotificationTypes.CUSTOM">
        <div class="pw-overlay-notification__content m-auto">
          <ng-container [ngTemplateOutlet]="data.template"> </ng-container>
        </div>
      </ng-container>
      <ng-container *ngIf="data.type == overlayNotificationTypes.ERROR">
        <div
          class="pw-overlay-notification__content pw-error-color pw-font-weight-bold"
        >
          <span *ngIf="data?.error?.traceId || locationCode">(</span>
          <ng-container *ngIf="data?.error?.traceId">
            {{ translate.get('pw.overlayNotifcation.traceIdLable') | async }} :
            {{ data.error.traceId }}
          </ng-container>
          <span *ngIf="data?.error?.traceId && locationCode"> : </span>
          <ng-container *ngIf="locationCode">
            {{ locationCode }}
          </ng-container>

          <span *ngIf="data?.error?.traceId || locationCode">)</span>
          <ng-container *ngIf="errorMsgDynamicValues; else onlyErrorMsg">
            {{
              translate.get(translatedErrorMsgKey, errorMsgDynamicValues)
                | async
            }}
          </ng-container>
          <ng-template #onlyErrorMsg>
            {{ translate.get(translatedErrorMsgKey) | async }}
          </ng-template>
        </div>
      </ng-container>
      <ng-container *ngIf="data.hasClose === true && !navigateToHome">
        <div
          class="col-auto pw-overlay-notification__content"
          [class.ml-auto]="
            data.type === overlayNotificationTypes.SIMPLE ||
            data.type === overlayNotificationTypes.SUCCESS ||
            data.type === overlayNotificationTypes.ERROR ||
            data.type === overlayNotificationTypes.TIMER ||
            data.type === overlayNotificationTypes.PROGRESS
          "
        >
          <button
            mat-raised-button
            class="pw-btn pw-accent-btn"
            (click)="emitEvent(eventTypeRef.CLOSE)"
          >
            <div class="pw-btn-close">
              {{
                translate.get('pw.overlayNotifcation.closeButtonText') | async
              }}
            </div>

            <div class="pw-btn-esc-text">
              (
              {{ translate.get('pw.overlayNotifcation.escLabelText') | async }}
              )
            </div>
          </button>
        </div>
      </ng-container>
      <ng-container *ngIf="navigateToHome">
        <div class="col-auto pw-overlay-notification__content ml-auto">
          <button
            *ngIf="navigateToHome"
            mat-raised-button
            class="pw-btn pw-accent-btn"
            (click)="navigateToHomeFn()"
          >
            {{ translate.get('pw.overlayNotifcation.homeButtonText') | async }}
          </button>
        </div>
      </ng-container>
    </div>
  </div>
</div>
