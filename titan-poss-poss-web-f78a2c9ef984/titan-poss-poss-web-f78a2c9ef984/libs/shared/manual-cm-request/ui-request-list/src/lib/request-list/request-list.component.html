<div class="row align-items-center">
  <div class="col-auto ml-auto">
    <button
      *ngIf="!selectedLocation && user"
      mat-flat-button
      class="pw-btn pw-cta-btn"
      (click)="openLocationPopup()"
    >
      <div class="row">
        <div class="col-auto">
          <p>
            {{ 'pw.approvals.selectLocationCode' | translate }}
          </p>
        </div>
        <div class="col-auto ml-auto">
          <span class="pw-i-16 pw-location-icon-16"></span>
        </div>
      </div>
    </button>

    <button
      *ngIf="selectedLocation && user"
      mat-flat-button
      class="pw-btn pw-cta-btn"
    >
      <div class="row">
        <div class="col-auto">
          <p>
            {{ selectedLocation.description }}
          </p>
        </div>
        <div class="col-auto ml-auto">
          <a>
            <span
              class="pw-i-10 pw-close-icon-16"
              (click)="clearPopup()"
            ></span>
          </a>
        </div>
      </div>
    </button>
  </div>
  <mat-form-field class="col-lg-3 col-4 pw-search-bar" floatLabel="never">
    <input
      #searchBox
      matInput
      class="pw-input-box"
      [placeholder]="
        'pw.cmRequestApproval.searchByRequestNumberPlaceHolder' | translate
      "
      [formControl]="searchFormControl"
    />
    <mat-icon matSuffix>
      <span
        *ngIf="!searchFormControl.value"
        class="pw-i-16 pw-search-icon-16"
      ></span
    ></mat-icon>
    <mat-icon matSuffix (click)="clearSearch()">
      <span
        *ngIf="searchFormControl.value"
        class="pw-i-10 pw-close-icon-16"
      ></span
    ></mat-icon>
  </mat-form-field>
  <div *ngIf="!user" class="col-lg-2 col-3">
    <poss-web-select-dropdown
      class="pw-single-bordered-input"
      [placeholder]="
        'pw.cmRequestApproval.requestStatusPlaceHolder' | translate
      "
      [control]="statusFormControl"
      [options]="availableStatus"
      [required]="true"
      (selectionChange)="statusChange($event)"
    >
    </poss-web-select-dropdown>
  </div>
</div>
<poss-web-card-list
  *ngIf="user && cmRequestList.length !== 0"
  [count]="requestListCount"
  [dataList]="cmRequestList"
  [pageSize]="pageSize"
  (selected)="onRequestSelected($event)"
  (loadMore)="loadRequests($event)"
>
  <ng-template let-item="data">
    <poss-web-card-content>
      <div class="row">
        <p class="col-6 pw-grid-card__label pw-grid-card__padding-5">
          {{ 'pw.cmRequestApproval.locationCodeLabel' | translate }}
        </p>
        <p class="col-auto pw-grid-card__label pw-grid-card__padding-5">:</p>
        <p class="col pw-grid-card__ellipses pw-grid-card__padding-5">
          {{ item?.locationCode }}
        </p>
      </div>
      <div class="row pw-grid-card__content">
        <p class="col-6 pw-grid-card__label pw-grid-card__padding-5">
          {{ 'pw.cmRequestApproval.reqNoLabel' | translate }}
        </p>
        <p class="col-auto pw-grid-card__label pw-grid-card__padding-5">:</p>
        <p class="col pw-grid-card__ellipses pw-grid-card__padding-5">
          {{ item?.docNo }}
        </p>
      </div>
      <div class="row pw-grid-card__content">
        <p class="col-6 pw-grid-card__label pw-grid-card__padding-5">
          {{ 'pw.cmRequestApproval.billNumberLabel' | translate }}
        </p>
        <p class="col-auto pw-grid-card__label pw-grid-card__padding-5">:</p>
        <p class="col pw-grid-card__ellipses pw-grid-card__padding-5">
          {{
            item?.headerData?.data?.manualBillDetails?.manualBillDetails
              ?.manualBillNo
          }}
        </p>
      </div>
      <div class="row pw-grid-card__content">
        <p class="col-6 pw-grid-card__label pw-grid-card__padding-5">
          {{ 'pw.cmRequestApproval.billDateLabel' | translate }}
        </p>
        <p class="col-auto pw-grid-card__label pw-grid-card__padding-5">:</p>
        <p class="col pw-grid-card__ellipses pw-grid-card__padding-5">
          {{ dateFormat(item?.headerData?.data?.docDate) | dateFormatter }}
        </p>
      </div>
      <div class="row pw-grid-card__content">
        <p class="col-6 pw-grid-card__label pw-grid-card__padding-5">
          {{ 'pw.cmRequestApproval.customerNameLabel' | translate }}
        </p>
        <p class="col-auto pw-grid-card__label pw-grid-card__padding-5">:</p>
        <p class="col pw-grid-card__ellipses pw-grid-card__padding-5">
          {{ item?.headerData?.data?.customerName }}
        </p>
      </div>
      <div class="row pw-grid-card__content">
        <p class="col-6 pw-grid-card__label pw-grid-card__padding-5">
          {{ 'pw.cmRequestApproval.reasonLabel' | translate }}
        </p>
        <p class="col-auto pw-grid-card__label pw-grid-card__padding-5">:</p>
        <p class="col pw-grid-card__ellipses pw-grid-card__padding-5">
          {{ item?.requestorRemarks }}
        </p>
      </div>
    </poss-web-card-content>
  </ng-template>
</poss-web-card-list>
<h3
  class="pw-text-center m-5"
  *ngIf="(isLoading$ | async) === false && cmRequestList.length === 0"
>
  {{ noDataFoundMessage }}
</h3>
<poss-web-card-list
  *ngIf="!user && cmRequestList.length !== 0"
  [count]="requestListCount"
  [dataList]="cmRequestList"
  [pageSize]="pageSize"
  (selected)="onRequestSelected($event)"
  (loadMore)="loadRequests($event)"
>
  <ng-template let-item="data">
    <poss-web-card-title
      >{{ item?.headerData?.data?.txnType }} |
      {{
        item?.headerData?.data?.manualBillDetails?.manualBillDetails
          ?.manualBillNo
      }}
    </poss-web-card-title>

    <poss-web-card-content>
      <div class="row">
        <p class="col-6 pw-grid-card__ellipses">
          {{ 'pw.cmRequestApproval.reqNoLabel' | translate }}
        </p>
        <p class="col-auto pw-grid-card__padding-5">:</p>
        <p class="col pw-grid-card__padding-5">{{ item?.docNo }}</p>
      </div>
      <div class="row">
        <p class="col-6 pw-grid-card__ellipses">
          {{ 'pw.cmRequestApproval.billDateLabel' | translate }}
        </p>
        <p class="col-auto pw-grid-card__padding-5">:</p>
        <p class="col pw-grid-card__padding-5">
          {{ dateFormat(item?.headerData?.data?.docDate) | dateFormatter }}
        </p>
      </div>
      <div class="row">
        <p class="col-6 pw-grid-card__ellipses">
          {{ 'pw.cmRequestApproval.customerNameLabel' | translate }}
        </p>
        <p class="col-auto pw-grid-card__padding-5">:</p>
        <p class="col pw-grid-card__padding-5">
          {{ item?.headerData?.data?.customerName }}
        </p>
      </div>
      <div class="row">
        <p class="col-6 pw-grid-card__ellipses">
          {{ 'pw.cmRequestApproval.reasonLabel' | translate }}
        </p>
        <p class="col-auto pw-grid-card__padding-5">:</p>
        <p class="col pw-grid-card__padding-5">{{ item?.requestorRemarks }}</p>
      </div>
      <p
        [ngClass]="getStatus(item?.approvalStatus ? item?.approvalStatus : '')"
      >
        {{ item?.approvalStatus | titlecase }}
      </p>
    </poss-web-card-content>
  </ng-template>
</poss-web-card-list>
