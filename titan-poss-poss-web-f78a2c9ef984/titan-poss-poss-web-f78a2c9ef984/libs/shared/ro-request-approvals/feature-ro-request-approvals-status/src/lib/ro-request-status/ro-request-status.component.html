<ng-container *ngIf="isLoggedIn">
  <div class="container-fluid">
    <div class="row">
      <div class="col-12 col-lg-10 m-auto">
        <div class="pw-top-heading-container">
          <div class="row pw-top-heading-container__item">
            <div class="col-auto pr-0">
              <a (click)="back()">
                <span class="pw-i-24 pw-back-arrow-icon-24"></span>
              </a>
            </div>
            <div class="col-auto pl-0">
              <div class="pw-top-heading-container__main-head">
                <span class="pw-i-40 pw-cash-memo-icon-40"></span>
                <div>
                  <h2>
                    {{
                      'pw.roRequestApproval.customerTransactionLabel'
                        | translate
                    }}
                  </h2>
                  <h5 class="pw-top-heading-container__sub-heading">
                    {{ 'pw.roRequestApproval.approvalsLabel' | translate }}
                  </h5>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="pw-tab mt-4">
          <ul class="pw-tab__list">
            <li class="pw-tab__list-item">
              <a class="pw-is-active-bar">
                <h5 class="pw-tab__item">
                  {{ 'pw.roRequestApproval.roRequestsLabel' | translate }}
                </h5>
              </a>
            </li>
          </ul>
        </div>
        <mat-accordion multi>
          <mat-expansion-panel expanded class="pw-expansion-panel">
            <mat-expansion-panel-header
              class="pw-expansion-panel__header"
              [collapsedHeight]="'40px'"
              [expandedHeight]="'40px'"
            >
              <mat-panel-title class="pw-expansion-panel__heading">
                Search Request
              </mat-panel-title>
            </mat-expansion-panel-header>

            <form [formGroup]="requestFilterForm" autocomplete="off">
              <div class="row">
                <poss-web-fiscal-year
                  class="col-lg-2 col-3"
                  [control]="requestFilterForm.get('fiscalYear')"
                  [required]="false"
                  [currentFiscalYear]="currentFiscalYear"
                  [placeHolder]="
                    'pw.creditNote.searchByFiscalYearLabel' | translate
                  "
                  [disabled]="false"
                ></poss-web-fiscal-year>

                <mat-form-field class="col-lg-3 col-3">
                  <mat-label>Doc Date Range</mat-label>
                  <mat-date-range-input
                    [rangePicker]="picker"
                    [max]="currentDate"
                  >
                    <input
                      matStartDate
                      formControlName="startDate"
                      placeholder="Doc From Date"
                    />
                    <input
                      matEndDate
                      formControlName="endDate"
                      placeholder="Doc To Date"
                    />
                  </mat-date-range-input>
                  <mat-datepicker-toggle matSuffix [for]="picker">
                    <mat-icon matDatepickerToggleIcon>
                      <span class="pw-i-12 pw-calender-icon-12"></span>
                    </mat-icon>
                  </mat-datepicker-toggle>

                  <mat-date-range-picker #picker></mat-date-range-picker>

                  <mat-icon
                    *ngIf="
                      requestFilterForm.get('startDate').value !== null &&
                      requestFilterForm.get('endDate').value !== null
                    "
                    class="pw-pointer"
                    matSuffix
                    (click)="clearDocRange()"
                  >
                    <span class="pw-i-10 pw-close-icon-16"></span
                  ></mat-icon>

                  <mat-error
                    *ngIf="
                      requestFilterForm.get('startDate').errors &&
                      requestFilterForm.get('startDate').errors.errorArray
                    "
                  >
                    <poss-web-error-info-tooltip
                      [errorMessage]="
                        requestFilterForm.get('startDate').errors.errorArray
                      "
                    ></poss-web-error-info-tooltip>
                  </mat-error>
                  <mat-error
                    *ngIf="
                      requestFilterForm.get('endDate').errors &&
                      requestFilterForm.get('endDate').errors.errorArray
                    "
                  >
                    <poss-web-error-info-tooltip
                      [errorMessage]="
                        requestFilterForm.get('endDate').errors.errorArray
                      "
                    ></poss-web-error-info-tooltip>
                  </mat-error>
                </mat-form-field>
                <div class="col-auto pw-detail-card__right-container">
                  <button
                    (click)="search()"
                    class="pw-btn pw-accent-btn"
                    [disabled]="requestFilterForm.dirty ? false : true"
                  >
                    {{ 'pw.roRequestApproval.searchLabel' | translate }}
                  </button>
                </div>
              </div>
            </form>
          </mat-expansion-panel>
        </mat-accordion>
        <div class="mg-t-25"></div>

        <div class="row">
          <mat-radio-group
            [(ngModel)]="radioOptions"
            (change)="radioChange($event)"
            class="col-auto row"
          >
            <mat-radio-button value="PENDING" class="mr-3" class="col-auto">
              <p class="pw-radio-btn__label">
                {{ 'pw.roRequestApproval.pendingLabel' | translate }}
              </p>
            </mat-radio-button>
            <mat-radio-button value="APPROVED" class="mr-3" class="col-auto">
              <p class="pw-radio-btn__label">
                {{ 'pw.roRequestApproval.approvedLabel' | translate }}
              </p>
            </mat-radio-button>

            <mat-radio-button value="REJECTED" class="mr-3" class="col-auto">
              <p class="pw-radio-btn__label">
                {{ 'pw.roRequestApproval.rejectedLabel' | translate }}
              </p>
            </mat-radio-button>
            <mat-radio-button value="CLOSED" class="mr-3" class="col-auto">
              <p class="pw-radio-btn__label">Utilised</p>
            </mat-radio-button>
          </mat-radio-group>
        </div>

        <poss-web-ro-request-list
          [requestsListPoss]="requestsListPoss$ | async"
          [isHistory]="false"
          [isEposs]="false"
          [count]="totalElements$ | async"
          [pageEvent]="initialPageEvent"
          [pageSizeOptions]="pageSizeOptions"
          (paginator)="loadPaginateData($event)"
        ></poss-web-ro-request-list>

        <poss-web-loader *ngIf="isLoading$ | async"></poss-web-loader>
      </div>
    </div>
  </div>
</ng-container>
