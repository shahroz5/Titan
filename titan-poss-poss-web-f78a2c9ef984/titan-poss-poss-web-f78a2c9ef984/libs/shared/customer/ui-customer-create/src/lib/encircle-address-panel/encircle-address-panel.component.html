<ng-container *ngIf="!viewMode">
  <form [formGroup]="addressForm" autocomplete="off">
    <div class="row">
      <mat-form-field class="col-12">
        <mat-label>{{
          'pw.addressPanel.houseNumberLabel' | translate
        }}</mat-label>
        <input
          #firstname="matInput"
          matInput
          type="text"
          required
          autocomplete="off"
          possWebMaxLengthValidator
          name="addressField"
          formControlName="houseNumber"
        />
        <mat-error
          *ngIf="
            addressForm.get('houseNumber').errors &&
            addressForm.get('houseNumber').errors.errorArray
          "
        >
          <poss-web-error-info-tooltip
            [errorMessage]="addressForm.get('houseNumber').errors.errorArray"
          ></poss-web-error-info-tooltip>
        </mat-error>
      </mat-form-field>
    </div>
    <div class="row">
      <mat-form-field class="col-12">
        <mat-label>{{
          'pw.addressPanel.streetOrRoadLabel' | translate
        }}</mat-label>
        <input
          matInput
          type="text"
          possWebMaxLengthValidator
          autocomplete="off"
          name="addressField"
          formControlName="street"
          required
        />
        <mat-error
          *ngIf="
            addressForm.get('street').errors &&
            addressForm.get('street').errors.errorArray
          "
        >
          <poss-web-error-info-tooltip
            [errorMessage]="addressForm.get('street').errors.errorArray"
          ></poss-web-error-info-tooltip>
        </mat-error>
      </mat-form-field>
    </div>
    <div class="row">
      <mat-form-field class="col-12">
        <mat-label>{{
          'pw.addressPanel.buildingNameLabel' | translate
        }}</mat-label>
        <input
          matInput
          type="text"
          autocomplete="off"
          possWebMaxLengthValidator
          name="addressField"
          formControlName="buildingName"
        />
        <mat-error
          *ngIf="
            addressForm.get('buildingName').errors &&
            addressForm.get('buildingName').errors.errorArray
          "
        >
          <poss-web-error-info-tooltip
            [errorMessage]="addressForm.get('buildingName').errors.errorArray"
          ></poss-web-error-info-tooltip>
        </mat-error>
      </mat-form-field>
    </div>
    <div class="row">
      <mat-form-field class="col-12">
        <mat-label>{{
          'pw.addressPanel.colonyOrLocalityLabel' | translate
        }}</mat-label>
        <input
          matInput
          type="text"
          autocomplete="off"
          possWebMaxLengthValidator
          name="addressField"
          formControlName="colony"
        />
        <mat-error
          *ngIf="
            addressForm.get('colony').errors &&
            addressForm.get('colony').errors.errorArray
          "
        >
          <poss-web-error-info-tooltip
            [errorMessage]="addressForm.get('colony').errors.errorArray"
          ></poss-web-error-info-tooltip>
        </mat-error>
      </mat-form-field>
    </div>
    <div class="row">
      <poss-web-select-dropdown
        disableOptionCentering
        class="col-6"
        [placeholder]="'pw.addressPanel.countryLabel' | translate"
        [control]="addressForm.get('country')"
        [options]="countryListToDropdown"
        [required]="true"
      >
      </poss-web-select-dropdown>
      <mat-form-field class="col-6">
        <mat-label>{{ 'pw.addressPanel.pincodeLabel' | translate }}</mat-label>
        <input
          matInput
          type="text"
          possWebMaxLengthValidator
          name="pincodeField"
          autocomplete="off"
          formControlName="pincode"
          required
          (blur)="onPincodeChange()"
        />
        <mat-error
          *ngIf="
            addressForm.get('pincode').errors &&
            addressForm.get('pincode').errors.errorArray
          "
        >
          <poss-web-error-info-tooltip
            [errorMessage]="addressForm.get('pincode').errors.errorArray"
          ></poss-web-error-info-tooltip>
        </mat-error>
      </mat-form-field>
    </div>
    <div class="row">
      <!-- <poss-web-select-dropdown
        disableOptionCentering
        class="col-6"
        [placeholder]="'pw.addressPanel.stateLabel' | translate"
        [control]="addressForm.get('state')"
        [options]="stateList"
        [required]="true"
        (selectionChange)="selectionChangeState($event)"
      >
      </poss-web-select-dropdown> -->
      <mat-form-field class="col-6">
        <mat-label>{{ 'pw.addressPanel.stateLabel' | translate }}</mat-label>
        <input
          type="text"
          matInput
          formControlName="state"
          [matAutocomplete]="autoState1"
          required
          possWebMaxLengthValidator
          name="stateField"
        />
        <mat-autocomplete #autoState1="matAutocomplete">
          <mat-option
            *ngFor="let option of filteredStateOptions$ | async"
            (onSelectionChange)="selectedStateId($event, option.value)"
            [value]="option.description"
            >{{ option.description }}</mat-option
          >
        </mat-autocomplete>
        <mat-error
          *ngIf="
            addressForm.get('state').errors &&
            addressForm.get('state').errors.errorArray
          "
        >
          <poss-web-error-info-tooltip
            [errorMessage]="addressForm.get('state').errors.errorArray"
          ></poss-web-error-info-tooltip>
        </mat-error>
        <mat-error
          *ngIf="
            addressForm.get('state').errors &&
            !addressForm.get('state').errors.errorArray &&
            addressForm.get('state').errors.invalidAutocompleteString
          "
        >
          Click one of the dropdown option
        </mat-error>
      </mat-form-field>
      <!-- <mat-form-field class="col-6">
        <mat-label>{{ 'pw.addressPanel.stateLabel' | translate }}</mat-label>
        <input
          type="text"
          matInput
          [formControl]="addressForm.controls['state']"
          [matAutocomplete]="autoState"
          required
          autocomplete="off"
          possWebMaxLengthValidator
          name="stateField"
        />
        <mat-autocomplete
          #autoState="matAutocomplete"
          (optionSelected)="selectionChangeState($event)"
        >
          <mat-option
            *ngFor="let option of filteredStateOptions$ | async"
            (onSelectionChange)="selectedStateId($event, option.id)"
            [value]="option.description"
            >{{ option.description }}</mat-option
          >
        </mat-autocomplete>

        <mat-error
          *ngIf="
            addressForm.get('state').errors &&
            addressForm.get('state').errors.errorArray
          "
        >
          <span
            *ngFor="
              let errorMesage of addressForm.get('state').errors.errorArray;
              let i = index
            "
          >
            <span *ngIf="i === 0"> {{ errorMesage }}</span>
            <poss-web-error-info-tooltip
              *ngIf="i > 0"
              [errorMessage]="errorMesage"
            ></poss-web-error-info-tooltip>
          </span>
        </mat-error>
      </mat-form-field> -->
      <mat-form-field class="col-6">
        <mat-label>{{ 'pw.addressPanel.cityLabel' | translate }}</mat-label>
        <input
          type="text"
          matInput
          autocomplete="off"
          formControlName="city"
          [matAutocomplete]="autoCity"
          required
          possWebMaxLengthValidator
          name="cityField"
        />

        <mat-autocomplete #autoCity="matAutocomplete">
          <mat-option
            *ngFor="let option of filteredCityOptions$ | async"
            [value]="option.description"
            >{{ option.description }}</mat-option
          >
        </mat-autocomplete>
        <mat-error
          *ngIf="
            addressForm.get('city').errors &&
            addressForm.get('city').errors.errorArray
          "
        >
          <poss-web-error-info-tooltip
            [errorMessage]="addressForm.get('city').errors.errorArray"
          ></poss-web-error-info-tooltip>
        </mat-error>
      </mat-form-field>
    </div>
  </form>
</ng-container>
<ng-container *ngIf="viewMode">
  <p class="pw-address-panel__label">
    {{ 'pw.addressPanel.addressLabel' | translate }}
  </p>
  <div class="pw-confirmation-box__address">
    <span *ngIf="addressDetail.addressLines[0]">
      {{ addressDetail.addressLines[0] }},
    </span>
    <span *ngIf="addressDetail.addressLines[1]">
      {{ addressDetail.addressLines[1] }},
    </span>
    <span *ngIf="addressDetail.addressLines[2]">
      {{ addressDetail.addressLines[2] }},
    </span>
    {{ addressDetail.city }},
    {{ addressDetail.state }}
    {{ addressDetail.country }} <span *ngIf="addressDetail.pinCode"> - </span>
    {{ addressDetail.pinCode }}
  </div>
</ng-container>
