<form
  [hidden]="isCustomerSelected || !checkCustomerSearch() || issuePendingFoc || hideCustomerSearch"
  class="row no-gutters align-items-baseline"
  [formGroup]="searchForm"
  autocomplete="off"
>
  <!-- <mat-form-field class="col-4 pw-form-field-padding-bottom-0">
    <mat-select
      disableOptionCentering
      placeholder="{{ 'pw.customerSearch.searchByLabel' | translate }}"
      formControlName="searchBy"
    >
      <mat-option *ngFor="let option of searchByOptions" [value]="option">
        {{ option.key | translate }}
      </mat-option>
    </mat-select>
  </mat-form-field> -->

  <poss-web-select-dropdown
    class="col-5 pw-form-field-padding-bottom-0 pw-customer-position"
    placeholder="{{ 'pw.customerSearch.searchByLabel' | translate }}"
    [control]="searchForm.get('searchBy')"
    [options]="dropdownSearchOptions"
    [required]="true"
  >
  </poss-web-select-dropdown>

  <poss-web-customer-mobile-no-search
    *ngIf="selectedSearchByOption?.value == searchByEnumRef.MOBILE_NO"
    class="col-7"
    [searchControl]="searchForm.get('searchValue')"
    [placeholder]="
      (selectedSearchByOption ? selectedSearchByOption.placeholder : '')
        | translate
    "
    (search)="searchFn()"
    (clearSearch)="clearResult(true)"
    (clearError)="clearError($event)"
  >
  </poss-web-customer-mobile-no-search>

  <poss-web-customer-ulp-id-search
    *ngIf="selectedSearchByOption?.value == searchByEnumRef.ULP_ID"
    class="col-7"
    [searchControl]="searchForm.get('searchValue')"
    [placeholder]="
      (selectedSearchByOption ? selectedSearchByOption.placeholder : '')
        | translate
    "
    (search)="searchFn()"
    (clearSearch)="clearResult(true)"
    (clearError)="clearError($event)"
  >
  </poss-web-customer-ulp-id-search>

  <poss-web-customer-pan-no-search
    *ngIf="selectedSearchByOption?.value == searchByEnumRef.PAN_NO"
    class="col-7"
    [searchControl]="searchForm.get('searchValue')"
    [placeholder]="
      (selectedSearchByOption ? selectedSearchByOption.placeholder : '')
        | translate
    "
    (search)="searchFn()"
    (clearSearch)="clearResult(true)"
    (clearError)="clearError($event)"
  >
  </poss-web-customer-pan-no-search>
  <poss-web-customer-gst-no-search
    *ngIf="selectedSearchByOption?.value == searchByEnumRef.GST_NO"
    class="col-7"
    [searchControl]="searchForm.get('searchValue')"
    [placeholder]="
      (selectedSearchByOption ? selectedSearchByOption.placeholder : '')
        | translate
    "
    (search)="searchFn()"
    (clearSearch)="clearResult(true)"
    (clearError)="clearError($event)"
  >
  </poss-web-customer-gst-no-search>

  <poss-web-customer-passport-no-search
    *ngIf="selectedSearchByOption?.value == searchByEnumRef.PASSPORT_ID"
    class="col-7"
    [searchControl]="searchForm.get('searchValue')"
    [placeholder]="
      (selectedSearchByOption ? selectedSearchByOption.placeholder : '')
        | translate
    "
    (search)="searchFn()"
    (clearSearch)="clearResult(true)"
    (clearError)="clearError($event)"
  >
  </poss-web-customer-passport-no-search>

  <poss-web-customer-email-id-search
    *ngIf="selectedSearchByOption?.value == searchByEnumRef.EMAIL_ID"
    class="col-7"
    [searchControl]="searchForm.get('searchValue')"
    [placeholder]="
      (selectedSearchByOption ? selectedSearchByOption.placeholder : '')
        | translate
    "
    (search)="searchFn()"
    (clearSearch)="clearResult(true)"
    (clearError)="clearError($event)"
  >
  </poss-web-customer-email-id-search>

  <poss-web-customer-name-search
    *ngIf="selectedSearchByOption?.value == searchByEnumRef.CUSTOMER_NAME"
    class="col-7"
    [searchControl]="searchForm.get('searchValue')"
    [placeholder]="
      (selectedSearchByOption ? selectedSearchByOption.placeholder : '')
        | translate
    "
    (search)="searchFn()"
    (clearSearch)="clearResult(true)"
    (clearError)="clearError($event)"
  >
  </poss-web-customer-name-search>
</form>

<ng-container *ngIf="!showValidationError">
  <mat-card
    *ngIf="!isSearching && !!customer && !isCustomerSelected" 
    class="mat-elevation-z3 pw-cursor-pointer pw-card-absolute pw-card-item-list"
  >
    <div
      *ngFor="let customer of customersInfo"
      class="pw-card-item pw-cursor-pointer"
      (click)="selectCustomer(customer)"
    >
      <div class="row">
        <div class="col pw-shadow-card__heading">
          <ng-container *ngIf="customer.title">
            {{ customer.title }}.
          </ng-container>
          {{ customer.customerName }}
        </div>
      </div>
      <div class="row">
        <div class="col pw-search-items">
          <ng-container *ngIf="customer.mobileNumber">
            <span class="pw-i-16 pw-mobile-icon-16"></span>
            {{ customer.mobileNumber }} |
          </ng-container>

          <ng-container *ngIf="isRegularCustomer(customer)">
            {{ customer.ulpId }}
          </ng-container>

          <ng-container *ngIf="isInstitutionalCustomer(customer)">
            {{ customer.instiTaxNo }}
          </ng-container>

          <ng-container *ngIf="isInternationalCustomer(customer)">
            {{ customer.passportId }}
          </ng-container>

          <ng-container *ngIf="isOnetimeCustomer(customer)">
            {{ customer.customerDetails.data.fullAddress }}
          </ng-container>
        </div>
      </div>
    </div>
  </mat-card>

  <div
    class="pw-shadow-card mat-elevation-z3"
    *ngIf="!!customer && isCustomerSelected"
  >
    <div class="row pw-shadow-card__row">
      <div
        class="col-lg-auto col-2 pw-shadow-card__heading pw-shadow-card__padding-5 pl-2"
      >
        <ng-container *ngIf="customer.title">
          {{ customer.title }}.
        </ng-container>

        {{ customer.customerName }}
      </div>

      <div
        class="col-lg-4 col-3 pw-shadow-card__padding-5 pw-shadow-card__heading"
        [matTooltip]="customer.customerDetails?.data?.fullAddress"
      >
        <ng-container *ngIf="customer.customerDetails?.data?.fullAddress">
          | {{ customer.customerDetails?.data.fullAddress }}
        </ng-container>
      </div>
      <div
        class="col-lg col-3 pw-shadow-card__heading pw-shadow-card__padding-5"
      >
        <ng-container *ngIf="customer.mobileNumber">
          <ng-container *ngIf="customer.customerDetails?.data?.fullAddress">
            |
          </ng-container>
          <span class="pw-i-16 pw-mobile-icon-16"></span>
          {{ customer.mobileNumber }}
        </ng-container>

        <ng-container *ngIf="isRegularCustomer(customer)">
          | {{ customer.ulpId }}
        </ng-container>

        <ng-container *ngIf="isInstitutionalCustomer(customer)">
          | {{ customer.instiTaxNo }}
        </ng-container>

        <ng-container *ngIf="isInternationalCustomer(customer)">
          | {{ customer.passportId }}
        </ng-container>
      </div>
      <div
        *ngIf="
          enableEdit &&
          (isInstitutionalCustomer(customer) ||
            isInternationalCustomer(customer) ||
            isRegularCustomer(customer) ||
            isOnetimeCustomer(customer))
        "
        class="col-auto pw-shadow-card__right-container pw-shadow-card__padding-5"
      >
        <mat-icon
          class="pw-cursor-pointer"
          (click)="editCustomer('', customer.customerId)"
        >
          <span class="pw-i-24 pw-pencil-icon-24"></span>
        </mat-icon>
      </div>
      <div class="col-auto">
        <span
          class="pw-fourth-color pw-cursor-pointer"
          (click)="viewCustomer()"
        >
          {{ 'pw.customerSearch.viewMoreText' | translate }}
        </span>
      </div>

      <div class="col-auto">
        <mat-icon
          class="pw-cursor-pointer"
          (click)="clearResult(false)"
          *ngIf="enableClear"
        >
          <span class="pw-i-24 pw-gold-close-icon-24"></span>
        </mat-icon>
      </div>
    </div>
  </div>

  <mat-card
    *ngIf="!isCustomerSelected && isSearching"
    class="mat-elevation-z3 pw-text-center pw-card-absolute"
  >
    <p>
      <span class="pw-font-weight-bold"
        >{{ 'pw.customerSearch.searchingMessage' | translate }} ...</span
      >
    </p>
  </mat-card>

  <mat-card
    *ngIf="!isCustomerSelected && !isSearching && hasResult === false"
    class="mat-elevation-z3 pw-text-center pw-card-absolute"
  >
    <p>
      <span class="pw-font-weight-bold">{{
        'pw.customerSearch.customerNotRegisteredMessage' | translate
      }}</span>
    </p>
    <button
      *ngIf="enableCreate"
      class="mt-3 pw-btn pw-accent-btn"
      (click)="
        createCustomer(
          selectedSearchByOption.customerType,
          selectedSearchByOption.value,
          searchForm.get('searchValue').value
        )
      "
    >
      <span>
        {{ selectedSearchByOption.createCustomerLabel | translate }}
      </span>
    </button>
  </mat-card>
</ng-container>
<mat-card
  *ngIf="!isCustomerSelected && showValidationError && selectedSearchByOption"
  class="mat-elevation-z3 pw-text-center pw-card-absolute"
>
  <p>
    <span class="pw-font-weight-bold">
      {{ 'pw.customerSearch.validationError' | translate }}
      {{ selectedSearchByOption.description }}

      <ng-container
        *ngIf="
          searchForm.get('searchValue').errors &&
          searchForm.get('searchValue').errors.errorArray
        "
      >
        <poss-web-error-info-tooltip
          [isOnlyTooltip]="true"
          [errorMessage]="searchForm.get('searchValue').errors.errorArray"
        ></poss-web-error-info-tooltip>
      </ng-container>
    </span>
  </p>
</mat-card>
