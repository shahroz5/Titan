<div class="pw-confirmation-box">
  <ng-container *ngIf="data.customer">
    <div
      class="row pw-confirmation-box__header pw-cursor-grab"
      cdkDragBoundary=".cdk-overlay-container"
      cdkDragRootElement=".cdk-overlay-pane"
      cdkDrag
      cdkDragHandle
    >
      <div class="col-auto">
        {{ 'pw.customerCreation.edit' | translate }}
        <span
          *ngIf="data.customer.customerType === customerTypeEnumRef.ONE_TIME"
        >
          {{ 'pw.customerCreation.onetimeLabel' | translate }}
        </span>
        <span
          *ngIf="data.customer.customerType !== customerTypeEnumRef.ONE_TIME"
        >
          {{ data.customer.customerType }}
        </span>

        {{ 'pw.customerCreation.customer' | translate }}
      </div>
      <div class="col pw-text-right">
        <button
          mat-icon-button
          (click)="close()"
          class="pw-confirmation-box__icon-button"
        >
          <mat-icon>
            <span class="pw-i-24 pw-close-no-border-icon-24"></span>
          </mat-icon>
        </button>
      </div>
    </div>

    <ng-container [ngSwitch]="data.customer.customerType">
      <div *ngSwitchCase="customerTypeEnumRef.REGULAR">
        <poss-web-regular-customer-form
          [customer]="customer"
          (loadPincode)="loadPincode($event)"
          (loadCountry)="loadCountry($event)"
          (loadStates)="loadStates($event)"
          (loadPanVerification)="loadPanNumberVerificationStatus($event)"
          (loadGstVerification)="loadGstNumberVerificationStatus($event)"
          [panVerificationStatus]="panVerificationStatus$ | async"
          [gstVerificationStatus]="gstVerificationStatus$ | async"
          (loadEmailValidation)="loadEmailValidationStatus($event)"
          [emailValidationStatus]="emailValidationStatus$ | async"
          [data]="data"
          (updateCustomer)="updateCustomer($event)"
          [pincodeSummary]="pincodeSummary$ | async"
          [isEmailRequiredForEncircle]="isEmailRequiredForEncircle"
          [isAdvancebookingType]="isAdvancebookingType"
        ></poss-web-regular-customer-form>
      </div>
      <div *ngSwitchCase="customerTypeEnumRef.INTERNATIONAL">
        <poss-web-international-customer-form
          [customer]="customer"
          (loadPincode)="loadPincode($event)"
          (loadCountry)="loadCountry($event)"
          (loadPanVerification)="loadPanNumberVerificationStatus($event)"
          (loadGstVerification)="loadGstNumberVerificationStatus($event)"
          [panVerificationStatus]="panVerificationStatus$ | async"
          [gstVerificationStatus]="gstVerificationStatus$ | async"
          (loadEmailValidation)="loadEmailValidationStatus($event)"
          [emailValidationStatus]="emailValidationStatus$ | async"
          (loadStates)="loadStates($event)"
          [data]="data"
          (updateCustomer)="updateCustomer($event)"
          [pincodeSummary]="pincodeSummary$ | async"
          [isMobileRequiredForInternational]="isMobileRequiredForInternational"
          [isEmailRequiredForInternational]="isEmailRequiredForInternational"
        ></poss-web-international-customer-form>
      </div>
      <div *ngSwitchCase="customerTypeEnumRef.INSTITUTIONAL">
        <poss-web-institutional-customer-form
          [customer]="customer"
          (loadPincode)="loadPincode($event)"
          (loadCountry)="loadCountry($event)"
          (loadStates)="loadStates($event)"
          (loadIsUniqueCustomer)="loadIsUniqueCustomer($event)"
          (loadPanVerification)="loadPanNumberVerificationStatus($event)"
          (loadGstVerification)="loadGstNumberVerificationStatus($event)"
          (loadEmailValidation)="loadEmailValidationStatus($event)"
          [emailValidationStatus]="emailValidationStatus$ | async"
          [uniqueGst]="isUniqueGst$ | async"
          [uniquePan]="isUniquePan$ | async"
          [panVerificationStatus]="panVerificationStatus$ | async"
          [gstVerificationStatus]="gstVerificationStatus$ | async"
          [data]="data"
          (updateCustomer)="updateCustomer($event)"
          [pincodeSummary]="pincodeSummary$ | async"
          [isEmailRequiredForInstitutional]="isEmailRequiredForInstitutional"
          [isMobileRequiredForInstitutional]="isMobileRequiredForInstitutional"
        ></poss-web-institutional-customer-form>
      </div>
      <div *ngSwitchCase="customerTypeEnumRef.ONE_TIME">
        <poss-web-one-time-customer-form
          [customer]="customer"
          (loadCountry)="loadCountry($event)"
          (loadPincode)="loadPincode($event)"
          (loadStates)="loadStates($event)"
          (loadPanVerification)="loadPanNumberVerificationStatus($event)"
          (loadEmailValidation)="loadEmailValidationStatus($event)"
          [emailValidationStatus]="emailValidationStatus$ | async"
          [data]="data"
          (updateCustomer)="updateCustomer($event)"
          [pincodeSummary]="pincodeSummary$ | async"
          [isEmailRequiredForOneTime]="isEmailRequiredForOneTime"
          [isMobileRequiredForOneTime]="isMobileRequiredForOneTime"
          [panVerificationStatus]="panVerificationStatus$ | async"
        ></poss-web-one-time-customer-form>
      </div>
    </ng-container>
  </ng-container>
  <ng-container *ngIf="!data.customer">
    <div
      class="row pw-confirmation-box__header pw-cursor-grab"
      cdkDragBoundary=".cdk-overlay-container"
      cdkDragRootElement=".cdk-overlay-pane"
      cdkDrag
      cdkDragHandle
    >
      <div class="col-auto">
        {{ 'pw.customerCreation.create' | translate }}
        <span *ngIf="data.customerType === customerTypeEnumRef.ONE_TIME">
          {{ 'pw.customerCreation.onetimeLabel' | translate }}
        </span>
        <span *ngIf="data.customerType !== customerTypeEnumRef.ONE_TIME">
          {{ data.customerType }}
        </span>
        {{ 'pw.customerCreation.customer' | translate }}
      </div>
      <div class="col pw-text-right">
        <button
          mat-icon-button
          (click)="close()"
          class="pw-confirmation-box__icon-button"
        >
          <mat-icon>
            <span class="pw-i-24 pw-close-no-border-icon-24"></span>
          </mat-icon>
        </button>
      </div>
    </div>

    <ng-container [ngSwitch]="data.customerType">
      <div *ngSwitchCase="customerTypeEnumRef.REGULAR">
        <poss-web-regular-customer-form
          [customer]="customer"
          (loadIsUniqueCustomer)="loadIsUniqueCustomer($event)"
          (loadPincode)="loadPincode($event)"
          (loadPanVerification)="loadPanNumberVerificationStatus($event)"
          (loadGstVerification)="loadGstNumberVerificationStatus($event)"
          (loadCountry)="loadCountry($event)"
          (clearVerificationState)="clearVerificationState($event)"
          (clearPanVerificationState)="clearPanVerificationState($event)"
          (clearGstVerificationState)="clearGstVerificationState($event)"
          (loadEmailValidation)="loadEmailValidationStatus($event)"
          [emailValidationStatus]="emailValidationStatus$ | async"
          (clearEmailValidationState)="clearEmailValidationState($event)"
          (loadStates)="loadStates($event)"
          [data]="data"
          (addNewCustomer)="addNewCustomer($event)"
          [pincodeSummary]="pincodeSummary$ | async"
          [isUniqueCustomer]="isUniqueCustomer$ | async"
          [isUniqueEmail]="isUniqueEmail$ | async"
          [uniqueGst]="isUniqueGst$ | async"
          [panVerificationStatus]="panVerificationStatus$ | async"
          [gstVerificationStatus]="gstVerificationStatus$ | async"
          [uniquePan]="isUniquePan$ | async"
          [isEmailRequiredForEncircle]="isEmailRequiredForEncircle"
          [mobileNumberStartSeries]="
            customerDetailsInBrand?.data?.regularMobileNoStartsWith
          "
        ></poss-web-regular-customer-form>
      </div>
      <div *ngSwitchCase="customerTypeEnumRef.INTERNATIONAL">
        <poss-web-international-customer-form
          [customer]="customer"
          (loadIsUniqueCustomer)="loadIsUniqueCustomer($event)"
          (loadPanVerification)="loadPanNumberVerificationStatus($event)"
          (loadGstVerification)="loadGstNumberVerificationStatus($event)"
          (loadPincode)="loadPincode($event)"
          (loadCountry)="loadCountry($event)"
          (loadStates)="loadStates($event)"
          [data]="data"
          (addNewCustomer)="addNewCustomer($event)"
          (clearVerificationState)="clearVerificationState($event)"
          (clearPanVerificationState)="clearPanVerificationState($event)"
          (clearGstVerificationState)="clearGstVerificationState($event)"
          (loadEmailValidation)="loadEmailValidationStatus($event)"
          [emailValidationStatus]="emailValidationStatus$ | async"
          (clearEmailValidationState)="clearEmailValidationState($event)"
          [pincodeSummary]="pincodeSummary$ | async"
          [panVerificationStatus]="panVerificationStatus$ | async"
          [gstVerificationStatus]="gstVerificationStatus$ | async"
          [isUniqueCustomer]="isUniqueCustomer$ | async"
          [isUniqueEmail]="isUniqueEmail$ | async"
          [countryCode]="countryCode$ | async"
          [isMobileRequiredForInternational]="isMobileRequiredForInternational"
          [isEmailRequiredForInternational]="isEmailRequiredForInternational"
          [mobileNumberStartSeries]="
            customerDetailsInBrand?.data?.internationalMobileNoStartsWith
          "
        ></poss-web-international-customer-form>
      </div>
      <div *ngSwitchCase="customerTypeEnumRef.INSTITUTIONAL">
        <poss-web-institutional-customer-form
          [customer]="customer"
          (loadIsUniqueCustomer)="loadIsUniqueCustomer($event)"
          (loadPanVerification)="loadPanNumberVerificationStatus($event)"
          (loadGstVerification)="loadGstNumberVerificationStatus($event)"
          (loadPincode)="loadPincode($event)"
          (loadCountry)="loadCountry($event)"
          (loadStates)="loadStates($event)"
          (clearVerificationState)="clearVerificationState($event)"
          (clearPanVerificationState)="clearPanVerificationState($event)"
          (clearGstVerificationState)="clearGstVerificationState($event)"
          (loadEmailValidation)="loadEmailValidationStatus($event)"
          [emailValidationStatus]="emailValidationStatus$ | async"
          (clearEmailValidationState)="clearEmailValidationState($event)"
          [data]="data"
          (addNewCustomer)="addNewCustomer($event)"
          [pincodeSummary]="pincodeSummary$ | async"
          [isUniqueCustomer]="isUniqueCustomer$ | async"
          [isUniqueEmail]="isUniqueEmail$ | async"
          [uniqueGst]="isUniqueGst$ | async"
          [uniquePan]="isUniquePan$ | async"
          [panVerificationStatus]="panVerificationStatus$ | async"
          [gstVerificationStatus]="gstVerificationStatus$ | async"
          [isEmailRequiredForInstitutional]="isEmailRequiredForInstitutional"
          [isMobileRequiredForInstitutional]="isMobileRequiredForInstitutional"
          [mobileNumberStartSeries]="
            customerDetailsInBrand?.data?.institutionalMobileNoStartsWith
          "
        ></poss-web-institutional-customer-form>
      </div>
      <div *ngSwitchCase="customerTypeEnumRef.ONE_TIME">
        <poss-web-one-time-customer-form
          [customer]="customer"
          (loadIsUniqueCustomer)="loadIsUniqueCustomer($event)"
          (loadPanVerification)="loadPanNumberVerificationStatus($event)"
          (loadCountry)="loadCountry($event)"
          (loadPincode)="loadPincode($event)"
          (loadStates)="loadStates($event)"
          (clearVerificationState)="clearVerificationState($event)"
          (clearPanVerificationState)="clearPanVerificationState($event)"
          (loadEmailValidation)="loadEmailValidationStatus($event)"
          [emailValidationStatus]="emailValidationStatus$ | async"
          (clearEmailValidationState)="clearEmailValidationState($event)"
          [data]="data"
          (addNewCustomer)="addNewCustomer($event)"
          [pincodeSummary]="pincodeSummary$ | async"
          [isUniqueCustomer]="isUniqueCustomer$ | async"
          [isUniqueEmail]="isUniqueEmail$ | async"
          [isEmailRequiredForOneTime]="isEmailRequiredForOneTime"
          [isMobileRequiredForOneTime]="isMobileRequiredForOneTime"
          [mobileNumberStartSeries]="
            customerDetailsInBrand?.data?.oneTimeMobileNoStartsWith
          "
          [panVerificationStatus]="panVerificationStatus$ | async"
        ></poss-web-one-time-customer-form>
      </div>
    </ng-container>
  </ng-container>
  <poss-web-loader *ngIf="(isCustomerSaving$ | async) || (isLoading$ | async)">
  </poss-web-loader>
</div>
